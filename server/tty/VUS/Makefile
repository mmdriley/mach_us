# 
# Mach Operating System
# Copyright (c) 1993-1988 Carnegie Mellon University
# All Rights Reserved.
# 
# Permission to use, copy, modify and distribute this software and its
# documentation is hereby granted, provided that both the copyright
# notice and this permission notice appear in all copies of the
# software, derivative works or modified versions, and any portions
# thereof, and that both notices appear in supporting documentation.
# 
# CARNEGIE MELLON ALLOWS FREE USE OF THIS SOFTWARE IN ITS "AS IS"
# CONDITION.  CARNEGIE MELLON DISCLAIMS ANY LIABILITY OF ANY KIND FOR
# ANY DAMAGES WHATSOEVER RESULTING FROM THE USE OF THIS SOFTWARE.
# 
# Carnegie Mellon requests users of this software to return to
# 
#  Software Distribution Coordinator  or  Software.Distribution@CS.CMU.EDU
#  School of Computer Science
#  Carnegie Mellon University
#  Pittsburgh PA 15213-3890
# 
# any improvements or extensions that they make and grant Carnegie Mellon 
# the rights to redistribute these changes.
#  
#
# HISTORY
# $Log:	Makefile,v $
# Revision 2.2  94/06/29  15:27:54  mrt
# 	Copied from server/tty. Updated for odemake.
# 	Set MACH_VUS as the configuration to build.
# 	[94/06/29            mrt]
# 
# 
# Revision 1.15  90/11/27  18:22:17  jms
# 	Make MACH3_VUS the default configuration.
# 	Add use of MACH3_CONFIGURATION environment variable
# 	[90/11/20  15:01:06  jms]
# 

DEPENDENCIES	=
SAVE_D		=

CONFIGURATION	=  MACH3_VUS

IDIR		= /us/bin/

PROGRAMS	= tty_server.vus
ILIST		= ${PROGRAMS}


# XXX Set FD_SETSIZE to nchrdev(=7)*256 to allow the use of dev numbers as fds
CFLAGS		= -DFD_SETSIZE=1792 -DMACH_NO_KERNEL=1 -DMACH=1 -DUS=1 
CPlusPlusFLAGS	= ${CFLAGS} 

#LIBS = -lus_test -lproxies -lus++ ${LIBTHREADS} ${LIBMACH3} ${LIBCS}
LIBS = -lproxies -lus++ ${LIBTHREADS} ${LIBMACH3} ${LIBCS} 

# To find dependencies generated by foo.o_INCFLAGS
VPATH		= ${UNIX_INCLUDE}

INCFLAGS		= -I.. -I../include
tty_agency.o_INCFLAGS	= -I.. -I../include -I${MACH3_INCLUDES} -I${UNIX_INCLUDE}
tty_dir.o_INCFLAGS	= -I.. -I../include -I${MACH3_INCLUDES} -I${UNIX_INCLUDE}
tty_name_create.o_INCFLAGS	= -I.. -I../include  -I${MACH3_INCLUDES} -I${UNIX_INCLUDE}
tty_server.o_INCFLAGS	= -I..  -I../include  -I${MACH3_INCLUDES} -I${UNIX_INCLUDE}
tty_signal.o_INCFLAGS	= -I.. -I../include -I${MACH3_INCLUDES} -I${UNIX_INCLUDE}

DEFUNCT_OBJS = stub_xxx.o

MACH3_US_OBJS	= tty_io.o cons.o misc.o zalloc.o queue.o \
		  device_reply_hdlr.o device_utils.o device_misc.o
MACH3_VUS_OBJS	= bsd_tty.o $(MACH3_US_OBJS)

OBJS 		= kern_subr.o tty.o tty_bk.o tty_cmupty.o tty_conf.o \
		  tty_pty.o tty_subr.o tty_tb.o cdevsw.o \
		  bigpile_xxx.o libc_xxx.o emul_xxx.o mach_synch.o struct_xxx.o \
		  tty_threads.o tty_utils.o tty_signal.o tty_name.o \
		  $($(CONFIGURATION)_OBJS)

MGROBJS 	= tty_io_procs.o tty_select_proc.o \
		  tty_dir.o tty_agency.o tty_name_create.o

OFILES 		= tty_server.o $(OBJS) $(MGROBJS)

.include <${RULES_MK}>


