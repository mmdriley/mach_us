# 
# Mach Operating System
# Copyright (c) 1993-1988 Carnegie Mellon University
# All Rights Reserved.
# 
# Permission to use, copy, modify and distribute this software and its
# documentation is hereby granted, provided that both the copyright
# notice and this permission notice appear in all copies of the
# software, derivative works or modified versions, and any portions
# thereof, and that both notices appear in supporting documentation.
# 
# CARNEGIE MELLON ALLOWS FREE USE OF THIS SOFTWARE IN ITS "AS IS"
# CONDITION.  CARNEGIE MELLON DISCLAIMS ANY LIABILITY OF ANY KIND FOR
# ANY DAMAGES WHATSOEVER RESULTING FROM THE USE OF THIS SOFTWARE.
# 
# Carnegie Mellon requests users of this software to return to
# 
#  Software Distribution Coordinator  or  Software.Distribution@CS.CMU.EDU
#  School of Computer Science
#  Carnegie Mellon University
#  Pittsburgh PA 15213-3890
# 
# any improvements or extensions that they make and grant Carnegie Mellon 
# the rights to redistribute these changes.
#  
#
# HISTORY
# $Log:	Makefile,v $
# Revision 1.15  94/06/29  15:04:58  mrt
# 	3-Mary-94  Mary Thompson (mrt) at Carnegie-Mellon University
# 	Updated for odemake. Condensed history
# 	[94/04/26  17:21:52  mrt]
# 
# Revision 1.14  93/01/20  17:39:47  jms
# 	Add Fastlinks flag
# 	Commented malloc trace libs
# 	[93/01/18  17:41:43  jms]
# 
# Revision 1.12  91/07/01  14:15:50  jms
# 	Added cache.o, disk.o, data.o, device_reply_hdlr.o.
# 	[91/05/29  10:37:28  roy]
# 
#
######################################################################

DEPENDENCIES	=
SAVE_D		=

CONFIGURATION	=  ${MACH3_CONFIGURATION:UMACH3_US}

IDIR		= /us/bin/

PROGRAMS	= ufs
ILIST		= ufs

OFILES		= ufs_inode.o sys_inode.o mach_directory.o ufs_alloc.o \
	    	  ufs_subr.o ufs_tables.o ufs_fio.o ufs_bio.o \
	    	  ufs_bmap.o ufs_mount.o ufs_xxx.o ufs_export.o \
		  misc.o zalloc.o queue.o sync.o lock.o \
		  data.o cache.o disk.o device_reply_hdlr.o \
		  ufs_main.o

# Load with -lmalloc when looking for memory leaks.
.if defined(DEBUG)
DEBUG_LIB	= -lmalloc
.else
DEBUG_LIB	=
.endif


# To find the dependencies generated by ufs_main
VPATH		= ${UNIX_INCLUDE}

LIBS		= -lus++ ${DEBUG_LIB} ${LIBTHREADS} ${LIBMACH3} 

INCFLAGS	= -Iinclude  
ufs_main.o_INCFLAGS = -Iinclude -I${MACH3_INCLUDES} -I${UNIX_INCLUDE}

CFLAGS	= -DMACH=1 -DMACH_EMULATION=1 -DCREATE_FASTLINKS=1 -DCS_BUGFIX=1
CPlusPlusFLAGS	= -DMACH=1 -DMACH_EMULATION=1 -DCS_BUGFIX=1


.include <${RULES_MK}>


