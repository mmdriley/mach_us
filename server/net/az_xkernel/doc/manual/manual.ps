%!PS-Adobe-2.0
%%Creator: dvips 5.485 Copyright 1986-92 Radical Eye Software
%%Title: manual.dvi
%%Pages: 113 1
%%BoundingBox: 0 0 612 792
%%DocumentFonts: Times-Italic Times-Roman Times-Bold Helvetica Palatino-Roman
%%+ Courier Courier-Oblique Times-BoldItalic
%%EndComments
%DVIPSCommandLine: dvips -o manual.ps manual.dvi
%%BeginProcSet: tex.pro
/TeXDict 250 dict def TeXDict begin /N{def}def /B{bind def}N /S{exch}N /X{S N}
B /TR{translate}N /isls false N /vsize 11 72 mul N /@rigin{isls{[0 -1 1 0 0 0]
concat}if 72 Resolution div 72 VResolution div neg scale isls{Resolution hsize
-72 div mul 0 TR}if Resolution VResolution vsize -72 div 1 add mul TR matrix
currentmatrix dup dup 4 get round 4 exch put dup dup 5 get round 5 exch put
setmatrix}N /@landscape{/isls true N}B /@manualfeed{statusdict /manualfeed
true put}B /@copies{/#copies X}B /FMat[1 0 0 -1 0 0]N /FBB[0 0 0 0]N /nn 0 N
/IE 0 N /ctr 0 N /df-tail{/nn 8 dict N nn begin /FontType 3 N /FontMatrix
fntrx N /FontBBox FBB N string /base X array /BitMaps X /BuildChar{
CharBuilder}N /Encoding IE N end dup{/foo setfont}2 array copy cvx N load 0 nn
put /ctr 0 N[}B /df{/sf 1 N /fntrx FMat N df-tail}B /dfs{div /sf X /fntrx[sf 0
0 sf neg 0 0]N df-tail}B /E{pop nn dup definefont setfont}B /ch-width{ch-data
dup length 5 sub get}B /ch-height{ch-data dup length 4 sub get}B /ch-xoff{128
ch-data dup length 3 sub get sub}B /ch-yoff{ch-data dup length 2 sub get 127
sub}B /ch-dx{ch-data dup length 1 sub get}B /ch-image{ch-data dup type
/stringtype ne{ctr get /ctr ctr 1 add N}if}B /id 0 N /rw 0 N /rc 0 N /gp 0 N
/cp 0 N /G 0 N /sf 0 N /CharBuilder{save 3 1 roll S dup /base get 2 index get
S /BitMaps get S get /ch-data X pop /ctr 0 N ch-dx 0 ch-xoff ch-yoff ch-height
sub ch-xoff ch-width add ch-yoff setcachedevice ch-width ch-height true[1 0 0
-1 -.1 ch-xoff sub ch-yoff .1 add]{ch-image}imagemask restore}B /D{/cc X dup
type /stringtype ne{]}if nn /base get cc ctr put nn /BitMaps get S ctr S sf 1
ne{dup dup length 1 sub dup 2 index S get sf div put}if put /ctr ctr 1 add N}
B /I{cc 1 add D}B /bop{userdict /bop-hook known{bop-hook}if /SI save N @rigin
0 0 moveto pop}N /eop{SI restore showpage userdict /eop-hook known{eop-hook}
if}N /@start{userdict /start-hook known{start-hook}if /VResolution X
/Resolution X 1000 div /DVImag X /IE 256 array N 0 1 255{IE S 1 string dup 0 3
index put cvn put}for 65781.76 div /vsize X 65781.76 div /hsize X}N /p{show}N
/RMat[1 0 0 -1 0 0]N /BDot 260 string N /rulex 0 N /ruley 0 N /v{/ruley X
/rulex X V}B /V statusdict begin /product where{pop product dup length 7 ge{0
7 getinterval(Display)eq}{pop false}ifelse}{false}ifelse end{{gsave TR -.1 -.1
TR 1 1 scale rulex ruley false RMat{BDot}imagemask grestore}}{{gsave TR -.1
-.1 TR rulex ruley scale 1 1 false RMat{BDot}imagemask grestore}}ifelse B /a{
moveto}B /delta 0 N /tail{dup /delta X 0 rmoveto}B /M{S p delta add tail}B /b{
S p tail}B /c{-4 M}B /d{-3 M}B /e{-2 M}B /f{-1 M}B /g{0 M}B /h{1 M}B /i{2 M}B
/j{3 M}B /k{4 M}B /w{0 rmoveto}B /l{p -4 w}B /m{p -3 w}B /n{p -2 w}B /o{p -1 w
}B /q{p 1 w}B /r{p 2 w}B /s{p 3 w}B /t{p 4 w}B /x{0 S rmoveto}B /y{3 2 roll p
a}B /bos{/SS save N}B /eos{SS restore}B end
%%EndProcSet
%%BeginProcSet: texps.pro
TeXDict begin /rf{findfont dup length 1 add dict begin{1 index /FID ne 2 index
/UniqueID ne and{def}{pop pop}ifelse}forall[1 index 0 6 -1 roll exec 0 exch 5
-1 roll VResolution Resolution div mul neg 0 0]/Metrics exch def dict begin
Encoding{exch dup type /integertype ne{pop pop 1 sub dup 0 le{pop}{[}ifelse}{
FontMatrix 0 get div Metrics 0 get div def}ifelse}forall Metrics /Metrics
currentdict end def[2 index currentdict end definefont 3 -1 roll makefont
/setfont load]cvx def}def /ObliqueSlant{dup sin S cos div neg}B /SlantFont{4
index mul add}def /ExtendFont{3 -1 roll mul exch}def /ReEncodeFont{/Encoding
exch def}def end
%%EndProcSet
TeXDict begin 40258431 52099146 1000 300 300 @start /Fa 139[14
1[19 16[25 97[{}3 50.000000 /Times-BoldItalic rf /Fb 135[22
120[{}1 50.000000 /Times-Italic rf /Fc 80 126 df<00C00001C00001C00001C00003F0
000FFC003FFE007DCF0071C700E1C380E1C780E1C780E1C780F1C00079C0003FC0001FE0000FF8
0001FC0001DE0001CF0001C70061C380F1C380F1C380E1C380E1C70071C70079DE003FFE001FF8
0007E00001C00001C00001C00000C00011247D9F18>36 D<01C00007E0000FF0000E70001C3800
1C38001C38001C38001C73F81CF3F81CE3F80FC1C00FC3800F83800F03801F07003F87007B8E00
71CE00E1FC00E0FC00E07C00E07870E0787070FE707FFFE03FC7E00F03C0151C7F9B18>38
D<387C7C7E3E0E0E0E1C1C38F8F0C0070E789B18>I<007000F001E003C007800F001E001C0038
0038007000700070007000E000E000E000E000E000E000E000E000700070007000700038003800
1C001E000F00078003C001F000F000700C24799F18>I<6000F00078003C001E000F0007800380
01C001C000E000E000E000E00070007000700070007000700070007000E000E000E000E001C001
C0038007800F001E003C007800F00060000C247C9F18>I<01C00001C00001C00001C00041C100
F1C780FDDF807FFF001FFC0007F00007F0001FFC007FFF00FDDF80F1C78041C10001C00001C000
01C00001C00011147D9718>I<00600000F00000F00000F00000F00000F00000F00000F0007FFF
C0FFFFE0FFFFE07FFFC000F00000F00000F00000F00000F00000F00000F00000600013147E9718
>I<1C3E7E7F3F1F070E1E7CF860080C788518>I<7FFFC0FFFFE0FFFFE07FFFC013047E8F18>I<
3078FCFC78300606778518>I<000300000780000780000F80000F00001F00001E00001E00003E
00003C00007C0000780000780000F80000F00001F00001E00003E00003C00003C00007C0000780
000F80000F00000F00001F00001E00003E00003C00003C00007C0000780000F80000F00000F000
0060000011247D9F18>I<01F00007FC000FFE001F1F001C07003803807803C07001C07001C0E0
00E0E000E0E000E0E000E0E000E0E000E0E000E0E000E0E000E0F001E07001C07001C07803C038
03801C07001F1F000FFE0007FC0001F000131C7E9B18>I<01800380038007800F803F80FF80FB
80438003800380038003800380038003800380038003800380038003800380038003807FFCFFFE
7FFC0F1C7B9B18>I<03F0000FFE003FFF007C0F807003C0E001C0F000E0F000E06000E00000E0
0000E00001C00001C00003C0000780000F00001E00003C0000780000F00001E00007C0000F8000
1E00E03C00E07FFFE0FFFFE07FFFE0131C7E9B18>I<07F8001FFE003FFF007807807803C07801
C03001C00001C0000380000380000F0003FF0003FE0003FF000007800003C00001C00000E00000
E00000E0F000E0F000E0F001C0F003C07C07803FFF001FFE0003F800131C7E9B18>I<001F0000
3F0000770000770000E70001E70001C7000387000787000707000E07001E07003C070038070078
0700F00700FFFFF8FFFFF8FFFFF8000700000700000700000700000700000700007FF0007FF000
7FF0151C7F9B18>I<3FFF803FFF803FFF80380000380000380000380000380000380000380000
3800003BF8003FFE003FFF003C07803003C00001C00000E00000E06000E0F000E0F000E0E001C0
7003C07C0F803FFF001FFC0003F000131C7E9B18>I<007E0001FF0007FF800F83C01E03C01C03
C0380180380000700000700000E1F800E7FE00FFFF00FE0780F803C0F001C0F000E0E000E0F000
E07000E07000E07000E03801C03C03C01E07800FFF0007FE0001F800131C7E9B18>I<E00000FF
FFE0FFFFE0FFFFC0E00380E00700000F00001E00001C0000380000380000700000F00000E00000
E00001C00001C00001C00003800003800003800003800007000007000007000007000007000007
0000070000131D7E9C18>I<03F8000FFE001FFF003E0F803803807001C07001C07001C07001C0
3803803C07801FFF0007FC000FFE001F1F003C07807001C0F001E0E000E0E000E0E000E0E000E0
7001C07803C03E0F801FFF000FFE0003F800131C7E9B18>I<03F0000FFC001FFE003C0F007807
80700380E001C0E001C0E001C0E001E0E001E07001E07803E03C0FE01FFFE00FFEE003F0E00000
E00001C00001C00001C0300380780780780F00783E003FFC001FF00007C000131C7E9B18>I<30
78FCFC783000000000000000003078FCFC78300614779318>I<183C7E7E3C1800000000000000
00183C7E7E3E1E0E1C3C78F060071A789318>I<0000C00003E00007E0001FC0003F8000FE0001
FC0007F0000FE0003F80007F0000FC0000FC00007F00003F80000FE00007F00001FC0000FE0000
3F80001FC00007E00003E00000C013187E9918>I<7FFFC0FFFFE0FFFFE0FFFFE0000000000000
000000000000FFFFE0FFFFE0FFFFE07FFFC0130C7E9318>I<600000F80000FC00007F00003F80
000FE00007F00001FC0000FE00003F80001FC00007E00007E0001FC0003F8000FE0001FC0007F0
000FE0003F80007F0000FC0000F8000060000013187E9918>I<00700000F80000F80000D80000
D80001DC0001DC0001DC00018C00038E00038E00038E00038E0007070007070007070007070007
07000FFF800FFF800FFF800E03801C01C01C01C01C01C07F07F0FF07F87F07F0151C7F9B18>65
D<7FFC00FFFF007FFF801C03C01C01C01C00E01C00E01C00E01C00E01C01E01C01C01C07C01FFF
801FFF001FFFC01C03C01C00E01C00F01C00701C00701C00701C00701C00F01C00E01C03E07FFF
C0FFFF807FFE00141C7F9B18>I<00F8E003FEE007FFE00F07E01E03E03C01E03800E07000E070
00E0700000E00000E00000E00000E00000E00000E00000E00000E000007000007000E07000E038
00E03C00E01E01C00F07C007FF8003FE0000F800131C7E9B18>I<7FF800FFFE007FFF001C0F80
1C03C01C03C01C01E01C00E01C00E01C00F01C00701C00701C00701C00701C00701C00701C0070
1C00701C00F01C00E01C00E01C01E01C01C01C03C01C0F807FFF00FFFE007FF800141C7F9B18>
I<FFFFF0FFFFF0FFFFF01C00701C00701C00701C00701C00001C00001C0E001C0E001C0E001FFE
001FFE001FFE001C0E001C0E001C0E001C00001C00001C00381C00381C00381C00381C0038FFFF
F8FFFFF8FFFFF8151C7F9B18>I<FFFFF8FFFFF8FFFFF81C00381C00381C00381C00381C00001C
00001C07001C07001C07001FFF001FFF001FFF001C07001C07001C07001C00001C00001C00001C
00001C00001C00001C0000FFC000FFC000FFC000151C7F9B18>I<01F1C003FDC00FFFC01F0FC0
1C03C03803C03801C07001C07001C0700000E00000E00000E00000E00000E00000E00FF0E01FF0
E00FF07001C07001C07003C03803C03803C01C07C01F0FC00FFFC003FDC001F1C0141C7E9B18>
I<7F07F0FF8FF87F07F01C01C01C01C01C01C01C01C01C01C01C01C01C01C01C01C01C01C01FFF
C01FFFC01FFFC01C01C01C01C01C01C01C01C01C01C01C01C01C01C01C01C01C01C01C01C07F07
F0FF8FF87F07F0151C7F9B18>I<7FFF00FFFF807FFF0001C00001C00001C00001C00001C00001
C00001C00001C00001C00001C00001C00001C00001C00001C00001C00001C00001C00001C00001
C00001C00001C00001C0007FFF00FFFF807FFF00111C7D9B18>I<7F07F0FF87F87F07F01C03C0
1C07801C07001C0E001C1E001C3C001C38001C70001CF0001DF0001DF0001FB8001FB8001F1C00
1E1C001C0E001C0E001C07001C07001C03801C03801C01C07F03F0FF87F87F03F0151C7F9B18>
75 D<FFC000FFC000FFC0001C00001C00001C00001C00001C00001C00001C00001C00001C0000
1C00001C00001C00001C00001C00001C00001C00001C00001C00E01C00E01C00E01C00E01C00E0
FFFFE0FFFFE0FFFFE0131C7E9B18>I<FC01F8FE03F8FE03F83B06E03B06E03B06E03B06E03B8E
E03B8EE0398CE0398CE039DCE039DCE039DCE038D8E038D8E038F8E03870E03870E03800E03800
E03800E03800E03800E03800E0FE03F8FE03F8FE03F8151C7F9B18>I<7E07F0FF0FF87F07F01D
81C01D81C01D81C01DC1C01CC1C01CC1C01CE1C01CE1C01CE1C01C61C01C71C01C71C01C31C01C
39C01C39C01C39C01C19C01C19C01C1DC01C0DC01C0DC01C0DC07F07C0FF87C07F03C0151C7F9B
18>I<0FFE003FFF807FFFC07803C07001C0F001E0E000E0E000E0E000E0E000E0E000E0E000E0
E000E0E000E0E000E0E000E0E000E0E000E0E000E0E000E0E000E0E000E0F001E07001C07C07C0
7FFFC03FFF800FFE00131C7E9B18>I<FFFE00FFFF80FFFFC01C03C01C01E01C00E01C00701C00
701C00701C00701C00701C00E01C01E01C03C01FFFC01FFF801FFE001C00001C00001C00001C00
001C00001C00001C00001C0000FF8000FF8000FF8000141C7F9B18>I<0FFE003FFF807FFFC078
03C07001C0F001E0E000E0E000E0E000E0E000E0E000E0E000E0E000E0E000E0E000E0E000E0E0
00E0E000E0E000E0E000E0E070E0E070E0F079E07039C0783FC07FFFC03FFF800FFE00000F0000
07800007800003C00001C00001C013227E9B18>I<7FF800FFFE007FFF001C0F801C03801C03C0
1C01C01C01C01C01C01C03C01C03801C0F801FFF001FFE001FFE001C0F001C07001C03801C0380
1C03801C03801C03801C039C1C039C1C039C7F01F8FF81F87F00F0161C7F9B18>I<03F1C01FFF
C03FFFC07C0FC07003C0E001C0E001C0E001C0E000007000007800003F00001FF00007FE0000FF
00000F800003C00001C00000E00000E06000E0E000E0E001E0F001C0F80780FFFF80FFFE00E7F8
00131C7E9B18>I<7FFFF8FFFFF8FFFFF8E07038E07038E07038E0703800700000700000700000
700000700000700000700000700000700000700000700000700000700000700000700000700000
700000700007FF0007FF0007FF00151C7F9B18>I<FF83FEFF83FEFF83FE1C00701C00701C0070
1C00701C00701C00701C00701C00701C00701C00701C00701C00701C00701C00701C00701C0070
1C00701C00701C00700E00E00F01E00783C003FF8001FF00007C00171C809B18>I<FE03F8FF07
F8FE03F83C01E01C01C01C01C01C01C01E03C00E03800E03800E03800E03800707000707000707
00070700038E00038E00038E00038E00018C0001DC0001DC0001DC0000D80000F80000F8000070
00151C7F9B18>I<FE03F8FE03F8FE03F87000707000707000703800E03800E03800E03800E038
00E038F8E039FCE039DCE039DCE019DCC019DCC019DCC0198CC0198CC01D8DC01D8DC01D8DC01D
05C00D05800F07800F07800E0380151C7F9B18>I<7F0FE07F9FE07F0FE00E07000F0700070E00
078E00039C0003DC0001F80001F80000F80000F00000700000F00000F80001FC0001DC00039E00
038E00070F000707000E07800E03801E03C07F07F0FF07F87F07F0151C7F9B18>I<FE03F8FF07
F8FE03F81C01C01E03C00E03800F0780070700070700038E00038E0001DC0001DC0001DC0000F8
0000F80000700000700000700000700000700000700000700000700000700001FC0003FE0001FC
00151C7F9B18>I<3FFFE07FFFE07FFFE07001C07003C0700780700700000F00001E00001C0000
3C0000780000700000F00001E00001C00003C0000780000700000F00001E00E01C00E03C00E078
00E07000E0FFFFE0FFFFE0FFFFE0131C7E9B18>I<FFF8FFF8FFF8E000E000E000E000E000E000
E000E000E000E000E000E000E000E000E000E000E000E000E000E000E000E000E000E000E000E0
00E000E000E000E000FFF8FFF8FFF80D24779F18>I<FFF8FFF8FFF80038003800380038003800
380038003800380038003800380038003800380038003800380038003800380038003800380038
00380038003800380038FFF8FFF8FFF80D247F9F18>93 D<7FFFC0FFFFE0FFFFE07FFFC013047E
7F18>95 D<0FF0001FFC003FFE003C0F0018070000038000038000FF8007FF801FFF807F038078
0380E00380E00380E00380F00780780F803FFFF81FFDF807F0F815147E9318>97
D<7E0000FE00007E00000E00000E00000E00000E00000E00000E3E000EFF800FFFC00FC1E00F80
E00F00700E00700E00380E00380E00380E00380E00380E00380F00700F00700F80E00FC1E00FFF
C00EFF80063E00151C809B18>I<01FE0007FF001FFF803E0780380300700000700000E00000E0
0000E00000E00000E00000E000007000007001C03801C03E03C01FFF8007FF0001FC0012147D93
18>I<001F80003F80001F8000038000038000038000038000038003E3800FFB801FFF803C1F80
380F80700780700380E00380E00380E00380E00380E00380E00380700780700780380F803C1F80
1FFFF00FFBF803E3F0151C7E9B18>I<01F00007FC001FFE003E0F00380780700380700380E001
C0E001C0FFFFC0FFFFC0FFFFC0E000007000007001C03801C03E07C01FFF8007FF0001F8001214
7D9318>I<001F80007FC000FFE000E1E001C0C001C00001C00001C0007FFFC0FFFFC0FFFFC001
C00001C00001C00001C00001C00001C00001C00001C00001C00001C00001C00001C00001C00001
C0007FFF007FFF007FFF00131C7F9B18>I<01E1F007FFF80FFFF81E1E301C0E00380700380700
3807003807003807001C0E001E1E001FFC001FF80039E0003800001C00001FFE001FFFC03FFFE0
7801F0700070E00038E00038E00038E000387800F07E03F01FFFC00FFF8001FC00151F7F9318>
I<7E0000FE00007E00000E00000E00000E00000E00000E00000E3E000EFF800FFFC00FC1C00F80
E00F00E00E00E00E00E00E00E00E00E00E00E00E00E00E00E00E00E00E00E00E00E00E00E07FC7
FCFFE7FE7FC7FC171C809B18>I<038007C007C007C0038000000000000000007FC0FFC07FC001
C001C001C001C001C001C001C001C001C001C001C001C001C001C0FFFFFFFFFFFF101D7C9C18>
I<0038007C007C007C003800000000000000000FFC0FFC0FFC001C001C001C001C001C001C001C
001C001C001C001C001C001C001C001C001C001C001C001C001C001C001C6038F078FFF07FE03F
800E277E9C18>I<7E0000FE00007E00000E00000E00000E00000E00000E00000E3FF00E3FF00E
3FF00E07800E0F000E1E000E3C000E78000EF0000FF8000FFC000F9C000F0E000E0F000E07000E
03800E03C07FC7F8FFC7F87FC7F8151C7F9B18>I<FFC000FFC000FFC00001C00001C00001C000
01C00001C00001C00001C00001C00001C00001C00001C00001C00001C00001C00001C00001C000
01C00001C00001C00001C00001C00001C000FFFF80FFFF80FFFF80111C7D9B18>I<F9C1C0FFF7
F0FFFFF03E3E383C3C383C3C383838383838383838383838383838383838383838383838383838
38383838383838FE3E3EFE7E7EFE3E3E1714809318>I<7E3E00FEFF807FFFC00FC1C00F80E00F
00E00E00E00E00E00E00E00E00E00E00E00E00E00E00E00E00E00E00E00E00E00E00E07FC7FCFF
E7FE7FC7FC1714809318>I<01F0000FFE001FFF003E0F803803807001C07001C0E000E0E000E0
E000E0E000E0E000E0F001E07001C07803C03C07803E0F801FFF000FFE0001F00013147E9318>
I<7E3E00FEFF807FFFC00FC1E00F80E00F00700E00700E00380E00380E00380E00380E00380E00
380F00700F00700F80E00FC1E00FFFC00EFF800E3E000E00000E00000E00000E00000E00000E00
000E00007FC000FFE0007FC000151E809318>I<FF0FC0FF3FE0FF7FF007F0F007E06007C00007
8000078000070000070000070000070000070000070000070000070000070000FFFC00FFFE00FF
FC0014147E9318>114 D<07F7003FFF007FFF00780F00E00700E00700E007007C00007FE0001F
FC0003FE00001F00600780E00380E00380F00380F80F00FFFF00FFFC00E7F00011147D9318>I<
0180000380000380000380000380007FFFC0FFFFC0FFFFC0038000038000038000038000038000
0380000380000380000380000380400380E00380E00380E001C1C001FFC000FF80003E0013197F
9818>I<7E07E0FE0FE07E07E00E00E00E00E00E00E00E00E00E00E00E00E00E00E00E00E00E00
E00E00E00E00E00E00E00E01E00F03E007FFFC03FFFE01FCFC1714809318>I<7F8FF0FF8FF87F
8FF01C01C00E03800E03800E0380070700070700070700078F00038E00038E00038E0001DC0001
DC0001DC0000F80000F80000700015147F9318>I<FF07F8FF8FF8FF07F83800E03800E03800E0
3800E01C01C01C71C01CF9C01CF9C01CD9C01DDDC00DDD800DDD800DDD800D8D800F8F800F8F80
07070015147F9318>I<7F8FF07F9FF07F8FF00F0700078E00039E0001DC0001F80000F8000070
0000F00000F80001DC00039E00038E000707000E07807F8FF0FF8FF87F8FF015147F9318>I<7F
8FF0FF8FF87F8FF00E01C00E03800E0380070380070700070700038700038700038E0001CE0001
CE0001CC0000CC0000DC0000780000780000780000700000700000700000F00000E00079E0007B
C0007F80003F00001E0000151E7F9318>I<0007E0001FE0007FE000780000E00000E00000E000
00E00000E00000E00000E00000E00000E00000E00000E00001E0007FC000FF8000FF80007FC000
01E00000E00000E00000E00000E00000E00000E00000E00000E00000E00000E00000E000007800
007FE0001FE00007E013247E9F18>123 D<7C0000FF0000FFC00003C00000E00000E00000E000
00E00000E00000E00000E00000E00000E00000E00000E00000F000007FC0003FE0003FE0007FC0
00F00000E00000E00000E00000E00000E00000E00000E00000E00000E00000E00000E00003C000
FFC000FF00007C000013247E9F18>125 D E /Fd 130[22 1[22 1[22 22
1[22 22 22 22 22 1[22 22 22 22 22 22 1[22 22 22 22 22 22 22
22 22 1[22 5[22 2[22 22 22 22 22 1[22 22 22 22 22 1[22 2[22
22 22 22 22 1[22 22 1[22 22 1[22 10[22 22 22 22 22 2[22 22
4[22 35[{}55 37.500000 /Courier rf /Fe 134[23 4[13 1[15 1[23
23 23 35 13 6[20 3[20 97[{.167 SlantFont}10 45.624989 /Times-Roman
rf /Ff 145[27 110[{}1 45.624989 /Courier-Oblique rf /Fg 130[27
1[27 27 27 27 27 27 27 27 27 27 1[27 27 27 27 27 27 27 27 27
27 27 27 27 27 27 27 1[27 1[27 1[27 1[27 27 1[27 27 27 27 27
1[27 27 27 27 27 27 1[27 27 27 27 27 27 27 27 27 2[27 27 27
27 1[27 27 27 27 27 27 27 27 27 27 27 27 27 27 27 27 27 27
27 27 27 1[27 27 27 33[{}80 45.624989 /Courier rf /Fh 133[25
28 26 42 28 30 16 21 20 1[30 27 29 44 14 28 12 14 29 28 17
24 30 22 28 25 12[31 26 33 3[41 47 30 6[30 2[30 15[25 25 2[12
1[12 44[{}37 50.000000 /Palatino-Roman rf /Fi 81[23 51[23 23
23 33 23 25 13 23 15 1[25 25 25 38 10 23 1[10 25 25 13 25 25
23 25 25 6[28 30 30 43 1[33 28 30 33 1[30 35 33 38 25 2[13
33 35 28 30 33 33 30 30 46 4[13 13 4[25 1[25 1[25 25 13 13
15 13 27 1[15 15 40[{}61 45.624989 /Helvetica rf /Fj 36 124
df<6060F0F0F8F86868080808080808101010102020404080800D0C7F9C15>34
D<0300030003000300C30CE31C73381FE0078007801FE07338E31CC30C03000300030003000E12
7D9E15>42 D<60F0F0701010101020204080040C7C830C>44 D<60F0F06004047C830C>46
D<00010003000600060006000C000C000C0018001800180030003000300060006000C000C000C0
018001800180030003000300060006000C000C000C001800180018003000300030006000600060
00C000C00010297E9E15>I<03C00C301818300C300C700E60066006E007E007E007E007E007E0
07E007E007E007E007E007E007E00760066006700E300C300C18180C3007E0101D7E9B15>I<00
0600000006000000060000000F0000000F0000000F000000178000001780000037C0000023C000
0023C0000043E0000041E0000041E0000080F0000080F0000080F000010078000100780001FFF8
0002003C0002003C0002003C0004001E0004001E000C001F000C000F001E001F00FF00FFF01C1D
7F9C1F>65 D<FFFFC0000F0078000F003C000F001E000F000E000F000F000F000F000F000F000F
000F000F000E000F001E000F003C000F00F8000FFFF0000F003C000F001E000F000F000F000700
0F0007800F0007800F0007800F0007800F0007800F000F000F000F000F001E000F007800FFFFE0
00191C7F9B1D>I<FFFFFC0F003C0F000C0F00040F00040F00060F00020F00020F01020F01000F
01000F01000F03000FFF000F03000F01000F01000F01000F01010F00010F00020F00020F00020F
00060F00060F000C0F003CFFFFFC181C7E9B1C>69 D<FFF00F000F000F000F000F000F000F000F
000F000F000F000F000F000F000F000F000F000F000F000F000F000F000F000F000F000F00FFF0
0C1C7F9B0F>73 D<003F800000E0E0000380380007001C000E000E001C0007003C000780380003
80780003C0780003C0700001C0F00001E0F00001E0F00001E0F00001E0F00001E0F00001E0F000
01E0F00001E0700001C0780003C0780003C0380003803C0007801C0007000E000E0007001C0003
80380000E0E000003F80001B1E7E9C20>79 D<FFFF00000F01E0000F0078000F003C000F001C00
0F001E000F001E000F001E000F001E000F001C000F003C000F0078000F01E0000FFF00000F01E0
000F0070000F0078000F003C000F003C000F003C000F003C000F003C000F003C000F003C100F00
3C100F001C100F001C10FFF00E20000003C01C1D7E9B1F>82 D<07E0801C198030058030038060
0180E00180E00080E00080E00080F00000F800007C00007FC0003FF8001FFE0007FF0000FF8000
0F800007C00003C00001C08001C08001C08001C0C00180C00180E00300D00200CC0C0083F80012
1E7E9C17>I<08081010202040404040808080808080B0B0F8F8787830300D0C7A9C15>92
D<1FC000307000783800781C00301C00001C00001C0001FC000F1C00381C00701C00601C00E01C
40E01C40E01C40603C40304E801F870012127E9115>97 D<FC00001C00001C00001C00001C0000
1C00001C00001C00001C00001C00001C00001C7C001D87001E01801C00C01C00E01C00601C0070
1C00701C00701C00701C00701C00701C00601C00E01C00C01E018019070010FC00141D7F9C17>
I<03F80C0C181E301E700C6000E000E000E000E000E000E00060007002300218040C1803E00F12
7F9112>I<001F8000038000038000038000038000038000038000038000038000038000038003
F3800E0B80180780300380700380600380E00380E00380E00380E00380E00380E0038060038070
03803003801807800E1B8003E3F0141D7F9C17>I<07E00C301818300C700E6006E006FFFEE000
E000E000E00060007002300218040C1803E00F127F9112>I<00F8018C071E061E0E0C0E000E00
0E000E000E000E00FFE00E000E000E000E000E000E000E000E000E000E000E000E000E000E000E
000E007FE00F1D809C0D>I<00038007C4C01C78C0383880301800701C00701C00701C00701C00
3018003838001C700027C0002000002000003000003FF8001FFF001FFF802003806001C0C000C0
C000C0C000C06001803003001C0E0007F800121C7F9215>I<FC00001C00001C00001C00001C00
001C00001C00001C00001C00001C00001C00001C7C001C87001D03001E03801C03801C03801C03
801C03801C03801C03801C03801C03801C03801C03801C03801C03801C0380FF9FF0141D7F9C17
>I<18003C003C0018000000000000000000000000000000FC001C001C001C001C001C001C001C
001C001C001C001C001C001C001C001C001C00FF80091D7F9C0C>I<FC001C001C001C001C001C
001C001C001C001C001C001C001C001C001C001C001C001C001C001C001C001C001C001C001C00
1C001C001C00FF80091D7F9C0C>108 D<FC7E07E0001C838838001D019018001E01E01C001C01
C01C001C01C01C001C01C01C001C01C01C001C01C01C001C01C01C001C01C01C001C01C01C001C
01C01C001C01C01C001C01C01C001C01C01C001C01C01C00FF8FF8FF8021127F9124>I<FC7C00
1C87001D03001E03801C03801C03801C03801C03801C03801C03801C03801C03801C03801C0380
1C03801C03801C0380FF9FF014127F9117>I<03F0000E1C00180600300300700380600180E001
C0E001C0E001C0E001C0E001C0E001C06001807003803003001806000E1C0003F00012127F9115
>I<FC7C001D87001E01801C01C01C00E01C00E01C00701C00701C00701C00701C00701C00701C
00E01C00E01C01C01E01801D07001CFC001C00001C00001C00001C00001C00001C00001C0000FF
8000141A7F9117>I<FCE01D381E781E781C301C001C001C001C001C001C001C001C001C001C00
1C001C00FFC00D127F9110>114 D<1F9020704030C010C010E010F8007F803FE00FF000F88038
8018C018C018E010D0608FC00D127F9110>I<04000400040004000C000C001C003C00FFE01C00
1C001C001C001C001C001C001C001C001C101C101C101C101C100C100E2003C00C1A7F9910>I<
FC1F801C03801C03801C03801C03801C03801C03801C03801C03801C03801C03801C03801C0380
1C03801C07800C07800E1B8003E3F014127F9117>I<FF07E03C03801C01001C01000E02000E02
000F060007040007040003880003880003C80001D00001D00000E00000E00000E0000040001312
7F9116>I<FF3FC7E03C0703C01C0701801C0701001C0B01000E0B82000E0B82000E1182000711
C4000711C4000720C40003A0E80003A0E80003C0680001C0700001C0700001803000008020001B
127F911E>I<FF07E03C03801C01001C01000E02000E02000F0600070400070400038800038800
03C80001D00001D00000E00000E00000E000004000004000008000008000F08000F10000F30000
660000380000131A7F9116>121 D<FFFFF01401808B15>123 D E /Fk 3
104 df<03F0000FFC001FFE003FFF007FFF807FFF80FFFFC0FFFFC0FFFFC0FFFFC0FFFFC0FFFF
C07FFF807FFF803FFF001FFE000FFC0003F00012127E9317>15 D<000F0038006000E001C001C0
01C001C001C001C001C001C001C001C001C001C001C001C001C0038007001E00F8001E00070003
8001C001C001C001C001C001C001C001C001C001C001C001C001C001C001C000E000600038000F
102D7DA117>102 D<F8001E000700038001C001C001C001C001C001C001C001C001C001C001C0
01C001C001C001C000E000600038000F0038006000E001C001C001C001C001C001C001C001C001
C001C001C001C001C001C001C0038007001E00F800102D7DA117>I E /Fl
50 123 df<000FF83F00007FFDFFC001F81FE3E003E03F87E007C03F87E00F803F07E00F803F03
C00F801F00000F801F00000F801F00000F801F00000F801F00000F801F0000FFFFFFFC00FFFFFF
FC000F801F00000F801F00000F801F00000F801F00000F801F00000F801F00000F801F00000F80
1F00000F801F00000F801F00000F801F00000F801F00000F801F00000F801F00000F801F00000F
801F00000F801F00000F801F00007FF0FFF0007FF0FFF00023237FA221>11
D<00700000F800007000007000207020707070FC71F87E73F03F27E007AF0000F80000F80007AF
003F27E07E73F0FC71F870707020702000700000700000F80000700015167DA41C>42
D<03FC000FFF003C1FC07007E07C07F0FE03F0FE03F8FE03F8FE01F87C01F83803F80003F80003
F00003F00007E00007C0000F80001F00003E0000380000700000E01801C0180380180700180E00
380FFFF01FFFF03FFFF07FFFF0FFFFF0FFFFF015207D9F1C>50 D<000070000000007000000000
F800000000F800000000F800000001FC00000001FC00000003FE00000003FE00000003FE000000
067F000000067F0000000C7F8000000C3F8000000C3F800000181FC00000181FC00000301FE000
00300FE00000700FF000006007F000006007F00000C007F80000FFFFF80001FFFFFC00018001FC
00018001FC00030001FE00030000FE00070000FF000600007F000600007F00FFE007FFF8FFE007
FFF825227EA12A>65 D<FFFFFF8000FFFFFFF00007F001F80007F000FC0007F0007E0007F0007E
0007F0007F0007F0007F0007F0007F0007F0007F0007F0007F0007F0007E0007F000FE0007F000
FC0007F003F80007FFFFF00007FFFFF00007F001FC0007F0007E0007F0003F0007F0003F8007F0
001F8007F0001FC007F0001FC007F0001FC007F0001FC007F0001FC007F0001FC007F0003F8007
F0003F8007F0007F0007F001FE00FFFFFFF800FFFFFFC00022227EA128>I<0003FE0080001FFF
818000FF01E38001F8003F8003E0001F8007C0000F800F800007801F800007803F000003803F00
0003807F000001807E000001807E00000180FE00000000FE00000000FE00000000FE00000000FE
00000000FE00000000FE00000000FE000000007E000000007E000001807F000001803F00000180
3F000003801F800003000F8000030007C000060003F0000C0001F800380000FF00F000001FFFC0
000003FE000021227DA128>I<FFFFFF8000FFFFFFF00007F003FC0007F0007E0007F0003F0007
F0001F8007F0000FC007F00007E007F00007E007F00007F007F00003F007F00003F007F00003F0
07F00003F807F00003F807F00003F807F00003F807F00003F807F00003F807F00003F807F00003
F807F00003F807F00003F007F00003F007F00003F007F00007E007F00007E007F0000FC007F000
1F8007F0003F0007F0007E0007F003FC00FFFFFFF000FFFFFF800025227EA12B>I<FFFFFFFCFF
FFFFFC07F000FC07F0003C07F0001C07F0000C07F0000E07F0000E07F0000607F00C0607F00C06
07F00C0607F00C0007F01C0007F03C0007FFFC0007FFFC0007F03C0007F01C0007F00C0007F00C
0007F00C0307F00C0307F0000307F0000607F0000607F0000607F0000E07F0000E07F0001E07F0
003E07F001FCFFFFFFFCFFFFFFFC20227EA125>I<FFFFFFF8FFFFFFF807F001F807F0007807F0
003807F0001807F0001C07F0001C07F0000C07F0000C07F0180C07F0180C07F0180007F0180007
F0380007F0780007FFF80007FFF80007F0780007F0380007F0180007F0180007F0180007F01800
07F0000007F0000007F0000007F0000007F0000007F0000007F0000007F00000FFFFC000FFFFC0
001E227EA123>I<0003FE0040001FFFC0C0007F00F1C001F8003FC003F0000FC007C00007C00F
C00003C01F800003C03F000001C03F000001C07F000000C07E000000C07E000000C0FE00000000
FE00000000FE00000000FE00000000FE00000000FE00000000FE00000000FE000FFFFC7E000FFF
FC7F00001FC07F00001FC03F00001FC03F00001FC01F80001FC00FC0001FC007E0001FC003F000
1FC001FC003FC0007F80E7C0001FFFC3C00003FF00C026227DA12C>I<FFFF83FFFEFFFF83FFFE
07F0001FC007F0001FC007F0001FC007F0001FC007F0001FC007F0001FC007F0001FC007F0001F
C007F0001FC007F0001FC007F0001FC007F0001FC007F0001FC007FFFFFFC007FFFFFFC007F000
1FC007F0001FC007F0001FC007F0001FC007F0001FC007F0001FC007F0001FC007F0001FC007F0
001FC007F0001FC007F0001FC007F0001FC007F0001FC007F0001FC007F0001FC0FFFF83FFFEFF
FF83FFFE27227EA12C>I<FFFF80FFFF8007F00007F00007F00007F00007F00007F00007F00007
F00007F00007F00007F00007F00007F00007F00007F00007F00007F00007F00007F00007F00007
F00007F00007F00007F00007F00007F00007F00007F00007F00007F000FFFF80FFFF8011227EA1
15>I<01FFFF8001FFFF800003F8000003F8000003F8000003F8000003F8000003F8000003F800
0003F8000003F8000003F8000003F8000003F8000003F8000003F8000003F8000003F8000003F8
000003F8000003F8000003F8000003F8000003F8001803F8007E03F800FF03F800FF03F800FF03
F800FF03F0007E07E0007C0FC0001FFF800007FC0000192280A11D>I<FFFFC000FFFFC00007F0
000007F0000007F0000007F0000007F0000007F0000007F0000007F0000007F0000007F0000007
F0000007F0000007F0000007F0000007F0000007F0000007F0000007F0000007F0000007F00018
07F0001807F0001807F0001807F0003807F0003807F0007007F0007007F000F007F001F007F007
F0FFFFFFF0FFFFFFF01D227EA122>76 D<FFF000000FFFFFF800001FFF07F800001FE006FC0000
37E006FC000037E006FC000037E0067E000067E0067E000067E0063F0000C7E0063F0000C7E006
1F800187E0061F800187E0060FC00307E0060FC00307E0060FC00307E00607E00607E00607E006
07E00603F00C07E00603F00C07E00601F81807E00601F81807E00601F81807E00600FC3007E006
00FC3007E006007E6007E006007E6007E006003FC007E006003FC007E006001F8007E006001F80
07E006001F8007E006000F0007E0FFF00F00FFFFFFF00600FFFF30227EA135>I<FFF8001FFEFF
FC001FFE07FC0000C007FE0000C006FF0000C0067F8000C0063FC000C0061FE000C0060FE000C0
060FF000C00607F800C00603FC00C00601FE00C00600FE00C00600FF00C006007F80C006003FC0
C006001FE0C006000FF0C0060007F0C0060007F8C0060003FCC0060001FEC0060000FFC0060000
7FC00600007FC00600003FC00600001FC00600000FC006000007C006000003C006000003C0FFF0
0001C0FFF00000C027227EA12C>I<0007FC0000003FFF800000FC07E00003F001F80007E000FC
000FC0007E001F80003F001F80003F003F00001F803F00001F807F00001FC07E00000FC07E0000
0FC0FE00000FE0FE00000FE0FE00000FE0FE00000FE0FE00000FE0FE00000FE0FE00000FE0FE00
000FE0FE00000FE07E00000FC07F00001FC07F00001FC03F00001F803F80003F801F80003F000F
C0007E0007E000FC0003F001F80000FC07E000003FFF80000007FC000023227DA12A>I<FFFFFF
00FFFFFFE007F007F007F001FC07F000FC07F0007E07F0007E07F0007F07F0007F07F0007F07F0
007F07F0007F07F0007E07F0007E07F000FC07F001FC07F007F007FFFFE007FFFF0007F0000007
F0000007F0000007F0000007F0000007F0000007F0000007F0000007F0000007F0000007F00000
07F0000007F00000FFFF8000FFFF800020227EA126>I<FFFFFE0000FFFFFFC00007F007F00007
F001F80007F000FC0007F0007E0007F0007F0007F0007F0007F0007F0007F0007F0007F0007F00
07F0007F0007F0007E0007F000FC0007F001F80007F007F00007FFFFC00007FFFF800007F00FE0
0007F007F00007F003F80007F001FC0007F001FC0007F001FC0007F001FC0007F001FC0007F001
FC0007F001FC0007F001FC0007F001FC0607F000FE0607F000FF0CFFFF803FF8FFFF800FF02722
7EA12A>82 D<01FE0207FF861F01FE3C007E7C001E78000E78000EF80006F80006FC0006FC0000
FF0000FFE0007FFF007FFFC03FFFF01FFFF80FFFFC03FFFE003FFE0003FE00007F00003F00003F
C0001FC0001FC0001FE0001EE0001EF0003CFC003CFF00F8C7FFE080FF8018227DA11F>I<7FFF
FFFF807FFFFFFF807E03F80F807803F807807003F803806003F80180E003F801C0E003F801C0C0
03F800C0C003F800C0C003F800C0C003F800C00003F800000003F800000003F800000003F80000
0003F800000003F800000003F800000003F800000003F800000003F800000003F800000003F800
000003F800000003F800000003F800000003F800000003F800000003F800000003F800000003F8
000001FFFFF00001FFFFF00022227EA127>I<FFFF803FFCFFFF803FFC07F000018007F0000180
07F000018007F000018007F000018007F000018007F000018007F000018007F000018007F00001
8007F000018007F000018007F000018007F000018007F000018007F000018007F000018007F000
018007F000018007F000018007F000018007F000018007F000018007F000018003F000030003F8
00030001F800060000FC000E00007E001C00003F80F800000FFFE0000001FF000026227EA12B>
I<FFFF000FFEFFFF000FFE07F00000C007F00000C003F800018003F800018003FC00038001FC00
030001FE00030000FE00060000FF000600007F000C00007F000C00007F801C00003F801800003F
C03800001FC03000001FE03000000FE06000000FE060000007F0C0000007F0C0000007F9C00000
03F980000003FD80000001FF00000001FF00000000FE00000000FE00000000FE000000007C0000
00007C00000000380000000038000027227FA12A>I<FFFF0FFFF00FFEFFFF0FFFF00FFE0FF000
FF0000E007F0007F0000C007F0007F0000C003F8003F80018003F8003F80018003FC003FC00180
01FC003FC0030001FC003FC0030001FE007FE0070000FE006FE0060000FE006FE00600007F00C7
F00C00007F00C7F00C00007F81C7F80C00003F8183F81800003F8183F81800003FC301FC380000
1FC301FC3000001FC301FE3000000FE600FE6000000FE600FE6000000FFE00FFE0000007FC007F
C0000007FC007FC0000003F8003F80000003F8003F80000003F8003F80000001F0001F00000001
F0001F00000001F0001F00000000E0000E00000000E0000E000037227FA13A>I<7FFFC1FFF87F
FFC1FFF803FC000C0001FE00180001FE00380000FF003000007F806000007F80E000003FC1C000
001FE18000001FE30000000FF700000007FE00000003FC00000003FC00000001FE00000000FE00
000000FF00000000FF80000001FFC0000001BFC00000031FE00000070FF000000E0FF000000C07
F800001803FC00003803FC00007001FE00006000FF0000C000FF0001C0007F800180003FC0FFFC
03FFFEFFFC03FFFE27227FA12A>I<0FFC003FFF807E07C07E03E07E01E07E01F03C01F00001F0
0001F0003FF003FDF01FC1F03F01F07E01F0FC01F0FC01F0FC01F0FC01F07E02F07E0CF81FF87F
07E03F18167E951B>97 D<FF000000FF0000001F0000001F0000001F0000001F0000001F000000
1F0000001F0000001F0000001F0000001F0000001F0000001F0FE0001F3FF8001FE07C001F803E
001F001F001F000F801F000F801F000FC01F000FC01F000FC01F000FC01F000FC01F000FC01F00
0FC01F000FC01F000F801F001F801F801F001FC03E001EE07C001C3FF800180FC0001A237EA21F
>I<00FF8007FFE00F83F01F03F03E03F07E03F07C01E07C0000FC0000FC0000FC0000FC0000FC
0000FC00007C00007E00007E00003E00181F00300FC06007FFC000FF0015167E9519>I<0001FE
000001FE0000003E0000003E0000003E0000003E0000003E0000003E0000003E0000003E000000
3E0000003E0000003E0001FC3E0007FFBE000F81FE001F007E003E003E007E003E007C003E00FC
003E00FC003E00FC003E00FC003E00FC003E00FC003E00FC003E00FC003E007C003E007C003E00
3E007E001F00FE000F83BE0007FF3FC001FC3FC01A237EA21F>I<00FE0007FF800F87C01E01E0
3E01F07C00F07C00F8FC00F8FC00F8FFFFF8FFFFF8FC0000FC0000FC00007C00007C00007E0000
3E00181F00300FC07003FFC000FF0015167E951A>I<001FC0007FE000F1F001E3F003E3F007C3
F007C1E007C00007C00007C00007C00007C00007C000FFFE00FFFE0007C00007C00007C00007C0
0007C00007C00007C00007C00007C00007C00007C00007C00007C00007C00007C00007C00007C0
0007C0003FFC003FFC00142380A211>I<01FE0F0007FFBF800F87C7801F03E7801E01E0003E01
F0003E01F0003E01F0003E01F0003E01F0001E01E0001F03E0000F87C0000FFF800009FE000018
000000180000001C0000001FFFE0000FFFF80007FFFE001FFFFF003C003F0078000F80F0000780
F0000780F0000780F000078078000F003C001E001F007C000FFFF80001FFC00019217F951C>I<
FF000000FF0000001F0000001F0000001F0000001F0000001F0000001F0000001F0000001F0000
001F0000001F0000001F0000001F07E0001F1FF8001F307C001F403C001F803E001F803E001F00
3E001F003E001F003E001F003E001F003E001F003E001F003E001F003E001F003E001F003E001F
003E001F003E001F003E001F003E00FFE1FFC0FFE1FFC01A237EA21F>I<1C003E007F007F007F
003E001C000000000000000000000000000000FF00FF001F001F001F001F001F001F001F001F00
1F001F001F001F001F001F001F001F001F001F00FFE0FFE00B247EA310>I<0038007C00FE00FE
00FE007C0038000000000000000000000000000003FE03FE003E003E003E003E003E003E003E00
3E003E003E003E003E003E003E003E003E003E003E003E003E003E003E003E783EFC3EFC3CFC7C
78F87FE01F800F2E83A311>I<FF000000FF0000001F0000001F0000001F0000001F0000001F00
00001F0000001F0000001F0000001F0000001F0000001F0000001F00FF801F00FF801F0038001F
0060001F01C0001F0380001F0700001F0E00001F1C00001F7E00001FFF00001FCF00001F0F8000
1F07C0001F03E0001F01E0001F01F0001F00F8001F007C001F003C00FFE0FFC0FFE0FFC01A237E
A21E>I<FF00FF001F001F001F001F001F001F001F001F001F001F001F001F001F001F001F001F
001F001F001F001F001F001F001F001F001F001F001F001F001F001F001F00FFE0FFE00B237EA2
10>I<FF07F007F000FF1FFC1FFC001F303E303E001F403E403E001F801F801F001F801F801F00
1F001F001F001F001F001F001F001F001F001F001F001F001F001F001F001F001F001F001F001F
001F001F001F001F001F001F001F001F001F001F001F001F001F001F001F001F001F001F001F00
1F001F001F00FFE0FFE0FFE0FFE0FFE0FFE02B167E9530>I<FF07E000FF1FF8001F307C001F40
3C001F803E001F803E001F003E001F003E001F003E001F003E001F003E001F003E001F003E001F
003E001F003E001F003E001F003E001F003E001F003E001F003E00FFE1FFC0FFE1FFC01A167E95
1F>I<00FE0007FFC00F83E01E00F03E00F87C007C7C007C7C007CFC007EFC007EFC007EFC007E
FC007EFC007EFC007E7C007C7C007C3E00F81F01F00F83E007FFC000FE0017167E951C>I<FF0F
E000FF3FF8001FE07C001F803E001F001F001F001F801F001F801F000FC01F000FC01F000FC01F
000FC01F000FC01F000FC01F000FC01F000FC01F001F801F001F801F803F001FC03E001FE0FC00
1F3FF8001F0FC0001F0000001F0000001F0000001F0000001F0000001F0000001F0000001F0000
00FFE00000FFE000001A207E951F>I<FE1F00FE3FC01E67E01EC7E01E87E01E87E01F83C01F00
001F00001F00001F00001F00001F00001F00001F00001F00001F00001F00001F00001F0000FFF0
00FFF00013167E9517>114 D<0FF3003FFF00781F00600700E00300E00300F00300FC00007FE0
007FF8003FFE000FFF0001FF00000F80C00780C00380E00380E00380F00700FC0E00EFFC00C7F0
0011167E9516>I<0180000180000180000180000380000380000780000780000F80003F8000FF
FF00FFFF000F80000F80000F80000F80000F80000F80000F80000F80000F80000F80000F80000F
81800F81800F81800F81800F81800F830007C30003FE0000F80011207F9F16>I<FF01FE00FF01
FE001F003E001F003E001F003E001F003E001F003E001F003E001F003E001F003E001F003E001F
003E001F003E001F003E001F003E001F003E001F003E001F007E001F00FE000F81BE0007FF3FC0
01FC3FC01A167E951F>I<FFE01FE0FFE01FE01F8007000F8006000FC00E0007C00C0007E00C00
03E0180003E0180001F0300001F0300000F8600000F86000007CC000007CC000007FC000003F80
00003F8000001F0000001F0000000E0000000E00001B167F951E>I<FFE3FF07F8FFE3FF07F81F
007800C01F807C01C00F807C01800F807C018007C07E030007C0DE030007C0DE070003E1DF0600
03E18F060001F18F8C0001F3078C0001F3078C0000FF07D80000FE03D80000FE03F800007C01F0
00007C01F000003C01E000003800E000003800E00025167F9528>I<FFE07FC0FFE07FC00F801C
0007C0380003E0700003F0600001F8C00000F98000007F8000003F0000001F0000001F8000003F
C0000037C0000063E00000C1F00001C0F8000380FC0007007E000E003E00FF80FFE0FF80FFE01B
167F951E>I<FFE01FE0FFE01FE01F8007000F8006000FC00E0007C00C0007E00C0003E0180003
E0180001F0300001F0300000F8600000F86000007CC000007CC000007FC000003F8000003F8000
001F0000001F0000000E0000000E0000000C0000000C00000018000078180000FC380000FC3000
00FC60000069C000007F8000001F0000001B207F951E>I<7FFFF07FFFF07C03E07007C0600FC0
E01F80C01F00C03E00C07E0000FC0000F80001F00003F03007E03007C0300F80701F80703F0060
3E00E07C03E0FFFFE0FFFFE014167E9519>I E /Fm 44 122 df<0007E0001C1000703800E078
01C07801C03001C00001C0000380000380000380003FFFF00380F00380700700E00700E00700E0
0700E00700E00700E00E01C00E01C00E01C00E01C00E01C00E01C01C03801C03C0FF8FF0151D7F
9C17>12 D<00C000C000C000806083708F399C0FF003C003C00D603938E31CC30C030002000600
060010127A9E15>42 D<0000200000003000000070000000F0000000F0000001F0000001F80000
0278000002780000047800000478000008780000083C0000103C0000103C0000203C0000203C00
00403E0000401E0000FFFE0000801E0001001E0001001F0002000F0002000F0004000F000C000F
001E000F80FF807FF01C1D7F9C1F>65 D<07FFFE0000F8078000F001C000F001E000F000E000F0
00F000F000F001E000E001E001E001E001C001E003C001E0078001E01E0003FFFC0003C00F0003
C0078003C003C003C003C003C003C0078003C0078003C0078003C0078003C00780078007800F00
0F001E000F003C00FFFFE0001C1C7F9B1D>I<0007F010001C0C300070026000C001E0038000E0
070000E00E0000600E0000601C0000403C00004038000040780000007800000078000000F00000
00F0000000F0000000F0000000F0000000F0000080F00001007000010070000100380002003800
04001C0004000C001800060020000380C000007F00001C1E7C9C1E>I<0FFFFC0000F8078000F0
01C000F000E000F0007000F0007000F0007801E0003801E0003801E0003801E0003801E0003C01
E0003803C0003803C0007803C0007803C0007803C0007003C000F0078000E0078000E0078001C0
078003800780078007800E000F001C000F007000FFFFC0001E1C7E9B20>I<07FFFFE000F801E0
00F000E000F0004000F0004000F0004000F0004001E0004001E0204001E0200001E0200001E060
0001E0E00003FFC00003C0C00003C0400003C0400003C0400003C0408007800080078000800780
01000780010007800300078006000F000E000F003E00FFFFFC001B1C7E9B1C>I<07FFFFC000F8
03C000F001C000F0008000F0008000F0008000F0008001E0008001E0208001E0200001E0200001
E0600001E0E00003FFC00003C0C00003C0400003C0400003C0400003C040000780000007800000
078000000780000007800000078000000F0000000F800000FFF800001A1C7E9B1B>I<07FF87FF
8000F800F80000F000F00000F000F00000F000F00000F000F00000F000F00001E001E00001E001
E00001E001E00001E001E00001E001E00001E001E00003FFFFC00003C003C00003C003C00003C0
03C00003C003C00003C003C0000780078000078007800007800780000780078000078007800007
800780000F000F00000F800F8000FFF0FFF000211C7F9B1F>72 D<07FF00F800F000F000F000F0
00F001E001E001E001E001E001E003C003C003C003C003C003C00780078007800780078007800F
000F80FFF0101C7F9B0F>I<07FFC000F80000F00000F00000F00000F00000F00001E00001E000
01E00001E00001E00001E00003C00003C00003C00003C00003C00003C004078004078004078004
0780080780080780180F00380F00F0FFFFF0161C7E9B1A>76 D<07F80007FC00F8000FC000BC00
0F8000BC00178000BC00178000BC00278000BC002780011E004F00011E004F00011E008F00011E
008F00011E010F00010F010F00020F021E00020F021E00020F041E00020F041E000207881E0002
07901E000407903C000407A03C000407A03C000407C03C000403C03C000403803C000C03807800
1E03007C00FF8307FF80261C7E9B26>I<07F800FF8000F8003C0000BC00180000BC001000009E
001000009F001000008F001000010F80200001078020000107C020000103C020000103E0200001
01E020000200F040000200F040000200784000020078400002003C400002003C400004001E8000
04001F800004000F800004000F8000040007800004000780000C000300001E00010000FF800100
00211C7F9B1F>I<0007F00000381C0000E00E0001C0030003800380070001C00E0001C01E0001
E01C0000E03C0000E0380000E0780000F0780000F0780000F0F00001E0F00001E0F00001E0F000
01E0F00003C0F00003C0F00003C0700007807000070078000F0038001E003C001C001C0038000E
00E0000383800000FE00001C1E7C9C20>I<07FFFC0000F80F0000F0038000F003C000F001C000
F001C000F001C001E003C001E003C001E003C001E0038001E0070001E00E0003C03C0003FFE000
03C0000003C0000003C0000003C000000780000007800000078000000780000007800000078000
000F0000000F800000FFF000001A1C7E9B1C>I<0FFFF80000F80E0000F0078000F003C000F001
C000F001E000F001E001E003C001E003C001E0038001E0070001E00E0001E03C0003FFE00003C0
780003C01C0003C01E0003C00E0003C00F0007801E0007801E0007801E0007801E0007801E0007
801E080F001E100F801E10FFF00E20000003C01D1D7E9B1F>82 D<003F0400C0CC018038030038
0600180E00180E00180E00181E00101E00001F00000F80000FF80007FF0003FF8001FFC0003FE0
0003E00001E00000E00000E04000E04000E04000E04000C06001C0E00180F00300CC0E0083F800
161E7E9C17>I<1FFFFFF03C07C0F03007803020078020600780204007802040078020400F0020
800F0020000F0000000F0000000F0000000F0000001E0000001E0000001E0000001E0000001E00
00001E0000003C0000003C0000003C0000003C0000003C0000003C000000780000007C00001FFF
E0001C1C7C9B1E>I<FFE1FFC0FF801F003E003E000F001E0018000F001E0018000F001E001000
0F001E0030000F001E0020000F003E0060000F802F00400007804F00C00007804F00800007808F
01800007808F01000007810F01000007C10782000003C20782000003C20784000003C607840000
03C40788000003CC0788000003C807D0000001F803D0000001F003E0000001F003E0000001E003
C0000001E003C0000001C00380000000C001800000008001000000291D7B9B2B>87
D<07FF03FE00FC01F0007800C0007C0080003C0100003E0200001E0400001F0C00000F0800000F
90000007A0000007C0000003C0000003E0000001E0000003F0000004F0000008F0000010F80000
30780000607C0000403C0000803E0001001E0002001F0006000F001F001F80FF807FF01F1C7F9B
1F>I<07F0001C18001E0C001C0E00180E00000E00000E0001FE000F0E001C1C00301C00701C00
E01C40E01C40E03C40E05C80709D803F0E0012127D9115>97 D<3F00000F00000E00000E00000E
00000E00000E00000E00001C00001C00001C00001C7C001D87001E01803C01803801C03800C038
00E03800E03800E07001C07001C07001C0700380700300700600F00C00CC380083E000131D7C9C
17>I<00FE000307000E07801C0700380600380000700000700000700000E00000E00000E00000
6000007002007004003008001C300007C00011127E9112>I<0001F80000780000700000700000
700000700000700000700000E00000E00000E000F8E00386E00601E00C01C01801C03801C07001
C07001C07001C0E00380E00380E00380600380700380300780300F001C378007C7E0151D7E9C17
>I<01F8070C0C0618073803300370037FFF7000E000E000E00060006002700430081C3007C010
127E9112>I<000F800039C00061C000E3C001C18001C00001C00001C000038000038000038000
3FF8000380000380000700000700000700000700000700000700000E00000E00000E00000E0000
0E00000E00001C00001E0000FFC000121D7F9C0D>I<000038007CCC01871C0303080703800E03
800E03800E03800E03800E0700060600070C0009F0000800001800001800001FFE000FFF800FFF
C03001C06000C06000E0C000C0C000C0600180200300180E0007F000161C809215>I<07E00001
E00001C00001C00001C00001C00001C00001C000038000038000038000038F8003B0C003C0E007
80E00780E00700E00700E00700E00700E00E01C00E01C00E01C00E01C00E01C00E01C01C03801E
03C0FF9FF0141D7F9C17>I<00C001C001C0018000000000000000000000000000001F80078003
800700070007000700070007000E000E000E000E000E000E001C001E00FF800A1D7F9C0C>I<00
030007000700060000000000000000000000000000007E001E000E001C001C001C001C001C001C
00380038003800380038003800700070007000700070007060E0F0E0F1C063803E001025849C0D
>I<07E00001E00001C00001C00001C00001C00001C00001C0000380000380000380000381FC03
80E00380C007010007020007080007100007300007F8000F38000E3C000E1C000E1E000E0E000E
0F001C07001C0F80FF9FE0161D7F9C16>I<07E001E001C001C001C001C001C001C00380038003
800380038003800700070007000700070007000E000E000E000E000E000E001C001E00FF800B1D
7F9C0C>I<1F8FC0FC00079061060003E076070007807807000780780700070070070007007007
00070070070007007007000E00E00E000E00E00E000E00E00E000E00E00E000E00E00E000E00E0
0E001C01C01C001E01E01E00FF8FF8FF8021127F9124>I<1F8F8007B0C003C0E00780E00780E0
0700E00700E00700E00700E00E01C00E01C00E01C00E01C00E01C00E01C01C03801E03C0FF9FF0
14127F9117>I<00FC000307000E01801C01C03800C03000C07000E07000E07000E0E001C0E001
C0E001C0600180600380700700380E001C180007E00013127E9115>I<0FC7C003D87001E03803
C01803801C03800C03800E03800E03800E07001C07001C07001C0700380700300700600F00C00E
C3800E3E000E00000E00000E00001C00001C00001C00001C0000FF8000171A809117>I<1F9C07
EE03CF078E078C07000700070007000E000E000E000E000E000E001C001E00FFC010127F9110>
114 D<03F20C0E18061004300438043E001FE00FF007F8003C401C400C400C6018E010D0608FC0
0F127F9110>I<020002000200060006000C001C003C00FFE01C001C0038003800380038003800
3800700070407040704070407080708031001E000B1A7C9910>I<FC1F803C07801C0380380700
380700380700380700380700380700700E00700E00700E00700E00701E00701E00703C00305E00
1F9F8011127C9117>I<FF07E03C03803C03001C02001C02001C04001C08000E08000E10000E10
000E20000F200007400007C00007800007000003000002000013127C9116>I<FF3FC7E03C0F03
80380E0100380E03003C1F02001C1706001C3704001C270C001C6308001C4318001EC390000E83
B0000F83A0000F03E0000F01C0000E01C0000E018000040180001B127C911E>I<1FE1FC0781E0
03808003C10001C20000E60000EC00007800007000003800007C00009C00011E00020E00040700
0C07003C0780FE1FF016127F9116>I<0FF07E03C03803C03001C02001C02001C04001C08000E0
8000E10000E10000E20000F200007400007C000078000070000030000020000020000040000040
00708000F10000F30000E60000780000171A809116>I E /Fn 81[28 51[22
25 25 36 25 28 17 19 22 1[28 25 28 41 14 28 1[14 28 25 17 22
28 22 28 25 7[36 36 1[36 36 33 28 36 1[30 39 36 47 33 2[19
39 39 30 33 36 36 33 36 6[17 25 25 25 25 25 25 25 25 25 25
14 12 17 12 44[{}61 50.000000 /Times-Bold rf /Fo 78[23 2[25
51[20 23 23 33 23 25 15 18 20 1[25 23 25 38 13 25 15 13 25
23 15 20 25 20 25 23 8[33 45 33 33 30 25 33 1[28 35 33 43 30
35 23 18 35 35 28 30 33 33 30 33 6[15 23 23 23 23 23 23 23
23 23 23 1[11 46[{}62 45.624989 /Times-Bold rf /Fp 134[19 1[27
1[19 10 15 12 1[19 19 19 29 10 19 1[10 19 2[17 19 17 19 17
12[23 21 25 1[21 1[27 33 3[12 27 27 21 1[27 25 25 27 7[19 19
19 19 19 19 19 19 19 19 1[9 12 9 44[{}46 37.500000 /Times-Roman
rf /Fq 1 4 df<0C000C00CCC0EDC07F800C007F80EDC0CCC00C000C000A0B7D8B10>3
D E /Fr 81[23 51[18 20 20 30 20 23 13 18 18 1[23 23 23 33 13
20 13 13 23 23 13 20 23 20 23 23 8[28 38 28 33 25 23 28 1[28
33 30 38 25 30 20 15 33 33 28 28 33 30 28 28 1[23 4[15 6[23
23 23 23 13 11 15 11 1[23 15 15 1[35 38[{}63 45.624989 /Times-Italic
rf /Fs 47[45 21[20 8[23 1[25 25 3[20 47[20 23 23 33 23 23 13
18 15 23 23 23 23 35 13 23 13 13 23 23 15 20 23 20 23 20 15
2[15 1[15 28 33 33 43 33 33 28 25 30 1[25 33 33 40 28 33 18
15 33 33 25 28 33 30 30 33 42 1[26 26 1[13 13 23 23 23 23 23
23 23 23 23 23 13 11 15 11 1[23 15 15 15 1[38 23 23 19 15 33[{}88
45.624989 /Times-Roman rf /Ft 81[33 52[30 1[43 30 33 20 23
27 1[33 30 33 50 17 1[20 17 33 30 20 27 33 27 33 30 8[43 2[43
40 33 43 1[37 47 1[56 40 47 1[23 3[40 1[43 40 43 7[30 30 30
30 30 30 30 30 30 30 48[{}48 59.999973 /Times-Bold rf /Fu 1
4 df<020002000200C218F2783AE00F800F803AE0F278C2180200020002000D0E7E8E12>3
D E /Fv 133[22 25 1[36 1[25 2[17 3[25 39 14 2[14 3[22 25 1[25
22 17[36 1[44 1[36 1[17 36 1[28 30 11[25 3[25 1[25 1[25 2[12
1[12 44[{}26 50.000000 /Times-Roman rf /Fw 138[36 1[28 24 2[36
36 56 20 2[20 1[36 1[32 3[32 10[52 5[40 2[64 1[52 23[36 36
3[18 24 3[24 24 24 39[{}22 72.000000 /Times-Roman rf /Fx 135[32
120[{}1 72.000000 /Times-Italic rf end
%%EndProlog
%%BeginSetup
%%Feature: *Resolution 300
TeXDict begin

%%EndSetup
%%Page: 1 1
0 bop 517 306 a Fx(x)p Fw(-Kernel)18 b(Programmer)s(')l(s)e(Manual)788
398 y(\(V)-8 b(ersion)17 b(3.2\))781 582 y Fv(Edwin)12 b(F)l(.)h(Menze)g(III)
794 640 y(Hilarie)f(K.)g(Orman)1156 622 y Fu(\003)804 741 y
Fv(February)f(5,)i(1993)864 965 y Ft(Abstract)114 1072 y Fs(This)18
b(report)h(describes)g(how)g(to)g(implement)g(protocols)f(in)h(the)g
Fr(x)p Fs(-kernel.)42 b(It)19 b(gives)g(the)g Fr(x)p Fs(-kernel')m(s)114
1128 y(programming)9 b(interface,)h(describes)f(how)g(to)g(con\256gure)g(an)g
Fr(x)p Fs(-kernel)h(that)f(contains)f(a)i(certain)f(collection)114
1184 y(of)16 b(protocols,)g(and)f(demonstrates)g(how)h(to)f(run)h(and)g
(debug)f(an)h Fr(x)p Fs(-kernel.)31 b(The)16 b Fr(x)p Fs(-kernel)g(can)h(be)f
(run)114 1241 y(in)d(one)h(of)g(two)g(environments:)20 b(as)14
b(a)h(user)f(program)g(on)g(a)g(Sun)g(SparcStation)g(running)e(SunOS4.1,)j
(or)114 1297 y(as)g(a)h(task)f(on)h(a)g(Mach3.0)g(system)f(\(some)h
(platforms\).)29 b(Protocols)14 b(can)i(be)g(moved)g(between)f(the)g(two)114
1354 y(environments)10 b(without)g(modi\256cation.)17 b(This)11
b(document)h(assumes)f(that)g(the)h(reader)g(is)g(already)f(familiar)114
1410 y(with)f(the)h Fr(x)p Fs(-kernel')m(s)h(object-oriented)d
(infrastructure)h(for)i(implementing)e(protocols.)p 0 2540
780 2 v 49 2567 a Fq(\003)67 2583 y Fp(This)j(work)f(supported)g(in)h(part)g
(by)f(National)h(Science)e(Foundation)g(Grants)h(CCR-8811423,)h(IRI-9015407,)
g(and)f(CCR-9102040,)g(Sun)0 2628 y(Microsystems)c(Inc.,)i(Hewlett-Packard)e
(Company)n(,)g(and)g(DARP)m(A)g(Contract)h(DABT63-91-C-0030)964
2753 y Fs(1)p eop
%%Page: 2 2
1 bop 0 124 a Ft(Contents)0 228 y Fo(1)45 b(Intr)o(oduction)1613
b(8)68 284 y Fs(1.1)48 b(Acknowledgements)21 b Fr(.)i(.)g(.)g(.)g(.)g(.)g(.)g
(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g
(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)64 b Fs(8)68
340 y(1.2)48 b(Our)11 b(Address)k Fr(.)24 b(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g
(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g
(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)64
b Fs(8)68 397 y(1.3)48 b(Copyright)9 b(Notice)33 b Fr(.)23
b(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h
(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g
(.)64 b Fs(9)0 499 y Fo(2)45 b(Uniform)11 b(Pr)o(otocol)g(Interface)1308
b(10)68 555 y Fs(2.1)48 b(T)m(ype)10 b(De\256nitions)h Fr(.)23
b(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g
(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g
(.)g(.)42 b Fs(10)173 612 y(2.1.1)54 b(XObj)35 b Fr(.)23 b(.)g(.)g(.)g(.)g(.)
g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g
(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42
b Fs(10)173 668 y(2.1.2)54 b(Enable)11 b(Objects)29 b Fr(.)23
b(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g
(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42
b Fs(11)173 725 y(2.1.3)54 b(Return)11 b(V)-5 b(alues)16 b
Fr(.)23 b(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h
(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g
(.)42 b Fs(11)173 781 y(2.1.4)54 b(Function)10 b(T)m(ypes)25
b Fr(.)e(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f
(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42
b Fs(11)68 838 y(2.2)48 b(Protocol-Protocol)9 b(Operations)19
b Fr(.)k(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g
(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42
b Fs(12)173 894 y(2.2.1)54 b(xOpen)15 b Fr(.)23 b(.)g(.)g(.)g(.)g(.)g(.)g(.)g
(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g
(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42
b Fs(12)173 950 y(2.2.2)54 b(xOpenEnable)24 b Fr(.)f(.)g(.)g(.)g(.)g(.)g(.)h
(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g
(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42 b Fs(12)173
1007 y(2.2.3)54 b(xOpenDisable)11 b Fr(.)23 b(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g
(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g
(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42 b Fs(12)173 1063
y(2.2.4)54 b(xOpenDisableAll)20 b Fr(.)j(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g
(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g
(.)g(.)g(.)g(.)g(.)g(.)g(.)42 b Fs(13)173 1120 y(2.2.5)54 b(xOpenDone)18
b Fr(.)23 b(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g
(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g
(.)g(.)g(.)42 b Fs(13)173 1176 y(2.2.6)54 b(xPush)25 b Fr(.)e(.)g(.)g(.)g(.)g
(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g
(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42
b Fs(13)173 1233 y(2.2.7)54 b(xCall)38 b Fr(.)23 b(.)g(.)g(.)g(.)g(.)g(.)g(.)
g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g
(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42
b Fs(13)173 1289 y(2.2.8)54 b(xPop)43 b Fr(.)23 b(.)g(.)g(.)g(.)g(.)g(.)g(.)g
(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g
(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42
b Fs(14)173 1346 y(2.2.9)54 b(xCallPop)35 b Fr(.)23 b(.)g(.)g(.)g(.)g(.)g(.)g
(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g
(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42 b
Fs(14)173 1402 y(2.2.10)31 b(xCloseDone)13 b Fr(.)23 b(.)g(.)g(.)g(.)g(.)g(.)
g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g
(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42 b Fs(14)173
1459 y(2.2.11)31 b(xClose)44 b Fr(.)23 b(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h
(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g
(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42 b Fs(14)173
1515 y(2.2.12)31 b(xControl)42 b Fr(.)23 b(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)
f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g
(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42 b Fs(15)173 1571
y(2.2.13)31 b(xDemux)14 b Fr(.)23 b(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f
(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g
(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42 b Fs(15)173 1628
y(2.2.14)31 b(xCallDemux)40 b Fr(.)23 b(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g
(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h
(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42 b Fs(15)173 1684 y(2.2.15)31
b(xDuplicate)38 b Fr(.)23 b(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g
(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g
(.)g(.)g(.)g(.)g(.)g(.)g(.)42 b Fs(15)173 1741 y(2.2.16)31
b(xShutDown)20 b Fr(.)j(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g
(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g
(.)g(.)g(.)g(.)g(.)g(.)42 b Fs(16)68 1797 y(2.3)48 b(Graph)11
b(Manipulation)e(Operations)40 b Fr(.)24 b(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)
g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g
(.)g(.)g(.)42 b Fs(16)173 1854 y(2.3.1)54 b(xCreateSessn)28
b Fr(.)23 b(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g
(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g
(.)g(.)42 b Fs(16)173 1910 y(2.3.2)54 b(xCreateProtl)43 b Fr(.)23
b(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g
(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42
b Fs(16)173 1967 y(2.3.3)54 b(xDestroy)37 b Fr(.)23 b(.)g(.)g(.)g(.)g(.)g(.)g
(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g
(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42 b
Fs(17)173 2023 y(2.3.4)54 b(xGetProtlByName)36 b Fr(.)23 b(.)g(.)g(.)h(.)f(.)
g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g
(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42 b Fs(17)173 2080
y(2.3.5)54 b(xSetDown)12 b Fr(.)23 b(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g
(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g
(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42 b Fs(17)173 2136
y(2.3.6)54 b(xGetDown)38 b Fr(.)23 b(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g
(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h
(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42 b Fs(17)173 2192 y(2.3.7)54
b(xSetUp)34 b Fr(.)23 b(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g
(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f
(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42 b Fs(17)173 2249 y(2.3.8)54
b(xGetUp)26 b Fr(.)d(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g
(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g
(.)g(.)g(.)g(.)g(.)g(.)g(.)42 b Fs(17)173 2305 y(2.3.9)54 b(xHlpT)m(ype)22
b Fr(.)h(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g
(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g
(.)g(.)g(.)42 b Fs(18)68 2362 y(2.4)59 b(Utility)9 b(Operations)42
b Fr(.)23 b(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g
(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g
(.)g(.)g(.)42 b Fs(18)173 2418 y(2.4.1)54 b(xIsProtocol)28
b Fr(.)23 b(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g
(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g
(.)g(.)g(.)42 b Fs(18)173 2475 y(2.4.2)54 b(xIsSession)43 b
Fr(.)23 b(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g
(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g
(.)g(.)42 b Fs(18)173 2531 y(2.4.3)54 b(xIsXObj)13 b Fr(.)23
b(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g
(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g
(.)g(.)42 b Fs(18)173 2588 y(2.4.4)54 b(xIsV)-5 b(alidXObj)18
b Fr(.)23 b(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g
(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g
(.)g(.)42 b Fs(18)964 2753 y(2)p eop
%%Page: 3 3
2 bop 173 124 a Fs(2.4.5)54 b(xPrintXObj)25 b Fr(.)e(.)g(.)g(.)g(.)g(.)g(.)g
(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g
(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42 b Fs(18)68
181 y(2.5)48 b(Usage)11 b(Rules)18 b Fr(.)24 b(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)
g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g
(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42
b Fs(18)173 237 y(2.5.1)54 b(Initializing)9 b(a)j(Protocol)f
Fr(.)23 b(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g
(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42
b Fs(19)173 294 y(2.5.2)54 b(hlpRcv)11 b(and)g(hlpT)m(ype)39
b Fr(.)23 b(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g
(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42
b Fs(19)173 350 y(2.5.3)54 b(Protocol)11 b(Realms)39 b Fr(.)23
b(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g
(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42
b Fs(19)318 407 y(Asynchronous)9 b(Protocols)30 b Fr(.)24 b(.)f(.)g(.)g(.)g
(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f
(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42 b Fs(20)318 463 y(Synchronous)10
b(Protocols)21 b Fr(.)i(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f
(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42
b Fs(20)318 519 y(Control)10 b(Protocols)18 b Fr(.)23 b(.)g(.)g(.)g(.)h(.)f
(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g
(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42 b Fs(20)173 576
y(2.5.4)54 b(Anchor)11 b(Protocols)20 b Fr(.)j(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)
g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f
(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42 b Fs(20)173 632 y(2.5.5)54
b(V)m(irtual)11 b(Protocols)30 b Fr(.)23 b(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)
g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g
(.)g(.)g(.)g(.)g(.)g(.)g(.)42 b Fs(20)68 689 y(2.6)48 b(Default)10
b(Operations)36 b Fr(.)23 b(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g
(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g
(.)g(.)g(.)g(.)g(.)g(.)g(.)42 b Fs(21)173 745 y(2.6.1)54 b(defaultOpenEnable)
22 b Fr(.)h(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g
(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42
b Fs(21)173 802 y(2.6.2)54 b(defaultOpenDisable)9 b Fr(.)23
b(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g
(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42
b Fs(21)173 858 y(2.6.3)54 b(defaultOpenDisableAll)18 b Fr(.)23
b(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g
(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42 b Fs(21)173
915 y(2.6.4)54 b(defaultV)m(irtualOpenEnable)32 b Fr(.)23 b(.)g(.)g(.)g(.)g
(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g
(.)g(.)g(.)g(.)g(.)g(.)g(.)42 b Fs(21)173 971 y(2.6.5)54 b(defaultV)m
(irtualOpenDisable)19 b Fr(.)k(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)
g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42
b Fs(21)173 1028 y(2.6.6)54 b(Usage)23 b Fr(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g
(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g
(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42
b Fs(22)0 1129 y Fo(3)j(Participant)11 b(Library)1452 b(23)68
1186 y Fs(3.1)48 b(T)m(ype)10 b(De\256nitions)h Fr(.)23 b(.)g(.)g(.)g(.)g(.)g
(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g
(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42
b Fs(23)68 1242 y(3.2)48 b(Participant)10 b(List)g(Operations)29
b Fr(.)23 b(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g
(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42
b Fs(23)173 1299 y(3.2.1)54 b(partInit)36 b Fr(.)23 b(.)g(.)g(.)g(.)g(.)g(.)g
(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g
(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42
b Fs(23)173 1355 y(3.2.2)54 b(partPush)45 b Fr(.)23 b(.)g(.)g(.)g(.)g(.)g(.)g
(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g
(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42 b
Fs(24)173 1412 y(3.2.3)54 b(partPop)29 b Fr(.)23 b(.)g(.)g(.)g(.)g(.)g(.)g(.)
g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g
(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42 b
Fs(24)173 1468 y(3.2.4)54 b(partLen)29 b Fr(.)23 b(.)g(.)g(.)g(.)g(.)g(.)g(.)
g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g
(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42 b
Fs(24)173 1525 y(3.2.5)54 b(partExternalize)28 b Fr(.)23 b(.)g(.)g(.)g(.)g(.)
h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g
(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42 b Fs(24)173
1581 y(3.2.6)54 b(partInternalize)41 b Fr(.)23 b(.)g(.)g(.)g(.)g(.)h(.)f(.)g
(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g
(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42 b Fs(24)173 1638
y(3.2.7)54 b(partExtLen)33 b Fr(.)23 b(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)
g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h
(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42 b Fs(24)68 1694 y(3.3)48
b(Relative)11 b(Protocol)f(Numbers)25 b Fr(.)e(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)
g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g
(.)g(.)g(.)g(.)g(.)g(.)g(.)42 b Fs(25)68 1750 y(3.4)48 b(Usage)11
b(Rules)18 b Fr(.)24 b(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)
g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h
(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42 b Fs(25)0 1852 y Fo(4)j(Message)11
b(Library)1507 b(27)68 1909 y Fs(4.1)48 b(T)m(ype)10 b(De\256nitions)h
Fr(.)23 b(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g
(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g
(.)g(.)g(.)g(.)42 b Fs(27)68 1965 y(4.2)48 b(Constructor/Destructor)8
b(Operations)26 b Fr(.)d(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g
(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42
b Fs(27)173 2022 y(4.2.1)54 b(msgConstructEmpty)33 b Fr(.)23
b(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g
(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42 b
Fs(27)173 2078 y(4.2.2)54 b(msgConstructBuf)o(fer)38 b Fr(.)23
b(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g
(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42 b
Fs(28)173 2135 y(4.2.3)54 b(msgConstructAllocate)34 b Fr(.)23
b(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g
(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42 b Fs(28)173
2191 y(4.2.4)54 b(msgConstructCopy)22 b Fr(.)h(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)
g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g
(.)g(.)g(.)g(.)g(.)g(.)g(.)42 b Fs(28)173 2248 y(4.2.5)54 b(msgAssign)35
b Fr(.)23 b(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g
(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g
(.)g(.)g(.)42 b Fs(28)173 2304 y(4.2.6)54 b(msgConstructInplace)21
b Fr(.)i(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g
(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42
b Fs(28)173 2360 y(4.2.7)54 b(msgConstructAppend)10 b Fr(.)23
b(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g
(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42 b
Fs(28)173 2417 y(4.2.8)54 b(msgDestroy)18 b Fr(.)23 b(.)g(.)g(.)g(.)g(.)g(.)g
(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g
(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42 b Fs(29)68
2473 y(4.3)48 b(Manipulation)9 b(Operations)29 b Fr(.)23 b(.)g(.)g(.)g(.)h(.)
f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g
(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42 b Fs(29)173 2530
y(4.3.1)54 b(msgLen)24 b Fr(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g
(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g
(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42 b Fs(29)173 2586
y(4.3.2)54 b(msgT)n(runcate)37 b Fr(.)23 b(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)
g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h
(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42 b Fs(29)964 2753 y(3)p
eop
%%Page: 4 4
3 bop 173 124 a Fs(4.3.3)54 b(msgChopOf)o(f)36 b Fr(.)23 b(.)g(.)g(.)g(.)g(.)
g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g
(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42 b Fs(29)173
181 y(4.3.4)54 b(msgJoin)18 b Fr(.)23 b(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h
(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g
(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42 b Fs(29)173
237 y(4.3.5)54 b(msgPush)40 b Fr(.)23 b(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f
(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g
(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42 b Fs(30)173 294
y(4.3.6)54 b(msgPop)24 b Fr(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g
(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g
(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42 b Fs(30)173 350 y(4.3.7)54
b(msgPopDiscard)18 b Fr(.)23 b(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)
g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g
(.)g(.)g(.)g(.)g(.)42 b Fs(30)173 407 y(4.3.8)54 b(msgAppend)18
b Fr(.)23 b(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g
(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g
(.)g(.)g(.)42 b Fs(30)173 463 y(4.3.9)54 b(msgSetAttr)31 b
Fr(.)23 b(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g
(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g
(.)g(.)42 b Fs(31)173 519 y(4.3.10)31 b(msgGetAttr)23 b Fr(.)g(.)g(.)g(.)g(.)
g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g
(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42
b Fs(31)173 576 y(4.3.11)31 b(msgForEach)43 b Fr(.)23 b(.)g(.)g(.)g(.)g(.)g
(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g
(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42 b Fs(31)68
632 y(4.4)48 b(Usage)11 b(Rules)18 b Fr(.)24 b(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)
g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g
(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42
b Fs(31)0 734 y Fo(5)j(Event)12 b(Library)1558 b(32)68 791
y Fs(5.1)48 b(T)m(ype)10 b(De\256nitions)h Fr(.)23 b(.)g(.)g(.)g(.)g(.)g(.)g
(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g
(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42
b Fs(32)68 847 y(5.2)48 b(Operations)12 b Fr(.)23 b(.)h(.)f(.)g(.)g(.)g(.)g
(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g
(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42
b Fs(32)173 904 y(5.2.1)54 b(evSchedule)29 b Fr(.)23 b(.)g(.)g(.)g(.)g(.)g(.)
g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g
(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42 b Fs(32)173
960 y(5.2.2)54 b(evDetach)33 b Fr(.)23 b(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f
(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g
(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42 b Fs(32)173 1017
y(5.2.3)54 b(evCancel)36 b Fr(.)23 b(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g
(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g
(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42 b Fs(32)173 1073
y(5.2.4)54 b(evIsCancelled)15 b Fr(.)23 b(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g
(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h
(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42 b Fs(33)173 1129 y(5.2.5)54
b(evDump)14 b Fr(.)23 b(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g
(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f
(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42 b Fs(33)68 1186 y(5.3)48
b(Usage)11 b(Rules)18 b Fr(.)24 b(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h
(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g
(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42 b Fs(33)173
1242 y(5.3.1)54 b(Repeating)11 b(Events)20 b Fr(.)j(.)g(.)g(.)g(.)h(.)f(.)g
(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g
(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42 b Fs(33)173 1299
y(5.3.2)54 b(Cancellable)11 b(Events)24 b Fr(.)f(.)g(.)g(.)h(.)f(.)g(.)g(.)g
(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f
(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42 b Fs(33)173 1355 y(5.3.3)54
b(Event)11 b(Granularity)h Fr(.)23 b(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g
(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g
(.)g(.)g(.)g(.)g(.)g(.)42 b Fs(34)0 1457 y Fo(6)j(Map)11 b(Library)1581
b(35)68 1514 y Fs(6.1)48 b(T)m(ype)10 b(De\256nitions)h Fr(.)23
b(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g
(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g
(.)g(.)42 b Fs(35)68 1570 y(6.2)48 b(Operations)12 b Fr(.)23
b(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g
(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g
(.)g(.)g(.)g(.)g(.)42 b Fs(35)173 1627 y(6.2.1)54 b(mapCreate)43
b Fr(.)23 b(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g
(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g
(.)g(.)g(.)42 b Fs(35)173 1683 y(6.2.2)54 b(mapResolve)14 b
Fr(.)23 b(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g
(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g
(.)g(.)42 b Fs(35)173 1739 y(6.2.3)54 b(mapBind)38 b Fr(.)23
b(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h
(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g
(.)42 b Fs(36)173 1796 y(6.2.4)54 b(mapRemoveBinding)32 b Fr(.)23
b(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g
(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42 b
Fs(36)173 1852 y(6.2.5)54 b(mapUnbind)23 b Fr(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h
(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g
(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42 b Fs(36)173
1909 y(6.2.6)54 b(mapClose)23 b Fr(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)
g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g
(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42 b Fs(36)173 1965
y(6.2.7)54 b(mapForEach)41 b Fr(.)23 b(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)
g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f
(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42 b Fs(36)68 2022 y(6.3)48
b(Usage)11 b(Rules)18 b Fr(.)24 b(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h
(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g
(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42 b Fs(37)173
2078 y(6.3.1)54 b(External)11 b(Keys)i Fr(.)23 b(.)g(.)g(.)g(.)g(.)g(.)h(.)f
(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g
(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42 b Fs(37)173 2135
y(6.3.2)54 b(Active)11 b(and)g(Passive)f(Maps)19 b Fr(.)24
b(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g
(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42 b Fs(37)0
2237 y Fo(7)j(Thr)o(ead)13 b(Library)1528 b(39)68 2293 y Fs(7.1)48
b(T)m(ype)10 b(De\256nitions)h Fr(.)23 b(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h
(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g
(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42 b Fs(39)68
2349 y(7.2)48 b(Synchronization)9 b(Operations)h Fr(.)23 b(.)g(.)g(.)h(.)f(.)
g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g
(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42 b Fs(39)173 2406
y(7.2.1)54 b(semInit)34 b Fr(.)23 b(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f
(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g
(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42 b Fs(39)173 2462
y(7.2.2)54 b(semW)l(ait)13 b Fr(.)23 b(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)
f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g
(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42 b Fs(39)173 2519
y(7.2.3)54 b(semSignal)15 b Fr(.)23 b(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g
(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g
(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42 b Fs(39)68 2575 y(7.3)48
b(Delay)36 b Fr(.)23 b(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)
h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g
(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42 b Fs(39)964
2753 y(4)p eop
%%Page: 5 5
4 bop 68 124 a Fs(7.4)48 b(Locking)10 b(Operations)20 b Fr(.)j(.)g(.)g(.)g(.)
g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g
(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42
b Fs(40)173 181 y(7.4.1)54 b(rwLockInit)33 b Fr(.)23 b(.)g(.)g(.)g(.)g(.)g(.)
g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g
(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42 b Fs(40)173
237 y(7.4.2)54 b(rwLockDestroy)20 b Fr(.)j(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)
g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f
(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42 b Fs(40)173 294 y(7.4.3)54
b(readerLock)32 b Fr(.)23 b(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g
(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g
(.)g(.)g(.)g(.)g(.)g(.)g(.)42 b Fs(40)173 350 y(7.4.4)54 b(readerUnlock)25
b Fr(.)e(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h
(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g
(.)42 b Fs(40)173 407 y(7.4.5)54 b(writerLock)36 b Fr(.)23
b(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f
(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42
b Fs(40)173 463 y(7.4.6)54 b(writerUnlock)29 b Fr(.)23 b(.)g(.)g(.)g(.)g(.)g
(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g
(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42 b Fs(41)68
519 y(7.5)48 b(Usage)11 b(Rules)18 b Fr(.)24 b(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)
g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g
(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42
b Fs(41)173 576 y(7.5.1)54 b(Scheduling)10 b(and)h(Preemption)43
b Fr(.)23 b(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g
(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42 b Fs(41)173
632 y(7.5.2)54 b(Blocking)37 b Fr(.)23 b(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f
(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g
(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42 b Fs(41)173 689
y(7.5.3)54 b(External)11 b(Threads)28 b Fr(.)23 b(.)g(.)g(.)g(.)h(.)f(.)g(.)g
(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h
(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42 b Fs(41)173 745 y(7.5.4)54
b(Thread)11 b(T)n(urnaround)21 b Fr(.)i(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g
(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g
(.)g(.)g(.)g(.)g(.)g(.)42 b Fs(42)173 802 y(7.5.5)54 b(Multiprocessor)10
b(Support)h Fr(.)23 b(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g
(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42
b Fs(42)0 904 y Fo(8)j(T)m(race)12 b(Library)1561 b(43)68 960
y Fs(8.1)48 b(T)m(ype)10 b(De\256nitions)h Fr(.)23 b(.)g(.)g(.)g(.)g(.)g(.)g
(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g
(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42
b Fs(43)68 1017 y(8.2)48 b(Operations)12 b Fr(.)23 b(.)h(.)f(.)g(.)g(.)g(.)g
(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g
(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42
b Fs(43)173 1073 y(8.2.1)54 b(xT)n(race)13 b Fr(.)23 b(.)g(.)g(.)g(.)g(.)g(.)
g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g
(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42
b Fs(43)173 1129 y(8.2.2)54 b(xIfT)n(race)17 b Fr(.)23 b(.)g(.)g(.)g(.)g(.)g
(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g
(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42
b Fs(44)173 1186 y(8.2.3)54 b(xAssert)31 b Fr(.)23 b(.)g(.)g(.)g(.)g(.)g(.)g
(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g
(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42
b Fs(44)173 1242 y(8.2.4)54 b(xError)18 b Fr(.)23 b(.)g(.)g(.)g(.)g(.)g(.)g
(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g
(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42
b Fs(44)68 1299 y(8.3)48 b(Usage)11 b(Rules)18 b Fr(.)24 b(.)f(.)g(.)g(.)g(.)
g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g
(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42
b Fs(44)0 1401 y Fo(9)j(Utility)10 b(Routines)1530 b(45)68
1457 y Fs(9.1)48 b(Storage:)16 b(xMalloc)10 b(and)h(xFree)44
b Fr(.)23 b(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g
(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42
b Fs(45)68 1514 y(9.2)48 b(T)n(ime)17 b Fr(.)23 b(.)g(.)g(.)g(.)h(.)f(.)g(.)g
(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h
(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g
(.)42 b Fs(45)173 1570 y(9.2.1)54 b(xGetT)n(ime)22 b Fr(.)h(.)g(.)g(.)g(.)g
(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g
(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42
b Fs(45)173 1627 y(9.2.2)54 b(xAddT)n(ime)43 b Fr(.)23 b(.)g(.)g(.)g(.)g(.)g
(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g
(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42 b
Fs(45)173 1683 y(9.2.3)54 b(xSubT)n(ime)17 b Fr(.)23 b(.)g(.)g(.)g(.)g(.)g(.)
g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g
(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42 b
Fs(45)68 1739 y(9.3)48 b(Byte)11 b(Order:)16 b(ntohs,)10 b(ntohl,)g(ntons,)h
(and)g(htonl)30 b Fr(.)23 b(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g
(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42 b
Fs(45)68 1796 y(9.4)48 b(Checksum)21 b Fr(.)i(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g
(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g
(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42
b Fs(46)173 1852 y(9.4.1)54 b(inCkSum)33 b Fr(.)23 b(.)g(.)g(.)g(.)g(.)g(.)g
(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g
(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42 b
Fs(46)173 1909 y(9.4.2)54 b(ocsum)18 b Fr(.)23 b(.)g(.)g(.)g(.)g(.)g(.)g(.)g
(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g
(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42
b Fs(46)68 1965 y(9.5)48 b(Strings)10 b(to)h(Hosts)24 b Fr(.)f(.)g(.)g(.)g(.)
g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g
(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42
b Fs(46)173 2022 y(9.5.1)54 b(ipHostStr)29 b Fr(.)23 b(.)g(.)g(.)g(.)g(.)g(.)
g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g
(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42 b
Fs(46)173 2078 y(9.5.2)54 b(str2ipHost)13 b Fr(.)23 b(.)g(.)g(.)g(.)g(.)g(.)g
(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g
(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42 b
Fs(46)173 2135 y(9.5.3)54 b(ethHostStr)43 b Fr(.)23 b(.)g(.)g(.)g(.)g(.)g(.)g
(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g
(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42 b Fs(46)173
2191 y(9.5.4)54 b(str2ethHost)27 b Fr(.)c(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g
(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g
(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42 b Fs(46)0 2293 y
Fo(10)34 b(Contr)o(ol)11 b(Operations)1446 b(47)68 2349 y Fs(10.1)36
b(Standard)11 b(Control)f(Operations)53 b Fr(.)23 b(.)h(.)f(.)g(.)g(.)g(.)g
(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g
(.)g(.)g(.)g(.)g(.)g(.)g(.)42 b Fs(47)173 2406 y(10.1.1)h(Protocol)10
b(and)h(Session)f(Operations)43 b Fr(.)23 b(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g
(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42
b Fs(47)173 2462 y(10.1.2)h(Session)10 b(Operations)46 b Fr(.)23
b(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g
(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42 b
Fs(47)68 2519 y(10.2)36 b(Protocol-Speci\256c)11 b(Control)f(Operations)36
b Fr(.)23 b(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g
(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42 b Fs(48)68
2575 y(10.3)36 b(Forwarding)11 b(Control)f(Operations)36 b
Fr(.)24 b(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g
(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42 b
Fs(49)964 2753 y(5)p eop
%%Page: 6 6
5 bop 0 124 a Fo(11)22 b(Refer)o(ence)13 b(Counting)e(XObjs)1313
b(50)68 181 y Fs(11.1)25 b(References)12 b Fr(.)23 b(.)h(.)f(.)g(.)g(.)g(.)g
(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g
(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42
b Fs(50)68 237 y(11.2)25 b(Reference)12 b(counts)35 b Fr(.)23
b(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h
(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g
(.)42 b Fs(50)173 294 y(11.2.1)h(Counting)9 b(External)h(References)56
b Fr(.)23 b(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g
(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42 b Fs(51)173 350
y(11.2.2)h(Counting)9 b(xPops)37 b Fr(.)23 b(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g
(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f
(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42 b Fs(51)68 407 y(11.3)25
b(Internal)10 b(vs.)17 b(External)10 b(Reference)j(Counts)g
Fr(.)23 b(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g
(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42 b Fs(52)68 463
y(11.4)25 b(Session)10 b(Caching)h(Strategies)27 b Fr(.)c(.)g(.)g(.)h(.)f(.)g
(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g
(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42 b Fs(52)68 519 y(11.5)25
b(Modifying)10 b(v3.1)g(protocols)19 b Fr(.)k(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g
(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f
(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42 b Fs(54)0 621 y Fo(12)22
b(Pr)o(otocol)11 b(T)l(ables)1537 b(56)0 723 y(13)22 b(Con\256guring)11
b(a)h(Kernel)1423 b(58)68 780 y Fs(13.1)25 b(Specifying)10
b(a)i(Protocol)e(Graph)35 b Fr(.)23 b(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g
(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g
(.)g(.)g(.)g(.)42 b Fs(58)68 836 y(13.2)25 b(Build)10 b(Procedure)20
b Fr(.)j(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g
(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g
(.)g(.)g(.)g(.)42 b Fs(59)68 893 y(13.3)25 b(Debug)10 b(versus)h(Optimized)f
(Mode)19 b Fr(.)k(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g
(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42
b Fs(60)0 995 y Fo(14)22 b(Running)12 b(a)f(Kernel)1489 b(61)68
1051 y Fs(14.1)25 b(SunOS4)i Fr(.)c(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g
(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g
(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42
b Fs(61)68 1107 y(14.2)25 b(Mach)12 b(3)41 b Fr(.)23 b(.)g(.)h(.)f(.)g(.)g(.)
g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f
(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42
b Fs(62)68 1164 y(14.3)25 b(Mach)12 b(3)f Fr(x)p Fs(-kernel)g(in)g(the)g
(Mach)h(kernel)39 b Fr(.)23 b(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g
(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42
b Fs(63)68 1220 y(14.4)25 b(Running)10 b(T)m(est)g(Suites)18
b Fr(.)23 b(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g
(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g
(.)g(.)g(.)42 b Fs(63)68 1277 y(14.5)25 b(T)n(roubleshooting)14
b Fr(.)23 b(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g
(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g
(.)g(.)g(.)g(.)g(.)42 b Fs(63)0 1379 y Fo(15)22 b(Releasing)10
b(a)h(Pr)o(otocol)1441 b(65)0 1481 y(16)22 b(System)11 b(Installation)1463
b(66)68 1537 y Fs(16.1)25 b(Unpacking)10 b(the)g Fr(tar)h Fs(\256le)18
b Fr(.)23 b(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g
(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g
(.)g(.)42 b Fs(66)68 1594 y(16.2)25 b(Directory)10 b(Structure)32
b Fr(.)23 b(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g
(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g
(.)g(.)g(.)42 b Fs(66)68 1650 y(16.3)25 b(About)10 b(Compilers)35
b Fr(.)23 b(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g
(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g
(.)g(.)g(.)g(.)42 b Fs(67)68 1706 y(16.4)36 b(Con\256guration)51
b Fr(.)23 b(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g
(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g
(.)g(.)g(.)g(.)g(.)42 b Fs(67)68 1763 y(16.5)25 b(Building)9
b(and)i(T)m(esting)f(the)h(System)29 b Fr(.)24 b(.)f(.)g(.)g(.)g(.)g(.)g(.)g
(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g
(.)g(.)g(.)g(.)g(.)42 b Fs(67)0 1865 y Fo(17)22 b(Installing)10
b(within)h(a)g(Mach3)g(Kernel)1194 b(68)0 1967 y(A)35 b(Pr)o(otocol)11
b(Speci\256cations)1397 b(71)68 2023 y Fs(ARP)26 b Fr(.)d(.)g(.)g(.)g(.)g(.)g
(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g
(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g
(.)g(.)g(.)g(.)g(.)g(.)42 b Fs(73)68 2080 y(BID)36 b Fr(.)23
b(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f
(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g
(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42 b Fs(74)68 2136
y(BIDCTL)18 b Fr(.)23 b(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g
(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g
(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42
b Fs(75)68 2193 y(BLAST)c Fr(.)23 b(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g
(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g
(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42
b Fs(77)68 2249 y(CHAN)19 b Fr(.)k(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)
g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g
(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42
b Fs(79)68 2305 y(ETH)25 b Fr(.)e(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g
(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f
(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42
b Fs(81)68 2362 y(ETHDR)l(V)35 b Fr(.)23 b(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)
g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g
(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42
b Fs(83)68 2418 y(ICMP)c Fr(.)23 b(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)
g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g
(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42
b Fs(84)68 2475 y(IP)e Fr(.)23 b(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g
(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h
(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g
(.)42 b Fs(85)68 2531 y(MachNetIPC)j Fr(.)23 b(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)
g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g
(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42
b Fs(87)68 2588 y(RRX)21 b Fr(.)i(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g
(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f
(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42
b Fs(89)964 2753 y(6)p eop
%%Page: 7 7
6 bop 68 124 a Fs(SELECT)15 b Fr(.)23 b(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g
(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f
(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42
b Fs(90)68 181 y(SIMETH)13 b Fr(.)23 b(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)
g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g
(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42
b Fs(91)68 237 y(SSR)34 b Fr(.)23 b(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g
(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h
(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g
(.)42 b Fs(93)68 294 y(SRX)26 b Fr(.)d(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)
g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h
(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g
(.)42 b Fs(94)68 350 y(SUNRPC)e Fr(.)23 b(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g
(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g
(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42
b Fs(95)68 407 y(SUN)11 b(Portmapper)38 b Fr(.)24 b(.)f(.)g(.)g(.)g(.)g(.)g
(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g
(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)42
b Fs(98)68 463 y(TCP)31 b Fr(.)23 b(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g
(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h
(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g
(.)42 b Fs(99)68 519 y(UDP)23 b Fr(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)
g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h
(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g
(.)c Fs(102)68 576 y(VCACHE)29 b Fr(.)23 b(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)
g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g
(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)c
Fs(104)68 632 y(VCHAN)h Fr(.)j(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)
g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g
(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)c
Fs(105)68 689 y(VMUX)43 b Fr(.)23 b(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g
(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g
(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)c
Fs(107)68 745 y(VNET)26 b Fr(.)d(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g
(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g
(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)c
Fs(108)68 802 y(VSIZE)g Fr(.)k(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)
g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g
(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)c
Fs(110)68 858 y(XKLANCE)32 b Fr(.)23 b(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)
g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g
(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)c
Fs(111)68 915 y(XSI)41 b Fr(.)23 b(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)
g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f
(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)c
Fs(112)0 1017 y Fo(B)38 b(Application)11 b(Pr)o(ogrammer)g(Interfaces)1118
b(113)68 1073 y Fs(B.1)52 b(Mach)12 b(3)30 b Fr(.)23 b(.)g(.)h(.)f(.)g(.)g(.)
g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f
(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)c
Fs(113)173 1129 y(B.1.1)47 b(Sockets)29 b Fr(.)23 b(.)g(.)g(.)g(.)g(.)g(.)g
(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g
(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)c
Fs(113)173 1186 y(B.1.2)47 b(Mach)12 b(NetIPC)22 b Fr(.)h(.)g(.)g(.)g(.)g(.)g
(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g
(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)c Fs(113)173
1242 y(B.1.3)47 b(Building)d Fr(.)23 b(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)
g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)g
(.)h(.)f(.)g(.)g(.)g(.)g(.)g(.)g(.)g(.)c Fs(113)964 2753 y(7)p
eop
%%Page: 8 8
7 bop 0 124 a Ft(1)60 b(Intr)o(oduction)0 228 y Fs(The)13 b
Fr(x)p Fs(-kernel)h(is)e(an)i(object-oriented)d(multi-threaded)h
(architecture)h(for)g(protocol)f(implementation.)21 b(Each)14
b(protocol)0 284 y(is)e(represented)g(as)h(an)g(object)e(instance;)i
(sessions)d(are)k(specialized)d(instances)h(of)g(protocol)g(objects;)f(each)i
(thread)g(is)f(a)0 340 y(calling)h(sequence)i(of)f(object)g(invocations.)24
b(Generally)14 b(speaking,)h(each)g(message)f(in)g(an)h Fr(x)p
Fs(-kernel)g(is)f(processed)g(by)0 397 y(a)g(thread)g(of)g(protocol/session)c
(layers.)25 b(The)14 b Fr(x)p Fs(-kernel)g(provides)e(the)i(interface)g
(functions)e(that)i(allow)f(one)g(object)h(to)0 453 y(invoke)f(another)h(and)
g(subsystems)e(for)i(manipulating)f(messages,)i(associative)e(memory)h
(tables,)h(events,)f(addresses,)0 510 y(and)d(debugging.)71
566 y(V)-5 b(ersion)13 b(3.2)i(of)f(the)h Fr(x)p Fs(-kernel)g(has)f(changed)g
(signi\256cantly)f(from)i(version)f(3.1.)27 b(Unlike)13 b(3.1,)j(which)e(was)
g(a)h(true)0 623 y Fr(kernel)h Fs(in)f(the)h(sense)f(that)g(it)h(ran)g
(stand-alone)e(on)i(Sun3)f(workstations,)g(3.2)h(is)f(really)h(a)g
Fr(pr)n(otocol)e(implementation)0 679 y(envir)n(onment)f Fs(that)g(can)i(be)f
(embedded)g(in)g(any)g(platform,)h(including)d(both)h(hardware)h(and)g
(software)g(platforms.)25 b(By)0 736 y(de\256ning)12 b(all)h(the)f
(interfaces)h(between)g(the)f(protocol)g(and)h(the)f(host)g(environment,)h
(the)f Fr(x)p Fs(-kernel)i(completely)e(isolates)0 792 y(the)i(protocol)e
(from)j(the)e(underlying)f(operating)h(system.)24 b(As)13 b(a)i(result,)f
(protocol)e(source)i(code)g(can)g(be)g(moved)g(from)0 849 y(one)d(platform)g
(to)g(another)f(without)g(modi\256cation.)71 905 y(This)e(manual)h(covers)g
(the)g Fr(x)p Fs(-kernel)h(functionality)m(,)e(the)h(protocol)f(library)m(,)h
(and)g(the)g(tools)f(for)h(building)e(and)j(running)0 961 y
Fr(x)p Fs(-kernels)h(on)h(various)e(platforms.)17 b(Sections)11
b(2\2619)f(de\256ne)i(the)f(uniform)g(protocol)g(interface)g(and)g(the)h
(various)e(libraries)0 1018 y(that)f(make)i(up)f(the)g Fr(x)p
Fs(-kernel.)16 b(Sections)10 b(10)g(and)f(11)h(give)g(additional)e
(guidelines)g(about)h(using)g(these)h(routines.)15 b(Finally)m(,)0
1074 y(Sections)10 b(12\26117)g(describe)h(procedures)g(for)g(maintaining,)f
(con\256guring,)h(running,)f(and)h(installing)d(the)j Fr(x)p
Fs(-kernel.)0 1196 y Fn(1.1)50 b(Acknowledgements)0 1283 y
Fs(The)14 b Fr(x)p Fs(-kernel)g(is)f(the)h(concept)f(of)h(Norman)g(C.)h
(Hutchinson)c(at)j(the)f(University)f(of)i(British)f(Columbia)g(and)h(Larry)g
(L.)0 1339 y(Peterson)h(of)h(the)f(University)e(of)j(Arizona.)28
b(Sean)16 b(W)l(.)g(O'Malley)f(of)h(the)f(University)e(of)j(Arizona)f(has)g
(made)h(major)0 1396 y(contributions.)24 b(The)15 b(message)g(library)f(has)g
(received)h(attention)e(from)j(Peter)f(Druschel.)26 b(Michael)15
b(Pagels,)h(Charles)0 1452 y(T)n(urner)n(,)f(Mats)e(Bjorkman,)h(and)g
(Richard)f(Schroeppel)g(have)h(contributed)d(to)i(thread)g(control)g(and)g
(device)g(interfaces.)0 1509 y(David)8 b(Mosber)o(ger)i(wrote)e(the)h(socket)
f(interface)i(for)f(Mach.)16 b(Hilarie)9 b(Orman)g(has)g(been)g(responsible)e
(for)i(several)g(issues)0 1565 y(related)k(to)h(Mach)g(interfaces,)g(and)g
(Ed)f(Menze)h(has)g(remolded)f(and)g(improved)g(almost)g(every)h(aspect)f(of)
h(the)f(system.)0 1622 y(Many)e(people)g(have)g(contributed)f(protocols)f(to)
i(the)g Fr(x)p Fs(-kernel)g(as)g(noted)g(in)g(appendix)f(A.)0
1743 y Fn(1.2)50 b(Our)12 b(Addr)o(ess)0 1830 y Fs(Please)g(let)f(us)f(know)h
(of)g(any)g(problems)g(you)g(encounter)f(so)h(that)g(we)g(can)h(continue)e
(to)h(improve)g(the)g(distribution)o(.)j(Our)0 1887 y(mail)d(address)g(is:)
114 1973 y(The)g Fr(x)p Fs(-Kernel)g(Project)114 2030 y(Department)g(of)g
(Computer)g(Science)114 2086 y(University)e(of)i(Arizona)114
2143 y(T)n(ucson,)g(AZ)g(85721)0 2229 y(W)l(e)h(can)f(be)h(reached)f(by)g
(electronic)g(mail)g(at:)114 2316 y(xkernel-bugs@cs.arizona.edu)114
2373 y(uunet!arizona!xkernel-bugs)0 2459 y(Because)h(of)f(limited)f
(resources)h(we)h(can')o(t)f(promise)g(to)g(\256x)g(every)g(problem,)g(but)g
(we)g(appreciate)g(all)g(comments.)71 2516 y(Also,)k(we)f(typically)f(post)h
(messages)h(about)e(the)i Fr(x)p Fs(-kernel)g(\(including)e(notices)g(of)i
(future)f(releases\))h(to)g(xkernel-)0 2572 y(interest@cs.arizona.edu.)f
(Send)9 b(mail)f(to)g(xkernel-interest-request@cs.arizona.edu)e(to)i(be)g
(added)g(to)g(to)g(this)f(mailing)0 2629 y(list.)964 2753 y(8)p
eop
%%Page: 9 9
8 bop 0 124 a Fn(1.3)50 b(Copyright)11 b(Notice)0 211 y Fr(x)p
Fs(-kernel)0 280 y(Copyright)f(\(c\))i(1993,1991,1990)c(Arizona)j(Board)h(of)
f(Regents)0 349 y(Permission)g(to)h(use,)h(copy)m(,)f(modify)m(,)g
(distribute,)f(and)h(sell)f(this)g(software)h(and)g(its)g(documentation)e
(for)i(any)g(purpose)g(is)0 406 y(hereby)c(granted)g(without)e(fee,)k
(provided)c(that)i(the)g(above)g(copyright)e(appear)j(in)e(all)h(copies,)g
(and)g(that)g(both)f(the)h(copyright)0 462 y(and)17 b(this)f(permission)g
(notice)h(appear)h(in)f(supporting)e(documentation,)i(and)g(that)g(the)g
(name)h(of)g(the)f(University)e(of)0 518 y(Arizona)10 b(or)g(the)h(Arizona)f
(Board)g(of)h(Regents)f(not)f(be)i(used)f(in)g(advertising)e(or)j(publicity)d
(pertaining)h(to)h(distribution)d(of)0 575 y(the)j(software)f(without)f
(speci\256c,)j(written)e(prior)g(permission.)15 b(The)10 b(University)e(of)i
(Arizona)f(makes)h(no)g(representations)0 631 y(about)16 b(the)g(suitability)
e(of)i(this)g(software)g(for)h(any)f(purpose.)32 b(It)17 b(is)f(provided)f
("as)h(is")g(without)e(express)i(or)h(implied)0 688 y(warranty)m(.)0
757 y(The)9 b(University)f(of)h(Arizona)h(requests)e(users)h(of)h(this)e
(software)h(to)g(return)h(any)f(improvements)g(or)g(extensions)f(that)h(they)
0 813 y(make,)j(and)f(to)g(grant)g(the)g(University)e(of)i(Arizona)g(the)g
(rights)f(to)g(redistribute)g(these)h(changes.)964 2753 y(9)p
eop
%%Page: 10 10
9 bop 0 124 a Ft(2)60 b(Uniform)14 b(Pr)o(otocol)e(Interface)0
228 y Fs(Each)i Fr(x)p Fs(-kernel)h(protocol)e(is)g(encapsulated)g(in)h(a)g
(uniform)g(protocol)f(interface.)26 b(The)14 b(suite)f(of)h(protocols)f
(con\256gured)0 284 y(into)e(the)g(system)g(form)h(a)g Fr(pr)n(otocol)e
(graph)h Fs(and)g(the)h(collection)e(of)i(currently)e(opened)i(sessions)d
(\(connections\))i(form)h(a)0 340 y Fr(session)e(graph)p Fs(.)0
465 y Fn(2.1)50 b(T)l(ype)13 b(De\256nitions)0 552 y Fo(2.1.1)45
b(XObj)0 639 y Fs(An)12 b Fr(XObj)g Fs(is)g(the)h(fundamental)f(identi\256er)
g(in)g(the)h(system.)20 b(It)13 b(can)g(represent)g(either)f(a)h(protocol)e
(or)i(a)g(session.)20 b(Fields)0 695 y(which)10 b(can)i(be)f(read)h(or)f
(written)f(by)h(the)g(programmer)h(are)g(so)f(indicated.)102
801 y Fm(t)o(yp)q(edef)k(struct)e Fl(xob)s(j)e Fk(f)205 858
y Fm(X)o(Ob)r(jT)o(yp)q(e)68 b Fs(type;)205 914 y Fm(c)o(har)184
b Fs(*fullName;)53 b Fj(/*)14 b(the)g(name)f(giv)o(en)g(in)h(graph.comp,)d
(e.g.,)i(\\ethdrv/SE0")h(*/)205 971 y Fm(c)o(har)184 b Fs(*name;)127
b Fj(/*)14 b(the)g(proto)q(col)g(name,)e(e.g.,)h(\\ethdrv")h(*/)205
1027 y Fm(c)o(har)184 b Fs(*instName;)50 b Fj(/*)14 b(the)g(instance)h(name,)
d(e.g.,)h(\\SE0")g(*/)205 1084 y Fm(c)o(har)184 b Fs(*state;)141
b Fj(/*)14 b(Readable/writable)f({)g(Owned)i(b)o(y)e(the)i(session/proto)q
(col)f(*/)205 1140 y Fm(Bind)174 b Fs(binding;)107 b Fj(/*)14
b(Readable/writable)f(*/)205 1197 y Fm(in)o(t)211 b Fs(rcnt;)177
b Fj(/*)14 b(readable)g(*/)205 1253 y Fm(in)o(t)211 b Fs(id;)h
Fj(/*)14 b(readable)g(*/)205 1310 y(/*)f(In)o(terface)i(functions)f(*/)205
1366 y Fm(Pfo)199 b Fs(open;)159 b Fj(/*)14 b(proto)q(cols)g(only)f(*/)205
1422 y Fm(Pfk)198 b Fs(closedone;)65 b Fj(/*)14 b(proto)q(cols)g(only)f(*/)
205 1479 y Fm(Pfk)198 b Fs(openenable;)40 b Fj(/*)14 b(proto)q(cols)g(only)f
(*/)205 1535 y Fm(Pfk)198 b Fs(opendisable;)29 b Fj(/*)14 b(proto)q(cols)g
(only)f(*/)205 1592 y Fm(Pfk)198 b Fs(opendone;)70 b Fj(/*)14
b(proto)q(cols)g(only)f(*/)205 1648 y Fm(Pfk)198 b Fs(demux;)124
b Fj(/*)14 b(proto)q(cols)g(only)f(*/)205 1705 y Fm(Pfk)198
b Fs(calldemux;)58 b Fj(/*)14 b(proto)q(cols)g(only)f(*/)205
1761 y Fm(Pfk)198 b Fs(shutdown;)69 b Fj(/*)14 b(proto)q(cols)g(only)f(*/)205
1818 y Fm(Pfk)198 b Fs(pop;)179 b Fj(/*)14 b(sessions)h(only)e(*/)205
1874 y Fm(Pfk)198 b Fs(callpop;)113 b Fj(/*)14 b(sessions)h(only)e(*/)205
1931 y Fm(Pfh)197 b Fs(push;)161 b Fj(/*)14 b(sessions)h(only)e(*/)205
1987 y Fm(Pfk)198 b Fs(call;)182 b Fj(/*)14 b(sessions)h(only)e(*/)205
2043 y Fm(Pfk)198 b Fs(close;)154 b Fj(/*)14 b(sessions)h(or)f(proto)q(cols)g
(*/)205 2100 y Fm(P\014)210 b Fs(control;)118 b Fj(/*)14 b(sessions)h(or)f
(proto)q(cols)g(*/)205 2156 y Fm(Pfk)198 b Fs(duplicate;)80
b Fj(/*)14 b(sessions)h(only)e(*/)205 2213 y Fm(in)o(t)211
b Fs(numdown;)65 b Fj(/*)14 b(readable)g(*/)466 2269 y(/*)f(do)o(wn)h(info)f
(is)g(o)o(wned)h(b)o(y)g(the)h(proto)q(col)e(for)h(its)g(sessions)h(*/)205
2326 y Fm(in)o(t)211 b Fs(downlistsz;)205 2382 y Fm(unsigned)14
b(in)o(t)38 b Fs(idle;)205 2439 y Fm(struct)15 b(xob)r(j)60
b Fs(*down[8];)205 2495 y Fm(struct)15 b(xob)r(j)60 b Fs(**downlist;)205
2552 y Fm(struct)15 b(xob)r(j)60 b Fs(*myprotl;)80 b Fj(/*)14
b(readable)g({)f(a)h(session)h(is)e(an)h(instance)h(of)e(this)h(proto)q(col)g
(*/)205 2608 y Fm(struct)h(xob)r(j)60 b Fs(*up;)179 b Fj(/*)14
b(for)f(sessions)i(only)e(*/)952 2753 y Fs(10)p eop
%%Page: 11 11
10 bop 205 124 a Fm(struct)15 b(xob)r(j)60 b Fs(*hlpT)m(ype;)102
181 y Fk(g)11 b Fs(*)p Fl(X)n(Ob)s(j)p Fs(;)71 287 y(If)k(you)g(think)f(of)h
(the)g Fr(x)p Fs(-kernel)g(as)h(implementing)e(protocol)f(and)i(session)f
(graphs,)i(then)f(each)g Fr(XObj)g Fs(represents)0 343 y(a)h(node)e(in)h(one)
g(of)h(the)f(graphs.)28 b(Furthermore,)17 b(an)e(object')m(s)g
Fr(down)g Fs(vector)g(represents)g(graph)g(edges;)h(they)f(contain)0
400 y(pointers)10 b(to)i(the)f Fr(XObjs)g Fs(that)g(are)h(below)f(the)h
(object)f(in)g(the)h(protocol)e(or)i(session)e(graphs.)18 b(The)12
b(\256elds)f Fr(mypr)n(otl)g Fs(and)h Fr(up)0 456 y Fs(link)e(a)i(session)d
(to)i(the)g(protocols)e(that)i(own)g(and)g(created)g(the)g(session,)f
(respectively)m(.)71 513 y(Note)i(that)g(the)g(one)h(aspect)f(of)h(V)-5
b(ersion)12 b(3.2)h(that)f(dif)o(fers)h(most)f(from)h(descriptions)e(of)i
(the)f Fr(x)p Fs(-kernel)h(found)f(in)g(the)0 569 y(literature)g(is)h(that)f
Fr(pr)n(otocol)g Fs(and)h Fr(session)e Fs(objects)i(have)g(been)g(uni\256ed,)
g(and)g(replaced)g(with)f(a)i(single)e(type)g Fr(XObj)p Fs(.)22
b(As)0 626 y(a)14 b(consequence,)h(routines)e(that)g(really)h(require)g(a)g
(session)f(or)h(a)g(protocol)f(object)g(check)i(the)f(type)f(\256eld)h(of)g
(the)g Fr(XObj)0 682 y Fs(object,)d(where)g(session)f(objects)g(have)h(the)g
(type)g Fr(Session)e Fs(and)i(protocol)f(objects)g(have)i(the)f(type)f
Fr(Pr)n(otocol)p Fs(.)0 805 y Fo(2.1.2)45 b(Enable)12 b(Objects)0
892 y Fs(The)k Fr(Enable)f Fs(object)h(is)f(provided)g(for)i(use)f(by)g(the)f
(programmer)j(in)d(maintaining)g(maps)h(that)g(associate)f(identi\256ers)0
948 y(and)d(protocols)f(or)h(sessions.)19 b(A)12 b(pointer)g(to)g(an)g
Fr(Enable)g Fs(object)f(is)h(often)g(used)g(as)h(the)f(internal)f
(identi\256er)h(in)g Fr(mapBind)0 1005 y Fs(calls.)17 b(An)12
b Fr(Enable)e Fs(object)h(has)h(a)g(\256eld)f(for)h(reference)h(counting.)j
(Protocol)11 b(writers)g(will)g(\256nd)g(this)g(useful)g(in)g(handling)0
1061 y Fr(xOpenEnable)e Fs(calls)g(with)g(identical)g(participants\320the)f
(calls)i(are)g(redundant)f(with)g(respect)h(to)g(session)e(creation\320but)0
1118 y(they)j(must)f(be)i(reference)g(counted)e(in)h(order)g(to)g(properly)f
(handle)h Fr(xOpenDisable)e Fs(calls.)102 1224 y Fm(t)o(yp)q(edef)15
b(struct)e Fl(xenable)d Fk(f)205 1280 y Fm(X)o(Ob)r(j)161 b
Fs(hlpRcv;)94 b Fj(/*)13 b(upp)q(er)i(proto)q(col)e(*/)205
1337 y Fm(X)o(Ob)r(j)161 b Fs(hlpT)m(ype;)76 b Fj(/*)13 b(upp)q(er)i(proto)q
(col)e(*/)205 1393 y Fm(Bind)174 b Fs(binding;)85 b Fj(/*)13
b(from)f(mapBind)g(*/)205 1450 y Fm(in)o(t)211 b Fs(rcnt;)155
b Fj(/*)13 b(A)h(use)h(coun)o(t)f(*/)102 1506 y Fk(g)d Fl(Enable)p
Fs(;)0 1629 y Fo(2.1.3)45 b(Return)13 b(V)l(alues)0 1716 y
Fs(Most)h(routines)e(have)j(a)f(return)g(value)f(type)h(of)g
Fr(xkern)p 887 1716 14 2 v 16 w(r)n(eturn)p 1016 1716 V 16
w(t)p Fs(,)h(which)e(is)h(either)f Fr(XK)p 1416 1716 V 17 w(SUCCESS)h
Fs(or)g Fr(XK)p 1747 1716 V 16 w(F)-6 b(AILURE)p Fs(.)0 1772
y(Routines)14 b(that)h(return)g(type)g Fr(XObj)f Fs(have)i(a)f(failure)h
(value)f(of)g Fr(ERR)p 1116 1772 V 16 w(XOBJ)p Fs(.)g(Some)h(message)g
(handling)d(routines)h(use)0 1829 y(type)e Fr(xmsg)p 188 1829
V 16 w(handle)p Fs(;)h(see)g(section)f(2.2.6.)22 b(Severe)14
b(error)g(conditions)c(will)i(result)g(in)h(console)f(error)i(messages)f(and)
f(the)0 1885 y(termination)e(of)h(the)g Fr(x)p Fs(-kernel.)0
2008 y Fo(2.1.4)45 b(Function)12 b(T)m(ypes)0 2095 y Fs(The)f(following)e
(typedefs)i(are)g(used)g(in)g(the)g Fr(XObj)f Fs(structure)g(and)h
(throughout)e(this)h(document:)114 2201 y Fm(t)o(yp)q(edef)k(xk)o(ern)p
363 2201 13 2 v 16 w(return)p 491 2201 V 16 w(t)25 b Fs(\()12
b(*)f(Pfk)g(\)\(\);)114 2258 y Fm(t)o(yp)q(edef)j(v)o(oid)25
b Fs(\()11 b(*)g(Pfv)h(\)\(\);)114 2314 y Fm(t)o(yp)q(edef)i(struct)h(xob)r
(j)25 b Fs(\()12 b(*)f(Pfo)h(\)\(\);)114 2370 y Fm(t)o(yp)q(edef)i(xmsg)p
358 2370 V 14 w(handle)p 492 2370 V 15 w(t)25 b Fs(\()12 b(*)f(Pfh)g(\)\(\);)
114 2427 y Fm(t)o(yp)q(edef)j(in)o(t)25 b Fs(\()12 b(*)f(P\256)h(\)\(\);)952
2753 y(11)p eop
%%Page: 12 12
11 bop 0 124 a Fn(2.2)50 b(Pr)o(otocol-Pr)o(otocol)12 b(Operations)0
211 y Fs(This)g(section)h(de\256nes)g(the)g(operations)f(that)g(protocols)g
(\(and)h(sessions\))f(invoke)g(on)h(each)h(other)m(.)23 b(In)13
b(general,)h(each)g(of)0 268 y(the)e(operations)f(invokes)g(a)i
(corresponding)d(operation)i(in)f(the)i(tar)o(get)f(protocol)f(or)h(session.)
19 b(For)13 b(example,)g(an)f Fr(xOpen)0 324 y Fs(call)g(will)f(result)g(in)g
(the)h(invocation)e(of)i(a)h(protocol)d(speci\256c)i(open)g(routine,)f(e.g.)
20 b Fr(udp)p 1400 324 14 2 v 15 w(open)p Fs(.)f(For)12 b(each)h(operation,)e
(we)0 381 y(give)j(the)h(interface)g(to)g(both)f(the)h(generic)g
Fr(x)p Fs(-kernel)g(operation)f(and)h(an)g(example)g(protocol-speci\256c)f
(procedure)h(that)0 437 y(implements)g(the)g(generic)h(operation.)29
b(Although)13 b(nearly)j(the)f(same,)j(the)d(speci\256cation)g(for)g(the)h
(generic)f(operation)0 494 y(and)f(the)f(speci\256cation)g(for)h(the)g
(protocol-speci\256c)e(routine)h(typically)f(dif)o(fer)j(in)e(that)g(a)h
Fr(self)g Fs(pointer)e(is)i(passed)f(to)g(the)0 550 y(protocol-speci\256c)d
(routine.)0 673 y Fo(2.2.1)45 b(xOpen)0 760 y Fs(The)13 b Fr(xOpen)h
Fs(function)e(is)h(used)g(by)g(high-level)f(protocol)g Fr(hlpRcv)h
Fs(to)g(actively)f(open)h(a)h(session)e(associated)g(with)h(low-)0
816 y(level)e(protocol)f Fr(llp)h Fs(on)g(behalf)g(of)g(high-level)f
(protocol)g Fr(hlpT)m(ype)p Fs(.)17 b(T)m(ypically)m(,)10 b
Fr(hlpRcv)g Fs(and)i Fr(hlpT)m(ype)e Fs(refer)j(to)d(the)i(same)0
873 y(protocol)j(\(see)i(section)e(2.5.2.\))32 b(The)16 b Fr(participants)d
Fs(ar)o(gument)j(is)g(a)h(list)e(of)h(addresses)g(for)g(each)h(participant)e
(in)g(the)0 929 y(communication.)21 b(For)13 b(this,)f(and)h(all)f(calls)h
(returning)e(type)h Fr(XObj)p Fs(,)h(a)g(return)g(value)f(of)h
Fr(ERR)p 1511 929 V 16 w(XOBJ)f Fs(indicates)g(failure,)0 985
y(and)f(this)f(must)h(be)g(checked)g(by)g(all)g(callers)g(before)g(using)f
(the)h(return)g(value.)71 1042 y(Caveat:)k(the)9 b(high-level)g(protocol)f
(will)g(use)i(its)f Fr(self)g Fs(object)f(as)i(the)g(\256rst)f(ar)o(gument)h
(in)f Fr(xOpen)p Fs(,)h(and)g(the)f(lower)o(-level)0 1098 y(protocol)h
(object)h(as)g(the)g(third)g(ar)o(gument.)17 b(The)11 b(lower)o(-level')m(s)g
(open)g(routine)f(will)h(see)g(its)g(own)f Fr(self)h Fs(object)g(as)g(the)g
(\256rst)0 1155 y(ar)o(gument,)i(and)f(the)g(high-level)e(protocols)h(as)h
(the)g(second)g(and)g(third)f(ar)o(guments.)19 b(This)11 b(reversal)i(of)f
(ar)o(gument)g(order)0 1211 y(preserves)f(the)g(convention)e(that)i(the)g
(current)g(protocol')m(s)f(self)h(object)f(is)h(the)g(\256rst)g(ar)o(gument)g
(in)g(the)g(list.)71 1293 y Fi(Generic:)34 b Fm(X)o(Ob)r(j)12
b Fl(xOp)r(en)p Fs(\()p Fm(X)o(Ob)r(j)f Fh(hlpRcv)p Fs(,)i
Fm(X)o(Ob)r(j)e Fh(hlpT)l(ype)p Fs(,)g Fm(X)o(Ob)r(j)h Fh(llp)p
Fs(,)g Fm(P)o(art)g Fs(*)p Fh(participants)p Fs(\))71 1374
y Fi(Speci\256c:)33 b Fm(X)o(Ob)r(j)12 b Fl(udp)p 484 1374
17 2 v 21 w(op)r(en)p Fs(\()p Fm(X)o(Ob)r(j)f Fh(self)p Fs(,)h
Fm(X)o(Ob)r(j)f Fh(hlpRcv)p Fs(,)i Fm(X)o(Ob)r(j)f Fh(hlpT)l(ype)p
Fs(,)e Fm(P)o(art)i Fs(*)p Fh(participants)p Fs(\))0 1497 y
Fo(2.2.2)45 b(xOpenEnable)0 1584 y Fs(Used)14 b(by)g(high-level)f(protocol)g
Fr(hlpRcv)h Fs(to)g(passively)f(open)h(a)h(session)e(associated)h(with)f
(low-level)h(protocol)f Fr(llp)h Fs(on)0 1640 y(behalf)8 b(of)h(high-level)e
(protocol)g Fr(hlpT)m(ype)p Fs(.)15 b(As)9 b(with)e Fr(xOpen)p
Fs(,)j Fr(hlpRcv)e Fs(and)g Fr(hlpT)m(ype)g Fs(usually)f(refer)i(to)g(the)f
(same)h(protocol.)0 1697 y(A)k(passive)e(open)h(indicates)g(a)g(willingness)e
(to)i(accept)h(connections)e(initiated)g(by)h(remote)h(participants.)19
b(A)13 b(session)e(is)0 1753 y(not)g(actually)h(returned,)g(but)f(the)h
(low-level)f(protocol,)g(by)h(convention,)f(\252remembers\272)i(this)e
(enabling,)h(and)g(later)g(calls)0 1809 y(the)f(high-level)e(protocol')m(s)h
Fr(xOpenDone)g Fs(operation)g(to)h(complete)f(the)h(passive)f(open.)16
b Fr(participants)8 b Fs(is)i(an)h(ordered)g(list)0 1866 y(of)h(addresses)f
(for)h(each)g(participant)e(for)i(which)f(the)g(communication)g(has)g(been)h
(enabled.)17 b(In)12 b(most)f(cases,)h(it)g(contains)0 1922
y(only)e(a)g(single)g(element:)15 b(the)c(address)f(of)g(the)g(local)h
(participant.)k(A)10 b(return)g(value)g(of)h Fr(XK)p 1445 1922
14 2 v 17 w(F)-6 b(AILURE)10 b Fs(indicates)f(failure.)71 1979
y(The)g(lower)o(-level)g(protocol)g(generally)g(\252remembers\272)j(an)e
(invocation)d(of)j(its)f Fr(xOpenEnable)g Fs(operation)g(by)g(binding)0
2035 y(an)i Fr(Enable)f Fs(object)h(to)g(the)f(participant)g(information)g
(using)g Fr(mapBind)p Fs(.)71 2117 y Fi(Generic:)17 b Fm(xk)o(ern)p
361 2117 13 2 v 15 w(return)p 488 2117 V 16 w(t)12 b Fl(xOp)r(enEnable)e
Fs(\()h Fm(X)o(Ob)r(j)h Fh(hlpRcv)p Fs(,)h Fm(X)o(Ob)r(j)e
Fh(hlpT)l(ype)p Fs(,)g Fm(X)o(Ob)r(j)h Fh(llp)p Fs(,)g Fm(P)o(art)g
Fs(*)p Fh(p)f Fs(\))71 2198 y Fi(Speci\256c:)16 b Fm(xk)o(ern)p
361 2198 V 15 w(return)p 488 2198 V 16 w(t)c Fl(udp)p 626 2198
17 2 v 20 w(op)r(enenable)e Fs(\()i Fm(X)o(Ob)r(j)g Fh(self)p
Fs(,)f Fm(X)o(Ob)r(j)h Fh(hlpRcv)p Fs(,)h Fm(X)o(Ob)r(j)e Fh(hlpT)l(ype)p
Fs(,)g Fm(P)o(art)h Fs(*)p Fh(p)p Fs(\))0 2321 y Fo(2.2.3)45
b(xOpenDisable)0 2408 y Fs(Used)8 b(by)f(high-level)g(protocol)g
Fr(hlpRcv)g Fs(to)h(undo)f(the)h(ef)o(fects)g(of)h(an)f(earlier)g(invocation)
e(of)i Fr(xOpenEnable)p Fs(.)15 b(The)7 b(contents)0 2464 y(of)k(the)g
Fr(participant)e Fs(ar)o(gument,)22 b Fr(hlpRcv)g Fs(and)h
Fr(hlpT)m(ype)f Fs(must)10 b(be)i(the)f(same)g(as)h(the)e(ones)h(given)g(to)f
Fr(xOpenEnable)p Fs(.)71 2545 y Fi(Generic:)17 b Fm(xk)o(ern)p
361 2545 13 2 v 15 w(return)p 488 2545 V 16 w(t)12 b Fl(xOp)r(enDisable)p
Fs(\()e Fm(X)o(Ob)r(j)h Fh(hlpRcv)p Fs(,)i Fm(X)o(Ob)r(j)f
Fh(hlpT)l(ype)p Fs(,)e Fm(X)o(Ob)r(j)i Fh(llp)p Fs(,)h Fm(P)o(art)p
Fs(*)p Fh(p)p Fs(\))71 2627 y Fi(Speci\256c:)j Fm(xk)o(ern)p
361 2627 V 15 w(return)p 488 2627 V 16 w(t)c Fl(udp)p 626 2627
17 2 v 20 w(op)r(endisable)p Fs(\()f Fm(X)o(Ob)r(j)g Fh(self)p
Fs(,)h Fm(X)o(Ob)r(j)g Fh(hlpRcv)p Fs(,)g Fm(X)o(Ob)r(j)g Fh(hlpT)l(ype)p
Fs(,)f Fm(P)o(art)p Fs(*)p Fh(p)p Fs(\))952 2753 y(12)p eop
%%Page: 13 13
12 bop 0 124 a Fo(2.2.4)45 b(xOpenDisableAll)0 211 y Fs(Used)11
b(by)g(high-level)f(protocol)g Fr(hlpRcv)g Fs(to)h(inform)g(low-level)g
(protocol)f Fr(llp)g Fs(that)h(all)g(previous)f(openEnables)g(made)i(by)0
268 y Fr(hlpRcv)f Fs(should)e(be)i(removed.)71 349 y Fi(Generic:)17
b Fm(xk)o(ern)p 361 349 13 2 v 15 w(return)p 488 349 V 16 w(t)12
b Fl(xOp)r(enDisableAll)d Fs(\()i Fm(X)o(Ob)r(j)h Fh(hlpRcv)p
Fs(,)h Fm(X)o(Ob)r(j)e Fh(llp)i Fs(\))71 430 y Fi(Speci\256c:)j
Fm(xk)o(ern)p 361 430 V 15 w(return)p 488 430 V 16 w(t)c Fl(udp)p
626 430 17 2 v 20 w(op)r(endisableall)e Fs(\()h Fm(X)o(Ob)r(j)h
Fh(self)p Fs(,)g Fm(X)o(Ob)r(j)g Fh(hlpRcv)g Fs(\))0 553 y
Fo(2.2.5)45 b(xOpenDone)0 640 y Fs(Used)8 b(by)g(low-level)f(protocol)h(to)g
(inform)g(high-level)f(protocol)g(that)h(session)f(\()p Fr(s)p
Fs(\))h(has)h(now)f(been)g(created)h(corresponding)0 697 y(to)i(an)g(earlier)
g Fr(xOpenEnable)f Fs(on)h(behalf)g(of)g Fr(hlpT)m(ype)p Fs(.)114
803 y Fr(3.1)e(compatibility)d(note:)15 b Fs(This)8 b(is)h(like)f(3.1')m(s)i
(x)p 868 803 14 2 v 16 w(callopendone)d(without)h(participants)f(or)i(hlp;)g
(the)g(original)114 859 y(x)p 140 859 V 16 w(opendone)h(no)h(longer)f
(exists.)71 990 y Fi(Generic:)17 b Fm(xk)o(ern)p 361 990 13
2 v 15 w(return)p 488 990 V 16 w(t)12 b Fl(xOp)r(enDone)e Fs(\()h
Fm(X)o(Ob)r(j)h Fh(hlpRcv)p Fs(,)h Fm(X)o(Ob)r(j)e Fh(s)p Fs(,)h
Fm(X)o(Ob)r(j)g Fh(llp)g Fs(\))71 1072 y Fi(Speci\256c:)k Fm(xk)o(ern)p
361 1072 V 15 w(return)p 488 1072 V 16 w(t)c Fl(udp)p 626 1072
17 2 v 20 w(op)r(endone)f Fs(\()p Fm(X)o(Ob)r(j)h Fh(self)p
Fs(,)g Fm(X)o(Ob)r(j)f Fh(lls)p Fs(,)i Fm(X)o(Ob)r(j)f Fh(llp)p
Fs(,)g Fm(X)o(Ob)r(j)g Fh(hlpT)l(ype)f Fs(\))0 1194 y Fo(2.2.6)45
b(xPush)0 1281 y Fs(Used)15 b(by)f(a)h(high-level)f(protocol)f(that)i(opened)
f(session)g Fr(s)g Fs(to)h(pass)f(the)h(message)g Fr(msg)f
Fs(down)g(through)g(that)g(session.)0 1338 y(The)g(return)g(value)g(is)g(an)g
(opaque)g(handle)f(on)h(the)g(message)g(that)g(was)g(sent.)25
b(This)14 b(handle)f(may)i(be)f(used)g(to)g(identify)0 1394
y(this)c(message)i(in)f(subsequent)e Fr(xContr)n(ol)i Fs(operations.)16
b(The)11 b(message)g(handle)g(may)h(also)f(take)g(one)g(of)h(two)f(special)f
(val-)0 1451 y(ues:)17 b(a)12 b(return)g(value)f(of)h Fr(XMSG)p
529 1451 14 2 v 16 w(ERR)p 629 1451 V 15 w(HANDLE)g Fs(indicates)f(general)g
(failure,)i(while)e Fr(XMSG)p 1530 1451 V 15 w(ERR)p 1629 1451
V 16 w(WOULDBLOCK)0 1507 y Fs(indicates)f(that)g(a)i(session)e(in)g
(non-blocking)f(mode)j(would)e(normally)g(have)h(blocked)g(the)f(push.)114
1614 y Fr(3.1)k(compatibility)e(note:)23 b Fs(The)15 b(reply)f(message)h(ar)o
(g)g(from)h(3.1)f(has)f(been)h(eliminated.)26 b(Use)15 b(xCall)f(if)h(a)114
1670 y(reply)10 b(message)i(is)e(expected.)71 1801 y Fi(Generic:)17
b Fm(xmsg)p 356 1801 13 2 v 13 w(handle)p 489 1801 V 15 w(t)12
b Fl(xPush)f Fs(\()p Fm(X)o(Ob)r(j)h Fh(s)p Fs(,)g Fm(Msg)g
Fs(*)p Fh(msg)p Fs(\))71 1882 y Fi(Speci\256c:)k Fm(xmsg)p
356 1882 V 13 w(handle)p 489 1882 V 15 w(t)c Fl(udp)p 626 1882
17 2 v 20 w(push)g Fs(\()p Fm(X)o(Ob)r(j)g Fh(self)p Fs(,)g
Fm(Msg)f Fs(*)p Fh(msg)p Fs(\))0 2005 y Fo(2.2.7)45 b(xCall)0
2092 y Fs(Similar)16 b(to)f Fr(xPush)f Fs(except)i(that)e(a)i(\252reply\272)g
(message)f(may)h(be)g(returned)f(through)f(the)h(ar)o(gument)h
Fr(r)n(eply)p 1730 2092 14 2 v 16 w(msg)p Fs(.)29 b(Used)0
2149 y(with)9 b(synchronous)f(\(RPC-like\))j(protocols.)j(Because)d(the)f
(lower)f(protocol)g(typically)f(retains)i(no)f(state)h(for)g(the)g(request)0
2205 y(message)i(after)h Fr(xCall)e Fs(returns,)h(a)g(message)h(handle)e(is)g
(not)h(returned.)18 b(The)12 b(message)g(structure)f(for)h(the)g(reply)g
(must)f(be)0 2262 y(initialized;)e(see)i Fr(msgConstructEmpty)p
Fs(.)71 2343 y Fi(Generic:)17 b Fm(xk)o(ern)p 361 2343 13 2
v 15 w(return)p 488 2343 V 16 w(t)12 b Fl(xCall)f Fs(\()p Fm(X)o(Ob)r(j)g
Fh(s)p Fs(,)h Fm(Msg)g Fs(*)p Fh(msg)p Fs(,)f Fm(Msg)h Fs(*)p
Fh(r)o(eply)p 1293 2343 15 2 v 17 w(msg)p Fs(\))71 2424 y Fi(Speci\256c:)k
Fm(xk)o(ern)p 361 2424 13 2 v 15 w(return)p 488 2424 V 16 w(t)c
Fl(udp)p 626 2424 17 2 v 20 w(call)f Fs(\()p Fm(X)o(Ob)r(j)h
Fh(s)p Fs(,)g Fm(Msg)f Fs(*)p Fh(msg)p Fs(,)g Fm(Msg)h Fs(*)p
Fh(r)o(eply)p 1361 2424 15 2 v 17 w(msg)p Fs(\))952 2753 y(13)p
eop
%%Page: 14 14
13 bop 0 124 a Fo(2.2.8)45 b(xPop)0 211 y Fs(Used)15 b(by)g(a)g(protocol)f
(to)h(pass)g(an)g(incoming)g(message)g Fr(msg)g Fs(up)g(to)f(session)g
Fr(s)h Fs(for)h(processing,)f(and)g(to)g(indicate)f(the)0 268
y(lower)o(-level)e(session)g(from)i(which)e(the)h(message)g(was)g(received)h
(\()p Fr(lls)p Fs(\).)21 b(This)13 b(calls)f(the)h(pop)g(routine)f(of)h(the)g
(session)e Fr(s)0 324 y Fs(and)g(increments)g(the)g(session)f(reference)i
(count)e(\(see)i(section)e(11\).)17 b(This)10 b(call)h(is)g(invoked)f(by)g(a)
i(protocol)e(on)h(one)g(of)g(its)0 381 y(own)g(sessions.)71
437 y(The)16 b Fr(hdr)g Fs(ar)o(gument)g(is)g(passed)g(through)f(the)h
(infrastructure)f(directly)h(to)g(the)g(protocol-speci\256c)f(routine.)31
b(It)17 b(is)0 494 y(typically)c(used)i(to)g(pass)f(the)h(header)h(\(which)e
(the)h Fr(demux)g Fs(routine)f(used)h(to)g(\256nd)g(the)f(session\))g(to)h
(the)g(session')m(s)f Fr(pop)0 550 y Fs(routine.)71 631 y Fi(Generic:)j
Fm(xk)o(ern)p 361 631 13 2 v 15 w(return)p 488 631 V 16 w(t)12
b Fl(xP)n(op)g Fs(\()p Fm(X)o(Ob)r(j)f Fh(s)p Fs(,)h Fm(X)o(Ob)r(j)g
Fh(lls)p Fs(,)h Fm(Msg)e Fs(*)p Fh(msg)p Fs(,)h Fm(v)o(oid)h(*)e
Fh(hdr)p Fs(\))71 713 y Fi(Speci\256c:)17 b Fm(xk)o(ern)p 362
713 V 15 w(return)p 489 713 V 17 w(t)11 b Fl(udp)p 627 713
17 2 v 21 w(p)r(op)g Fs(\()p Fm(X)o(Ob)r(j)h Fh(self)p Fs(,)f
Fm(X)o(Ob)r(j)h Fh(lls)p Fs(,)h Fm(Msg)f Fs(*)p Fh(msg)p Fs(,)f
Fm(v)o(oid)i(*)e Fh(hdr)p Fs(\))0 835 y Fo(2.2.9)45 b(xCallPop)0
922 y Fs(When)7 b(a)h(synchronous)d(\(RPC-like\))k(protocol)d(will)g(be)i
(demuxing)e(a)i(message)g(to)f(an)g(asynchronous)f(protocol,)h
Fr(xCallPop)0 979 y Fs(can)j(be)f(used)g(to)g(allow)g(the)g(upper)g(protocol)
f(to)h(return)h(a)f(message.)17 b(This)8 b(reply)h(message)h(may)g(be)f(the)g
(same)i(one)e(passed)0 1035 y(to)i(the)g(synchronous)e(protocol)h(via)h
Fr(xCallDemux)p Fs(.)71 1117 y Fi(Generic:)17 b Fm(xk)o(ern)p
361 1117 13 2 v 15 w(return)p 488 1117 V 16 w(t)12 b Fl(xCallP)n(op)f
Fs(\()p Fm(X)o(Ob)r(j)h Fh(s)p Fs(,)g Fm(X)o(Ob)r(j)g Fh(lls)p
Fs(,)h Fm(Msg)e Fs(*)p Fh(msg)p Fs(,)g Fm(v)o(oid)i(*)f Fh(hdr)p
Fs(,)f Fm(Msg)h Fs(*)p Fh(rmsg)p Fs(\))71 1198 y Fi(Speci\256c:)k
Fm(xk)o(ern)p 361 1198 V 15 w(return)p 488 1198 V 16 w(t)c
Fl(udp)p 626 1198 17 2 v 20 w(callp)r(op)f Fs(\()p Fm(X)o(Ob)r(j)h
Fh(self)p Fs(,)f Fm(X)o(Ob)r(j)h Fh(lls)p Fs(,)h Fm(Msg)f Fs(*)p
Fh(msg)p Fs(,)f Fm(v)o(oid)i(*)e Fh(hdr)p Fs(,)h Fm(Msg)f Fs(*)p
Fh(rmsg)p Fs(\))0 1321 y Fo(2.2.10)45 b(xCloseDone)0 1408 y
Fs(Used)16 b(by)g(a)h(low-level)f(protocol)f(to)h(inform)h(the)f(high-level)f
(protocol)g(that)h(originally)f(opened)h(session)f Fr(s)i Fs(that)e(the)0
1464 y(session)10 b(has)h(been)g(closed)f(by)h(a)h(peer)f(participant.)71
1545 y Fi(Generic:)p Fm(xk)o(ern)p 344 1545 13 2 v 16 w(return)p
472 1545 V 16 w(t)g Fl(xCloseDone)g Fs(\()p Fm(X)o(Ob)r(j)h
Fh(s)p Fs(\))71 1627 y Fi(Speci\256c:)k Fm(xk)o(ern)p 361 1627
V 15 w(return)p 488 1627 V 16 w(t)c Fl(udp)p 626 1627 17 2
v 20 w(closedone)f Fs(\()p Fm(X)o(Ob)r(j)h Fh(s)p Fs(\))0 1749
y Fo(2.2.11)45 b(xClose)0 1836 y Fs(Decrements)18 b(the)f(reference)i(count)e
(of)g(an)h Fr(XObj)e Fs(\(see)i(section)f(11\),)i(calling)e(the)g(object')m
(s)g(close)g(function)f Fr(only)h Fs(if)0 1893 y(the)d(reference)h(count)f
(is)f(zero.)26 b(This)13 b(call)h(applies)g(to)f Fr(XObj)p
Fs(s)g(that)h(represent)g(both)f(protocols)g(and)h(sessions,)f(but)g(the)0
1949 y(implications)c(of)i(invoking)e Fr(xClose)i Fs(on)g(a)h(protocol)e(is)g
(not)h(fully)f(determined)h(at)g(this)f(time.)114 2056 y Fr(3.1)i
(compatibility)e(note:)19 b Fs(Replaces)13 b(xCloseProtl)f(and)g
(xCloseSession.)20 b(Note)12 b(that)g(in)g(3.1,)i(the)e Fr(XObj)p
Fs(')m(s)114 2112 y(close)e(function)g(was)h(called)g(every)h(time)f
(xCloseProtl)f(or)h(xCloseSession)f(was)h(called.)71 2243 y
Fi(Generic:)17 b Fm(xk)o(ern)p 361 2243 13 2 v 15 w(return)p
488 2243 V 16 w(t)12 b Fl(xClose)e Fs(\()p Fm(X)o(Ob)r(j)i
Fh(object)p Fs(\))71 2325 y Fi(Speci\256c:)k Fm(xk)o(ern)p
361 2325 V 15 w(return)p 488 2325 V 16 w(t)c Fl(udp)p 626 2325
17 2 v 20 w(close)f Fs(\()p Fm(X)o(Ob)r(j)h Fh(object)p Fs(\))952
2753 y(14)p eop
%%Page: 15 15
14 bop 0 124 a Fo(2.2.12)45 b(xContr)o(ol)0 211 y Fs(Used)10
b(by)h(one)g Fr(XObj)f Fs(to)g(act)h(upon)f(another)g Fr(XObj)g
Fs(for)h(retrieving)f(information)g(or)h(for)g(setting)e(processing)g
(parameters.)0 268 y(The)g(operation)e(code)i Fr(opcode)g Fs(identi\256es)e
(the)i(action;)f Fr(buf)g Fs(is)h(a)g(character)h(buf)o(fer)f(from)g(which)f
(an)h(ar)o(gument)g(is)f(retrieved)0 324 y(and/or)h(into)f(which)h(a)h
(result)e(is)h(placed;)h(and)f Fr(len)g Fs(is)g(the)h(length)e(of)h(the)h
(buf)o(fer)m(.)17 b(There)9 b(are)h(two)f(\252classes\272)g(of)h(operations:)
0 381 y(standard)16 b(ones)h(that)g(may)g(be)g(implemented)g(by)g(more)h
(than)e(one)h(protocol,)h(and)f(protocol-speci\256c)f(ones.)34
b(A)17 b(full)0 437 y(discussion)9 b(of)i(control)f(operation)g(codes)h(is)g
(in)f(section)h(10.)114 543 y Fr(3.1)g(compatibility)d(note:)16
b Fs(The)11 b(routines)f(controlprotl)f(and)i(controlsessn)e(no)i(longer)f
(exist.)71 675 y Fi(Generic:)17 b Fm(in)o(t)11 b Fl(xCon)n(trol)g
Fs(\()p Fm(X)o(Ob)r(j)h Fh(object)p Fs(,)f Fm(in)o(t)g Fh(opcode)p
Fs(,)i Fm(c)o(har)e Fs(*)p Fh(buf)p Fs(,)g Fm(in)o(t)g Fh(len)p
Fs(\))71 756 y Fi(Speci\256c:)16 b Fm(in)o(t)11 b Fl(udp)p
416 756 17 2 v 20 w(con)n(trol)g Fs(\()p Fm(X)o(Ob)r(j)h Fh(self)p
Fs(,)g Fm(in)o(t)f Fh(opcode)p Fs(,)h Fm(c)o(har)g Fs(*)p Fh(buf)p
Fs(,)f Fm(in)o(t)g Fh(len)p Fs(\))0 879 y Fo(2.2.13)45 b(xDemux)0
966 y Fs(Used)11 b(by)f(low-level)g(session)g Fr(s)h Fs(to)g(pass)f(message)i
Fr(msg)e Fs(to)h(the)g(high-level)e(protocol)h(that)h(created)g(it.)16
b(The)11 b(higher)o(-level)0 1022 y(protocol)j(is)g(determined)h(from)g(the)g
(session)f(object.)27 b(The)15 b(higher)o(-level)f(protocol)f(demux)i
(routine)f(should)g(\256nd)g(the)0 1078 y(appropriate)e(session,)g(creating)h
(it)f(if)h(necessary)m(,)g(and)g Fr(xPop)f Fs(the)h(message)g(to)f(the)h
(session.)20 b(See)13 b(2.3.1)g(for)g(guidelines)0 1135 y(on)e(when)g
(session)e(creation)i(is)g(appropriate.)71 1191 y(The)f(called)g(routine)f
(is)h(presented)g(with)f(its)h(protocol)f(object,)h(the)g(session)f(object)g
(from)i(the)f(lower)o(-level)g(protocol,)0 1248 y(and)h(the)g(message.)71
1329 y Fi(Generic:)17 b Fm(xk)o(ern)p 361 1329 13 2 v 15 w(return)p
488 1329 V 16 w(t)12 b Fl(xDem)n(ux)d Fs(\()p Fm(X)o(Ob)r(j)j
Fh(s)p Fs(,)g Fm(Msg)f Fs(*)p Fh(msg)p Fs(\))71 1411 y Fi(Speci\256c:)16
b Fm(xk)o(ern)p 361 1411 V 15 w(return)p 488 1411 V 16 w(t)c
Fl(udp)p 626 1411 17 2 v 20 w(dem)n(ux)e Fs(\()p Fm(X)o(Ob)r(j)i
Fh(self)p Fs(,)g Fm(X)o(Ob)r(j)g Fh(lls)p Fs(,)g Fm(Msg)g Fs(*)p
Fh(msg)p Fs(\))0 1533 y Fo(2.2.14)45 b(xCallDemux)0 1620 y
Fs(This)16 b(call)i(is)e(like)h Fr(xDemux)h Fs(but)e(allows)h(an)g(ar)o
(gument)g(to)g(contain)g(a)g(return)h(message.)35 b(Used)17
b(with)f(synchronous)0 1677 y(\(RPC-like\))c(protocols.)71
1758 y Fi(Generic:)17 b Fm(xk)o(ern)p 361 1758 13 2 v 15 w(return)p
488 1758 V 16 w(t)12 b Fl(xCallDem)n(ux)d Fs(\()p Fm(X)o(Ob)r(j)j
Fh(s)p Fs(,)g Fm(Msg)f Fs(*)p Fh(msg)p Fs(,)g Fm(Msg)h Fs(*)p
Fh(rmsg)p Fs(\))71 1839 y Fi(Speci\256c:)k Fm(xk)o(ern)p 361
1839 V 15 w(return)p 488 1839 V 16 w(t)c Fl(up)r(d)p 628 1839
17 2 v 20 w(calldem)n(ux)d Fs(\()p Fm(X)o(Ob)r(j)j Fh(self)p
Fs(,)g Fm(X)o(Ob)r(j)f Fh(lls)p Fs(,)i Fm(Msg)f Fs(*)p Fh(msg)p
Fs(,)f Fm(Msg)h Fs(*)p Fh(rmsg)p Fs(\))0 1962 y Fo(2.2.15)45
b(xDuplicate)0 2049 y Fs(Increments)10 b(the)f(reference)i(count)e(of)g
(session)f Fr(s)p Fs(.)16 b(This)9 b(can)h(be)f(used)g(to)h(create)g(a)g
(permanent)f(handle)g(on)h(the)f Fr(XObj)g Fs(from)0 2105 y(a)k(temporary)g
(handle,)g(or)f(to)h(create)g(a)g(new)g(equivalent)e(handle)h(from)h(an)g
(existing)e(handle.)21 b(For)13 b(a)g(full)f(discussion)e(of)0
2162 y(session)g(reference)i(counts,)e(see)i(section)e(11.)71
2243 y Fi(Generic:)17 b Fm(xk)o(ern)p 361 2243 13 2 v 15 w(return)p
488 2243 V 16 w(t)12 b Fl(xDuplicate)e Fs(\()p Fm(X)o(Ob)r(j)h
Fh(s)p Fs(\))71 2325 y Fi(Speci\256c:)16 b Fm(xk)o(ern)p 361
2325 V 15 w(return)p 488 2325 V 16 w(t)c Fl(udp)p 626 2325
17 2 v 20 w(duplicate)f Fs(\()p Fm(X)o(Ob)r(j)h Fh(self)p Fs(\))952
2753 y(15)p eop
%%Page: 16 16
15 bop 0 124 a Fo(2.2.16)45 b(xShutDown)0 211 y Fs(Called)12
b(once)g(for)g(each)h(protocol)e(object)g(to)h(indicate)f(imminent)h(death)g
(of)g(the)g Fr(x)p Fs(-kernel.)20 b(A)12 b(protocol)e(may)j(choose)f(to)0
268 y(take)f(actions)g(to)g(shut)f(down)g(in)h(a)h(graceful)g(manner)m(.)18
b(In)11 b(particular)n(,)h(boundary)e(protocols)g(may)h(choose)g(to)g(sever)h
(their)0 324 y(connections)d(to)i(the)g(outside)f(world)g(in)h(an)g(orderly)g
(manner)h(on)e(receipt)h(of)h(this)e(call.)71 381 y(Protocols)g(should)f
(generally)i(not)f(invoke)h(this)f(operation)g(on)h(other)f(protocols)g(or)h
(on)g(themselves.)16 b(It)11 b(is)g(typically)0 437 y(invoked)f(by)h(the)g
Fr(x)p Fs(-kernel)g(infrastructure)f(itself.)71 518 y Fi(Generic:)17
b Fm(xk)o(ern)p 361 518 13 2 v 15 w(return)p 488 518 V 16 w(t)12
b Fl(xSh)n(utDo)n(wn)g Fs(\()p Fm(X)o(Ob)r(j)g Fh(pr)o(otl)g
Fs(\))71 600 y Fi(Speci\256c:)k Fm(xk)o(ern)p 361 600 V 15
w(return)p 488 600 V 16 w(t)c Fl(udp)p 626 600 17 2 v 20 w(sh)n(utdo)n(wn)i
Fs(\()p Fm(X)o(Ob)r(j)d Fh(self)p Fs(\))0 724 y Fn(2.3)50 b(Graph)12
b(Manipulation)e(Operations)0 811 y Fs(Unlike)15 b(the)i(previous)e(set)h(of)
h(operations\320which)e(protocols)g(invoke)g(on)h(each)h(other)g(to)f
(open/close)f(connections)0 868 y(and)e(to)g(send/receive)g(messages\320the)g
(operations)g(de\256ned)g(in)g(this)f(section)h(actually)f(manipulate)h(the)g
(protocol)f(and)0 924 y(session)c(graphs;)g(i.e,)j(create)f(nodes)e(and)h
(edges.)16 b(These)8 b(operations)g(are)i(either)f(called)g(by)f(the)h
Fr(x)p Fs(-kernel)h(at)f(start-up)f(time)0 980 y(to)14 b(create)g(and)g(link)
f(together)g(protocol)g(objects,)h(or)g(by)g(protocols)e(at)i(runtime)g(to)f
(create)i(and)f(link)f(together)g(session)0 1037 y(objects.)0
1160 y Fo(2.3.1)45 b(xCr)o(eateSessn)0 1247 y Fs(Called)11
b(by)f(protocol)g Fr(llp)g Fs(to)g(create)i(a)f(session)f(that)g(will)g
(handle)g(data)h(associated)f(with)g(a)h(common)g(source/destination)0
1303 y(pair)m(.)22 b(Usually)12 b(called)h(in)f(response)h(to)f(an)h
Fr(xOpen)g Fs(call,)h(or)f(because)g(data)g(has)f(arrived)h(with)f
(participants)g(that)g(match)0 1359 y(a)19 b(previous)f Fr(xOpenEnable)f
Fs(call.)40 b(By)19 b(convention,)g(a)h(protocol)d(will)h(only)g(create)i
(one)e(session)g(at)h(a)g(time)g(for)g(a)0 1416 y(source/destination)8
b(pair)n(,)k(even)f(if)g(there)g(have)g(been)h(multiple)e Fr(xOpenEnable)p
Fs(')m(s)g(that)g(would)g(match)i(incoming)e(data.)71 1472
y(The)d(session)g(is)g(initialized)f(using)g(information)h(found)g(in)g
(protocols)f Fr(hlpRcv)p Fs(,)j Fr(hlpT)m(ype)e Fs(and)g Fr(llp)p
Fs(.)15 b(The)8 b(new)f(session')m(s)0 1529 y(up)14 b(pointer)f(is)g(set)h
(to)f Fr(hlpRcv)h Fs(\(this)f(is)g(where)h(upward-bound)f(messages)g(through)
g(this)g(session)f(will)h(be)h(delivered.\))0 1585 y(The)f(count)g
Fr(downc)g Fs(indicates)f(how)g(many)i(lower)f(level)g(sessions)e(this)h
(session)g(requires.)22 b(It)14 b(need)f(be)g(non-zero)g(only)0
1642 y(for)g(sessions)e(that)h(will)g(store)g(sessions)f(in)h(the)h
(\252down\272)f(vector)g Fr(downv)h Fs(\(it)f(will)g(be)h(zero)g(for)g
(device)g(drivers)f(and)g(one)0 1698 y(for)g(normal)f(sessions.\))16
b(The)c(initialization)c(function)i(pointer)h Fr(f)g Fs(may)h(be)g(null;)e
(otherwise)h(this)f(function)g(should)g(\256ll)i(in)0 1755
y(the)g(interface)g(function)f(pointers)g(in)h(the)g Fr(XObj)g
Fs(structure.)19 b(These)12 b(pointers)f(are)h(initialized)f(to)h(default)f
(\(usually)g(null\))0 1811 y(functions)f(by)g(the)h(system)g(initialization)d
(code.)71 1892 y Fm(X)o(Ob)r(j)h Fl(xCreateSessn)p Fs(\()p
Fm(Pfv)f Fh(f)p Fs(,)h Fm(X)o(Ob)r(j)h Fh(hlpRcv)p Fs(,)h Fm(X)o(Ob)r(j)e
Fh(hlpT)l(ype)p Fs(,)g Fm(X)o(Ob)r(j)g Fh(llp)p Fs(,)i Fm(in)o(t)d
Fh(downc)p Fs(,)j Fm(X)o(Ob)r(j)e Fs(*)p Fh(downv)p Fs(\))71
2030 y Fi(Example)k(Init)f(Function:)17 b Fm(v)o(oid)10 b Fl(udp)p
720 2030 V 21 w(sessn)p 864 2030 V 20 w(init)g Fs(\()p Fm(X)o(Ob)r(j)i
Fh(self)p Fs(\))0 2178 y Fo(2.3.2)45 b(xCr)o(eatePr)o(otl)0
2265 y Fs(Called)11 b(during)g(system)f(start-up)h(for)g(each)h(protocol)e
(in)h(the)h(graph.)k(The)c(function)e Fr(f)h Fs(is)g(called)g(to)g
(initialize)f(a)i(protocol)0 2321 y(object.)k(It)10 b(must)g(have)h(a)g
(well-known)e(name)i(derived)f(from)i(the)e(concatenation)f(of)i(the)f
(protocol)f(name)j(and)e(the)g(string)0 2378 y(\252)p 23 2378
14 2 v 17 w Fr(init)p Fs(\272)15 b(\(e.g.,)k Fr(tcp)p 303 2378
V 16 w(init)p Fs(\).)32 b(The)16 b(initialization)e(generally)h(allocates)h
(and)g(initializes)f(protocol)g(state)h(and)g(\256lls)g(in)g(the)0
2434 y(interface)10 b(function)f(pointers.)15 b(Because)c(function)d
(pointers)h(are)i(initialized)d(to)i(null)f(functions)f(before)i
Fr(f)g Fs(is)g(called,)g(only)0 2491 y(those)g(functions)g(actually)g(used)h
(by)g(the)g(protocol)e(need)j(be)f(de\256ned.)71 2547 y(Use)e(of)i
Fr(xCr)n(eatePr)n(otl)e Fs(outside)f(of)j(initialization)o(,)d(e.g.,)k(to)d
(dynamically)g(load)h(new)g(protocols,)f(is)g(not)h(supported)e(at)0
2604 y(this)i(time.)952 2753 y(16)p eop
%%Page: 17 17
16 bop 114 124 a Fr(3.1)18 b(compatibility)e(note:)31 b Fs(Replaces)19
b(x)p 782 124 14 2 v 16 w(instantiateprotl)d(and)i(x)p 1197
124 V 16 w(createprotl)h(\(the)f(user)h(routine\))f(and)114
181 y(eliminates)10 b(the)h(need)g(for)g(x)p 566 181 V 16 w(getproc.)71
312 y Fm(X)o(Ob)r(j)g Fl(xCreateProtl)f Fs(\()p Fm(Pfv)i Fh(f)p
Fs(,)f Fm(c)o(har)h Fs(*)p Fh(name)p Fs(,)f Fm(c)o(har)h Fs(*)p
Fh(instName)p Fs(,)g Fm(in)o(t)f Fh(downc)p Fs(,)h Fm(X)o(Ob)r(j)g
Fs(*)p Fh(downv)f Fs(\))71 393 y Fi(Example)i(Init)f(Function:)17
b Fm(v)o(oid)10 b Fl(udp)p 720 393 17 2 v 21 w(init)g Fs(\()p
Fm(X)o(Ob)r(j)i Fh(self)p Fs(\))0 516 y Fo(2.3.3)45 b(xDestr)o(oy)0
603 y Fs(Destroys)12 b(protocol)f(and)i(session)f(objects.)21
b(It)13 b(is)f(the)h(inverse)g(of)g Fr(xCr)n(eateSessn)f Fs(and)h
Fr(xCr)n(eatePr)n(otl)p Fs(.)21 b(Storage)13 b(for)g(the)0
659 y Fr(XObj)d Fs(is)h(freed,)h(and)f(if)g(the)g(state)g(pointer)f(of)h(the)
g Fr(XObj)f Fs(is)h(non-null,)f(it)g(is)h(also)g(freed.)71
741 y Fm(xk)o(ern)p 173 741 13 2 v 15 w(return)p 300 741 V
16 w(t)h Fl(xDestro)n(y)p Fs(\()p Fm(X)o(Ob)r(j)e Fh(object)p
Fs(\))0 888 y Fo(2.3.4)45 b(xGetPr)o(otlByName)0 975 y Fs(Returns)12
b(a)h(capability)e(for)i(a)g(protocol)e(object)h(given)g(its)g(mnemonic)h
(name.)21 b(\(See)14 b(the)e(discussion)e(of)j(graph.comp)g(in)0
1032 y(section)d(13.\))71 1113 y Fm(X)o(Ob)r(j)h Fl(xGetProtlByName)d
Fs(\()p Fm(c)o(har)k Fs(*)p Fh(name)f Fs(\))0 1236 y Fo(2.3.5)45
b(xSetDown)0 1323 y Fs(Sets)10 b(the)h Fr(index)p Fs(th)e(member)j(of)f
Fr(self)p Fs(')m(s)f(down)f(vector)i(to)f(be)g Fr(object)p
Fs(.)16 b(It)11 b(sets)e(or)i(increments)f(the)g Fr(XObj)g
Fs(\256eld)h Fr(numdown)e Fs(as)0 1379 y(a)j(side)e(ef)o(fect.)71
1461 y Fm(xk)o(ern)p 173 1461 V 15 w(return)p 300 1461 V 16
w(t)i Fl(xSetDo)n(wn)f Fs(\()p Fm(X)o(Ob)r(j)h Fh(self)p Fs(,)g
Fm(in)o(t)f Fh(index)p Fs(,)h Fm(X)o(Ob)r(j)g Fh(object)p Fs(\))0
1583 y Fo(2.3.6)45 b(xGetDown)0 1670 y Fs(Returns)11 b(the)h
Fr(index)p Fs(th)f(member)i(of)f Fr(self)p Fs(')m(s)f(down)g(vector)m(.)19
b(Returns)12 b Fr(ERR)p 1178 1670 14 2 v 15 w(XOBJ)g Fs(if)g(the)f(index)g
(is)h(lar)o(ger)g(than)f(the)h(down)0 1727 y(vector)m(.)71
1808 y Fm(X)o(Ob)r(j)f Fl(xGetDo)n(wn)h Fs(\()p Fm(X)o(Ob)r(j)f
Fh(self)p Fs(,)h Fm(in)o(t)f Fh(index)p Fs(\))0 1931 y Fo(2.3.7)45
b(xSetUp)0 2018 y Fs(Resets)9 b(the)h(up)f(pointer)g(of)g(session)f
Fr(s)i Fs(to)f Fr(hlp)p Fs(.)15 b(The)10 b(up)f(pointer)f(of)i(a)g(session)e
(is)h(initialized)f(in)h Fr(xCr)n(eateSessn)p Fs(,)h(so)f Fr(xSetUp)0
2074 y Fs(is)i(only)f(used)h(for)g(extraordinary)f(manipulation)f(of)j(the)f
(session)e(graph.)71 2155 y Fm(v)o(oid)h Fl(xSetUp)h Fs(\()p
Fm(X)o(Ob)r(j)g Fh(s)p Fs(,)h Fm(X)o(Ob)r(j)g Fh(hlp)p Fs(\))0
2278 y Fo(2.3.8)45 b(xGetUp)0 2365 y Fs(Returns)11 b(the)g(up)f(pointer)h(of)
g(session)f Fr(s)p Fs(.)71 2446 y Fm(X)o(Ob)r(j)h Fl(xGetUp)g
Fs(\()p Fm(X)o(Ob)r(j)h Fh(s)p Fs(\))952 2753 y(17)p eop
%%Page: 18 18
17 bop 0 124 a Fo(2.3.9)45 b(xHlpT)m(ype)0 211 y Fs(Returns)11
b(the)g Fr(hlpT)m(ype)f Fs(ar)o(gument)h(that)g(was)g(used)g(to)f(create)i
(session)e Fr(s.)71 293 y Fm(X)o(Ob)r(j)h Fl(xHlpT)n(yp)r(e)f
Fs(\()p Fm(X)o(Ob)r(j)i Fh(s)p Fs(\))0 417 y Fn(2.4)63 b(Utility)11
b(Operations)0 504 y Fo(2.4.1)45 b(xIsPr)o(otocol)0 591 y Fs(Returns)11
b(true)g(if)g(the)g Fr(XObj)f Fs(is)h(a)g(protocol.)71 672
y Fm(b)q(o)q(ol)f Fl(xIsProto)r(col)g Fs(\()i Fm(X)o(Ob)r(j)f
Fs(\))0 795 y Fo(2.4.2)45 b(xIsSession)0 882 y Fs(Returns)11
b(true)g(if)g(the)g Fr(XObj)f Fs(is)h(a)g(session.)71 963 y
Fm(b)q(o)q(ol)f Fl(xIsSession)h Fs(\()g Fm(X)o(Ob)r(j)h Fs(\))0
1086 y Fo(2.4.3)45 b(xIsXObj)0 1173 y Fs(Returns)11 b(true)h(if)g(the)f
Fr(XObj)g Fs(is)g(either)g(a)h(session)f(or)g(a)h(protocol)f(\(i.e.,)i(if)e
(this)g(returns)g(false)h(the)f Fr(XObj)g Fs(was)h(either)f(never)0
1229 y(initialized)e(or)i(has)g(been)h(badly)e(clobbered.\))71
1311 y Fm(b)q(o)q(ol)g Fl(xIsX)n(Ob)s(j)i Fs(\()g Fm(X)o(Ob)r(j)g
Fs(\))0 1433 y Fo(2.4.4)45 b(xIsV)l(alidXObj)0 1520 y Fs(XObjects)9
b(created)i(with)f(xCreateSessn)g(or)h(xCreateProtl)f(are)h(kept)f(in)g(a)h
(system)f(map)h(and)f(removed)h(when)f(the)g(object)0 1577
y(is)i(destroyed.)20 b Fr(xIsV)-5 b(alidXObj)10 b Fs(can)j(be)g(used)f(to)h
(determine)f(whether)h(a)g(random)f(XObject)g(handle)g(is)g(in)h(this)e(map)i
(and)0 1633 y(can)e(thus)g(be)g(used)g(safely)m(.)71 1715 y
Fm(b)q(o)q(ol)f Fl(xIsV)-5 b(alidX)n(Ob)s(j)13 b Fs(\()e Fm(X)o(Ob)r(j)h
Fs(\))0 1837 y Fo(2.4.5)45 b(xPrintXObj)0 1924 y Fs(Display)10
b(some)h(information)f(about)g(the)h(state)g(of)g(the)g Fm(X)o(Ob)r(j)p
Fs(.)71 2006 y Fm(b)q(o)q(ol)f Fl(xPrin)n(tX)n(Ob)s(j)j Fs(\()e
Fm(X)o(Ob)r(j)h Fs(\))0 2130 y Fn(2.5)50 b(Usage)13 b(Rules)0
2217 y Fs(This)f(section)h(has)g(some)g(protocol)f(design)g(rules)h(that)g
(protocol)f(writers)g(should)g(follow)g(in)h(order)g(to)g(develop)f
(\252well-)0 2273 y(behaved\272)f(protocols)f(that)g(interact)h(properly)f
(with)g(other)h(protocols)f(with)g(which)g(they)h(might)f(be)i(composed.)952
2753 y(18)p eop
%%Page: 19 19
18 bop 0 124 a Fo(2.5.1)45 b(Initializing)10 b(a)h(Pr)o(otocol)0
211 y Fs(At)j(system)h(boot)f(time,)i(the)e Fr(x)p Fs(-kernel)i(calls)e
(xCreateProtocol)g(for)i(each)f(protocol)e(con\256gured)i(into)f(the)g
(kernel)h(\(see)0 268 y(section)9 b(13\).)16 b(xCreateProtocol,)10
b(in)g(turn,)g(calls)g(the)g(protocol')m(s)f(init)g(routine,)g(where)i(for)f
(a)g(protocol)f(named)i(`yap',)f(this)0 324 y(initialization)e(routine)i
(must)h(be)g(named)h(`yap)p 752 324 14 2 v 16 w(init'.)k(Generally)m(,)11
b(this)f(routine)g(does)g(the)h(following)e(work.)0 430 y Fg(void)0
487 y(yap_init\(self)q(\))109 543 y(XObj)28 b(self;)0 600 y({)109
656 y(/*)g(fill)g(in)g(protocol-spec)q(ific)j(operations)f(*/)109
713 y(self->open)g(=)e(yap_open;)109 769 y(self->demux)i(=)e(yap_demux;)109
826 y(.)g(.)f(.)109 939 y(/*)h(create)h(and)f(initialize)i(protocol-speci)q
(fic)h(state,)e(including)g(maps)g(*/)109 995 y(self->state)h(=)e(xMalloc\()h
(sizeof\(struc)q(t)h(yap_state\))g(\);)109 1051 y(.)e(.)f(.)109
1164 y(/*)h(get)g(handle)h(for,)f(and)g(register)i(with,)e(lower-level)j
(protocol)e(*/)109 1221 y(llp)f(=)g(xGetDown\(self,)j(0\)\);)109
1277 y(partInit\(&par)q(t,)f(1\);)109 1334 y(partPush\(part)q(,)g(ANY_HOST,)g
(0\);)109 1390 y(xOpenEnable\(s)q(elf,)h(self,)e(llp,)f(&part\);)0
1447 y(})0 1569 y Fo(2.5.2)45 b(hlpRcv)12 b(and)f(hlpT)m(ype)0
1656 y Fs(The)f(operations)e Fr(xOpen)p Fs(,)i Fr(xOpenEnable)p
Fs(,)f(and)h Fr(xOpenDisable)e Fs(take)i(two)f(high-level)f(protocols,)h
Fr(hlpRcv)g Fs(and)h Fr(hlpT)m(ype)p Fs(.)0 1713 y Fr(hlpRcv)g
Fs(is)g(the)h(protocol)e(to)h(which)g(the)g(new)h(lower)f(session)f(should)h
(route)g(incoming)f(messages.)17 b(The)10 b(lower)g(protocol)0
1769 y(uses)15 b Fr(hlpRcv)h Fs(as)g(the)g(hlp)f(ar)o(gument)h(to)g
Fr(xCr)n(eateSessn)p Fs(.)30 b(The)16 b(lower)g(protocol)f(uses)g
Fr(hlpT)m(ype)g Fs(to)h(determine)g(which)0 1826 y(messages)g(the)f(new)h
(session)f(should)f(handle.)30 b(For)16 b(example,)i(when)d
Fr(ethOpen)h Fs(is)f(called)h(with)e(IP)j(as)f(the)g Fr(hlpT)m(ype)p
Fs(,)0 1882 y(ETH)c(knows)g(that)f(the)i(new)f(session)f(will)h(deal)g(with)g
(packets)g(that)g(have)g(the)g(IP)i(ethernet)e(type.)20 b(The)12
b(lower)h(protocol)0 1939 y(typically)c(determines)i(the)f(number)h(that)g
(corresponds)f(to)g Fr(hlpT)m(ype)g Fs(by)h(using)e(it)i(in)f(a)i(call)e(to)h
Fr(r)n(elPr)n(otNum)f Fs(\(see)h(section)0 1995 y(12.\))71
2051 y(Most)e(protocols)f(use)i(their)f Fr(self)g Fs(pointer)g(as)h(both)e
Fr(hlpRcv)h Fs(and)h Fr(hlpT)m(ype)f Fs(when)h(making)f(these)g(calls,)h
(though)e(virtual)0 2108 y(protocols)i(\(see)h(below\))g(are)h(the)e
(exception.)0 2231 y Fo(2.5.3)45 b(Pr)o(otocol)11 b(Realms)0
2318 y Fs(Although)h(the)i Fr(x)p Fs(-kernel)g(de\256nes)g(a)g(single)f
(interface)h(for)g(all)g(protocols,)f(not)h(all)f(protocols)g(are)h(created)h
(equal.)24 b(Our)0 2374 y(experience)13 b(is)f(that)h(protocols)e(can)i(be)g
(classi\256ed)f(into)g(dif)o(ferent)h(categories,)g(which)f(we)h(call)g
(realms.)22 b(Chances)13 b(are,)0 2430 y(any)f(protocol)e(you)h(write)g
(falls)h(into)e(one)i(of)g(the)f(following)f(realms.)19 b(In)11
b(some)h(cases,)h(the)e(realm)i(a)f(protocol)e(falls)h(into)0
2487 y(both)h(de\256nes)h(a)h(restricted)e(subset)g(of)h(the)g(interface)g
(that)g(the)g(protocol)f(implements,)h(and)g(the)g(set)g(of)g(protocols)e
(with)0 2543 y(which)f(it)h(may)h(be)f(composed.)952 2753 y(19)p
eop
%%Page: 20 20
19 bop 0 124 a Fo(Asynchr)o(onous)11 b(Pr)o(otocols)0 193 y
Fs(Most)20 b(protocols\320e.g.,)i(protocols)c(like)i(IP)-5
b(,)21 b(TCP)-5 b(,)21 b(and)f(UDP\320fall)g(in)g(this)e(category)m(.)44
b(The)19 b Fr(x)p Fs(-kernel)i(supports)0 249 y(asynchronous)12
b(protocols)f(through)h(the)h(use)g(of)h Fr(xPush)p Fs(,)f
Fr(xPop)g Fs(and)h Fr(xDemux)f Fs(operations.)22 b(Asynchronous)11
b(protocols)0 305 y(are)21 b(typically)d(symmetric)i(in)g(the)g(sense)f(that)
h(the)g(protocol')m(s)f(sessions)f(process)h(both)h(incoming)e(and)i
(outgoing)0 362 y(messages.)c(While)9 b(it)h(seems)g(possible)e(for)i
(asynchronous)f(protocols)f(to)i(have)g(asymmetric)g(sessions)e(\(a)i(given)g
(session)0 418 y(can)j(handle)f(only)f(incoming)g(or)i(outgoing)d(messages,)j
(but)f(not)g(both\),)g(we)g(have)h(thus)e(far)i(been)g(able)f(to)g(make)h
(all)f(our)0 475 y(asynchronous)7 b(protocols)g(be)i(symmetric,)h(and)f(we)g
(strongly)e(encourage)h(such)h(designs.)14 b(Knowing)7 b(that)i(any)f
(low-level)0 531 y(protocols)h(you)h(may)h(use)g(are)g(symmetric)g(enhances)f
(our)g(ability)f(to)i(compose)f(protocols)f(and)h(makes)h(implementing)f(a)0
588 y(given)g(protocol)g(much)i(easier)m(.)0 710 y Fo(Synchr)o(onous)g(Pr)o
(otocols)0 778 y Fs(These)17 b(are)h(RPC)h(protocols.)34 b(They)17
b(are)h(typically)e(asymmetric)h(in)g(the)h(sense)f(that)g(client-side)f
(sessions)f(and)i(the)0 835 y(server)o(-side)c(sessions)e(are)i(quite)f(dif)o
(ferent.)22 b(The)13 b Fr(x)p Fs(-kernel)g(explicitly)e(supports)g
(synchronous/asymmetric)g(sessions)0 891 y(through)f(the)g(use)h(of)g
Fr(xCall)p Fs(,)g Fr(xCallPop)f Fs(and)h Fr(xCallDemux)p Fs(.)k(Since)d
(synchronous)c(protocols)i(are)h(asymmetric,)h Fr(xCall)f Fs(is)0
947 y(used)g(on)f(the)h(client)g(side)f(and)h Fr(xCallPop)f
Fs(and)h Fr(xCallDeumx)g Fs(are)h(used)f(on)f(the)h(server)h(side.)71
1004 y(Note)g(that)g(some)h(protocols)f(lie)g(on)h(the)f(boundary)g(between)h
(the)f(synchronous)f(and)i(asynchronous)e(realms.)22 b(For)0
1060 y(example,)10 b(a)g(protocol)f(that)f(implements)h(RPC)i(\(as)f(opposed)
e(to)h(one)g(that)g(uses)g(it\))g(probably)g(looks)f(asynchronous)g(from)0
1117 y(the)k(bottom)f(\(i.e.,)i(lower)e(level)h(protocols)e(call)i(its)f
Fr(xPop)g Fs(routine\),)h(but)f(synchronous)f(from)i(above)g(\(i.e.,)h
(higher)f(level)0 1173 y(protocols)e(call)h(its)f Fr(xCall)h
Fs(routine\).)0 1295 y Fo(Contr)o(ol)g(Pr)o(otocols)0 1364
y Fs(These)18 b(protocols)g(support)f(neither)h(a)h Fr(xPush/xPop)e
Fs(nor)i(a)g Fr(xCall/xCallPop)e Fs(interface.)39 b(T)m(ypically)m(,)19
b(only)f(control)0 1420 y(operations)10 b(may)h(be)h(performed)f(on)g(these)g
(protocols.)k(ARP)d(and)f(ICMP)h(fall)f(into)f(this)g(category)m(.)0
1542 y Fo(2.5.4)45 b(Anchor)12 b(Pr)o(otocols)0 1629 y Fs(Anchor)f(protocols)
e(sit)h(either)h(at)g(the)g(top)f(or)h(the)g(bottom)f(of)h(a)g(protocol)f
(stack)h(and)f(provide)g(an)i(interface)f(between)f(the)0 1686
y Fr(x)p Fs(-kernel)g(and)g(the)f(system)h(in)f(which)g(the)h
Fr(x)p Fs(-kernel)g(is)f(embedded.)16 b(T)m(op-level)9 b(anchor)h(protocols)e
(look)h(like)g(an)h Fr(x)p Fs(-kernel)0 1742 y(protocol)i(from)i(the)f
(bottom,)h(but)e(provide)h(an)g(Application)f(Programmer)i(Interface)h(to)e
(the)g Fr(x)p Fs(-kernel)h(\(see)f(appendix)0 1799 y(B.\))31
b(Bottom-level)15 b(anchor)h(protocols)e(\(e.g.,)k(device)e(drivers\))f(look)
g(like)g(a)i(protocol)d(from)j(the)e(top,)i(but)e(typically)0
1855 y(interface)c(with)g(the)f(lower)h(levels)g(of)g(the)g(surrounding)e
(system)i(or)g(with)f(network)g(hardware.)71 1911 y(W)n(riting)f(anchor)i
(protocols)f(involves)f(careful)i(synchronization)e(of)i(external)f(threads)h
(with)f Fr(x)p Fs(-kernel)h(threads)f(and)0 1968 y(objects.)16
b(See)c(section)e(7.5.3.)0 2090 y Fo(2.5.5)45 b(V)n(irtual)11
b(Pr)o(otocols)0 2177 y Fs(V)m(irtual)e(protocols)f(occupy)h(places)h(in)f
(the)g(protocol)g(\(and)g(sometimes)h(the)f(session\))g(graphs,)g(but)g(they)
g(neither)h(produce)0 2233 y(nor)f(interpret)g(network)g(headers.)16
b(They)9 b(typically)f(make)i(decisions)e(about)h(how)g(messages)h(should)e
(be)i(routed)f(through)0 2290 y(the)i(session)f(graph)g(based)h(on)g
(participants)f(in)g Fr(xOpen)h Fs(or)h(on)e(properties)g(of)i(messages,)f
(such)g(as)g(size.)71 2346 y(The)g Fr(xOpen)p Fs(,)h Fr(xOpenEnable)p
Fs(,)f(and)g Fr(xOpenDisable)f Fs(routines)g(of)i(virtual)e(protocols)g(dif)o
(fer)i(from)g(those)f(of)h(conven-)0 2403 y(tional)g(protocols.)21
b(A)14 b(virtual)e(protocol')m(s)g(implementation)g(of)h Fr(xOpen)p
Fs(,)h(for)g(example,)g(will)e(usually)g(make)i(an)f Fr(xOpen)0
2459 y Fs(call)c(to)g(its)f(lower)h(protocols)e(using)h(the)h
Fr(hlpT)m(ype)f Fs(that)h(was)g(passed)f(into)g(the)h(virtual)f(protocol,)g
(but)h(using)f(its)g Fr(self)g Fs(pointer)0 2516 y(as)14 b
Fr(hlpRcv)p Fs(.)23 b(This)13 b(allows)f(arbitrary)i(chains)f(of)h(virtual)e
(protocols)g(to)h(insert)g(their)g(sessions)f(between)i(the)f(upper)g(and)0
2572 y(lower)j(conventional)e(sessions)h(while)g(still)g(passing)g(\252type)h
(information\272)f(from)i(the)f(upper)g(protocol)f(to)g(the)i(lower)0
2629 y(protocol.)952 2753 y(20)p eop
%%Page: 21 21
20 bop 71 124 a Fs(Note)7 b(that)h(virtual)f(protocols)f(can)j(be)f(either)g
(synchronous)e(\(support)h(the)h Fr(xCall)p Fs(/)p Fr(xCallPop)p
Fs(/)p Fr(xCallDemu)o(x)e Fs(interface\))0 181 y(or)11 b(asynchronous)f
(\(support)f(the)i Fr(xPush)p Fs(/)p Fr(xPop)p Fs(/)p Fr(xDemux)e
Fs(interface\).)0 302 y Fn(2.6)50 b(Default)11 b(Operations)0
389 y Fs(Since)e(many)g(protocols')e(UPI)i(operations)e(look)h(very)h
(similar)n(,)g(the)f Fr(x)p Fs(-kernel)h(provides)f(some)h(library)f
(operations)f(which)0 446 y(do)12 b(much)h(of)f(the)g(standard)g(work)g(of)g
(some)h(of)f(the)h(operations.)18 b(Many)13 b(protocols)e(can)i(call)f(these)
g(default)g(operations)0 502 y(and)f(greatly)g(simplify)e(their)i(own)g
(implementations)e(of)i(these)g(routines.)0 622 y Fo(2.6.1)45
b(defaultOpenEnable)0 709 y Fs(Binds)12 b Fr(key)i Fs(to)e(an)h(enable)g
(object)f(with)g Fr(hlpRcv)h Fs(and)f Fr(hlpT)m(ype)p Fs(.)22
b(If)13 b(a)g(previous)f(binding)f(exists)h(for)h(the)f(given)h(key)f(and)0
765 y Fr(hlp)p Fs(s,)g(the)h(reference)h(count)e(of)h(that)f(enable)g(object)
g(will)g(be)h(increased.)21 b Fr(defaultOpenEnabl)o(e)10 b
Fs(will)i(fail)h(if)f(a)h(previous)0 822 y(binding)c(exists)h(for)i(this)e
(key)h(that)f(does)h(not)f(match)i(the)f Fr(hlp)p Fs(s.)71
897 y Fm(xk)o(ern)p 173 897 13 2 v 15 w(return)p 300 897 V
16 w(t)h Fl(defaultOp)r(enEnable)d Fs(\()j Fm(Map)f Fh(m)p
Fs(,)h Fm(X)o(Ob)r(j)g Fh(hlpRcv)p Fs(,)g Fm(X)o(Ob)r(j)g Fh(hlpT)l(ype)p
Fs(,)f Fm(v)o(oid)f Fs(*)p Fh(key)g Fs(\))0 1017 y Fo(2.6.2)45
b(defaultOpenDisable)0 1104 y Fs(Undoes)12 b(the)i(ef)o(fect)g(of)f(a)h
(previous)e Fr(defaultOpenEnable.)20 b Fs(Returns)13 b(failure)g(if)h(no)f
(appropriate)g(enable)g(object)f(exists)0 1160 y(\(e.g.,)g(if)g(nothing)d
(exists)h(for)h(the)g(given)f(key)h(or)h(if)f(the)g Fr(hlp)p
Fs(s)f(don')o(t)g(match)i(the)f(saved)g(values)f(in)h(the)g(enable)g
(object.\))71 1236 y Fm(xk)o(ern)p 173 1236 V 15 w(return)p
300 1236 V 16 w(t)h Fl(defaultOp)r(enDisable)d Fs(\()j Fm(Map)f
Fh(m)p Fs(,)h Fm(X)o(Ob)r(j)f Fh(hlpRcv)p Fs(,)i Fm(X)o(Ob)r(j)f
Fh(hlpT)l(ype)p Fs(,)e Fm(v)o(oid)h Fs(*)p Fh(key)f Fs(\))0
1356 y Fo(2.6.3)45 b(defaultOpenDisableAll)0 1443 y Fs(Removes)12
b(all)f(enable)h(objects)e(bound)h(in)g Fr(map)g Fs(with)f
Fr(hlpRcv)p Fs(.)18 b(If)12 b Fr(f)f Fs(is)g(non-zero,)h(it)f(is)g(called)h
(with)e(the)i(\()p Fr(key)p Fs(,)h Fr(Enable)d Fs(*\))0 1499
y(pair)h(for)g(each)h Fr(Enable)e Fs(object)h(in)f(the)h(map)h(before)f(it)g
(is)g(removed.)71 1575 y Fm(xk)o(ern)p 173 1575 V 15 w(return)p
300 1575 V 16 w(t)h Fl(defaultOp)r(enDisableAll)d Fs(\()i Fm(Map)g
Fh(m)p Fs(,)h Fm(X)o(Ob)r(j)g Fh(hlpRcv)p Fs(,)g Fm(DisableAllF)m(unc)f
Fh(f)g Fs(\))71 1650 y Fm(t)o(yp)q(edef)j(v)o(oid)d Fs(\()p
Fl(*DisableAllF)-5 b(unc)10 b Fs(\))i(\()f Fm(v)o(oid)g Fs(*)p
Fh(key)p Fs(,)g Fm(Enable)g Fs(*)p Fh(e)g Fs(\))0 1770 y Fo(2.6.4)45
b(defaultV)n(irtualOpenEnable)0 1857 y Fs(Designed)16 b(to)g(be)h(used)g(by)f
(virtual)g(protocols.)32 b(In)17 b(addition)e(to)i(the)f(binding)f(performed)
j(by)e Fr(defaultOpenEnabl)o(e)p Fs(,)0 1913 y(an)f Fr(xOpenEnable)f
Fs(is)h(performed)h(on)f(each)h(lower)f(protocol)f(in)h(the)g
(null-terminated)f(array)i Fr(llp)f Fs(\(using)f(participants)0
1970 y Fr(p)p Fs(,)j(causing)d(the)h(lower)g(protocols)e(to)i(deliver)g
(packets)g(for)g Fr(hlpT)m(ype)g Fs(to)f(the)h(virtual)f(protocol)g
Fr(self)p Fs(.)29 b(If)15 b(any)g(of)h(these)0 2026 y Fr(xOpenEnable)p
Fs(s)9 b(fail,)j Fr(defaultV)m(irt)o(ual)o(OpenEn)o(able)c
Fs(backs)j(out)f(of)i(the)f(entire)f(operation.)71 2083 y(Assumes)g(that)h
(the)g(passive)f(map)h(is)g(keyed)g(on)g Fr(hlpT)m(ype)p Fs(.)71
2187 y Fm(xk)o(ern)p 173 2187 V 15 w(return)p 300 2187 V 16
w(t)h Fl(defaultVirtualOp)r(enEnable)d Fs(\()i Fm(X)o(Ob)r(j)h
Fh(self)p Fs(,)g Fm(Map)f Fh(m)p Fs(,)h Fm(X)o(Ob)r(j)g Fh(hlpRcv)p
Fs(,)g Fm(X)o(Ob)r(j)g Fh(hlpT)l(ype)p Fs(,)1024 2244 y Fm(X)o(Ob)r(j)g
Fs(*)p Fh(llp)p Fs(,)h Fm(P)o(art)e Fs(*)p Fh(p)g Fs(\))0 2363
y Fo(2.6.5)45 b(defaultV)n(irtualOpenDisable)0 2450 y Fs(Undoes)10
b(the)h(ef)o(fect)h(of)f(a)h(previous)e Fr(defaultV)m(irt)o(ualO)o(penEn)o
(able)p Fs(.)71 2555 y Fm(xk)o(ern)p 173 2555 V 15 w(return)p
300 2555 V 16 w(t)i Fl(defaultVirtualOp)r(enDisable)d Fs(\()i
Fm(X)o(Ob)r(j)h Fh(self)p Fs(,)g Fm(Map)f Fh(m)p Fs(,)h Fm(X)o(Ob)r(j)f
Fh(hlpRcv)p Fs(,)1037 2612 y Fm(X)o(Ob)r(j)h Fh(hlpT)l(ype)p
Fs(,)f Fm(X)o(Ob)r(j)g Fs(*)p Fh(llp)p Fs(,)i Fm(P)o(art)e
Fs(*)p Fh(p)g Fs(\))952 2753 y(21)p eop
%%Page: 22 22
21 bop 0 124 a Fo(2.6.6)45 b(Usage)0 211 y Fs(Here)12 b(is)e(an)i(example)f
(of)g(how)g(a)g(protocol)f(might)h(simplify)f(its)g Fr(enable)p
Fs(/)p Fr(disable)e Fs(routines)i(using)g(these)h(operations:)0
374 y Fg(static)29 b(xkern_return_t)0 430 y(yapOpenEnable)q(\()h(XObj)e
(self,)h(XObj)f(hlpRcv,)i(XObj)e(hlpType,)h(Part)g(*p)f(\))0
487 y({)109 543 y(long)110 b(key;)109 600 y(PState)56 b(*ps)28
b(=)g(self->state;)109 713 y(key)g(=)g(getRelProtNum\()q(hlpT)q(ype,)j
(self\)\);)109 769 y(return)e(defaultOpenEn)q(able)q(\(ps-)q(>pa)q(ssiv)q
(e_ma)q(p,)i(hlpRcv,)e(hlpType,)g(&key\);)0 826 y(})0 939 y(static)g
(xkern_return_t)0 995 y(yapOpenDisabl)q(e\()h(XObj)f(self,)f(XObj)h(hlpRcv,)g
(XObj)f(hlpType,)i(Part)e(*p)g(\))0 1051 y({)109 1108 y(long)110
b(key;)109 1164 y(PState)56 b(*ps)28 b(=)g(self->state;)109
1277 y(key)g(=)g(getRelProtNum\()q(hlpT)q(ype,)j(self\)\);)109
1334 y(return)e(defaultOpenDi)q(sabl)q(e\(ps)q(->p)q(assi)q(ve_m)q(ap,)i
(hlpRcv,)e(hlpType,)g(&key\);)0 1390 y(})0 1503 y(static)g(xkern_return_t)0
1560 y(yapOpenDisabl)q(eAll)q(\()h(XObj)f(self,)f(XObj)h(hlpRcv)f(\))0
1616 y({)109 1672 y(PState)56 b(*ps)28 b(=)g(self->state;)109
1785 y(return)h(defaultOpenDi)q(sabl)q(eAll)q(\(ps)q(->pa)q(ssiv)q(e_m)q(ap,)
i(hlpRcv,)e(0\);)0 1842 y(})952 2753 y Fs(22)p eop
%%Page: 23 23
22 bop 0 124 a Ft(3)60 b(Participant)13 b(Library)0 228 y Fs(Participant)k
(lists)f(identify)g(members)i(of)g(a)g(session)e(and)i(are)g(used)f(for)h
(opening)e(connections.)34 b(Upper)18 b(protocols)0 284 y(interested)11
b(in)g(establishing)e(a)k(connection)d(will)h(construct)g(the)g(participant)g
(list)g(and)g(pass)h(it)f(to)g(the)h(lower)g(protocol)e(as)0
340 y(a)j(parameter)h(of)f(an)h(open)e(routine.)21 b(The)13
b(lower)g(protocol)f(will)g(then)g(extract)h(information)f(from)i(the)e
(participant)g(list,)0 397 y(possibly)d(passing)h(the)h(participant)e(list)h
(on)h(to)g(its)f(own)h(lower)g(protocol.)71 453 y(Each)h(participant)g(in)g
(the)g(list)g(contains)f(a)i(participant)f(address)g(stack,)h(designed)f(to)g
(facilitate)g(a)h(general)g(method)0 510 y(of)f(communicating)f(encapsulated)
g(address)g(information)g(between)g(protocol)g(layers.)18 b(By)12
b(using)f(pointers)f(to)i(address)0 566 y(information,)h(one)h(layer)f(can)h
(pass)f(address)g(information)g(through)f(a)i(lower)f(layer)g(without)f
(having)h(the)g(lower)g(layer)0 623 y(manipulate)c(the)g(address)g
(information)f(at)i(all,)g(not)f(even)g(by)g(copying.)15 b(The)9
b(address)h(information)e(for)i(each)g(participant)0 679 y(is)18
b(kept)g(as)g(a)h(stack)f(of)h Fr(void)f(*)g Fs(pointers)f(to)h(address)g
(components)g(and)g(the)g(lengths)f(of)i(each)g(component.)37
b(The)0 736 y(component)10 b(pointers)g(are)i(pushed)e(or)h(popped)g(onto)f
(the)h(stack)f(by)h(utility)e(functions.)0 860 y Fn(3.1)50
b(T)l(ype)13 b(De\256nitions)0 947 y Fs(The)7 b(participant)g(data)g
(structure)g(is)g(used)g(to)g(collect)g(addressing)f(information)g(for)i
(opening)e(connections.)14 b(A)8 b(participant)0 1003 y(list)k(is)h
(de\256ned)g(to)g(be)h(an)f(array)h(of)f(type)g Fr(Part)p Fs(,)h(and)f(a)g
Fr(PartStack)f Fs(is)h(the)g(main)h(\256eld)f(in)g(a)h(single)e
Fr(Part)p Fs(.)22 b(The)13 b(\256elds)g(of)0 1060 y(these)e(structures)f
(should)f(not)i(be)g(directly)f(accessed)i(by)f(the)f(protocol)g(developer)m
(.)102 1166 y(#de\256ne)196 b(P)l(AR)m(T)p 544 1166 14 2 v
16 w(MAX)p 666 1166 V 17 w(ST)l(ACK)73 b(20)102 1223 y Fm(t)o(yp)q(edef)15
b(struct)e Fk(f)205 1279 y Fs(struct)d Fk(f)284 1335 y Fm(v)o(oid)j(*)37
b Fs(ptr;)284 1392 y Fm(in)o(t)98 b Fs(len;)205 1448 y Fk(g)11
b Fh(arr)p Fs([P)l(AR)m(T)p 431 1448 V 16 w(MAX)p 553 1448
V 16 w(ST)l(ACK];)205 1505 y Fm(in)o(t)177 b Fh(top)p Fs(;)102
1561 y Fk(g)11 b Fl(P)n(artStac)n(k)p Fs(;)102 1674 y Fm(t)o(yp)q(edef)k
(struct)e Fk(f)205 1731 y Fm(in)o(t)177 b Fh(len)p Fs(;)205
1787 y Fm(P)o(artStac)o(k)48 b Fh(stack)p Fs(;)102 1844 y Fk(g)11
b Fl(P)n(art)p Fs(;)0 1968 y Fn(3.2)50 b(Participant)11 b(List)i(Operations)0
2055 y Fs(The)f(following)f(operations)g(provide)h(a)h(convenient)e
(interface)i(that)f(hides)g(the)g Fr(PartStack)f Fs(data)i(structure.)20
b(However)n(,)0 2111 y(the)11 b(fact)g(that)g(a)g(participant)f(list)g(is)h
(really)g(an)g(array)h(of)f(type)g Fr(Part)f Fs(is)g(visible)g(to)h(the)g
(programmer)m(.)0 2234 y Fo(3.2.1)45 b(partInit)0 2321 y Fs(Initialize)10
b(participant)g(list)g Fr(p)h Fs(of)g Fr(N)h Fs(participants.)71
2402 y Fm(v)o(oid)e Fl(partInit)p Fs(\()p Fm(P)o(art)k(*)p
Fh(p)p Fs(,)d Fm(in)o(t)g Fh(N)h Fs(\);)952 2753 y(23)p eop
%%Page: 24 24
23 bop 0 124 a Fo(3.2.2)45 b(partPush)0 211 y Fs(Push)11 b(address)g
Fr(addr)p Fs(,)h(pointing)d(to)i Fr(len)h Fs(bytes,)f(onto)g(the)g(stack)g
(of)h(participant)e Fr(p)p Fs(.)18 b(A)12 b(length)f(of)g(0)h(indicates)e(a)i
(\252special-)0 268 y(value\272)c(pointer)g(\(e.g.,)i(ANY)p
468 268 14 2 v 16 w(HOST\))e(whose)g(value)g(as)h(a)g(pointer)e(should)g(be)i
(preserved)f(across)h(protection)e(boundaries)0 324 y(\(and)k(not)g
(dereferenced.\))17 b(See)12 b(section)e(3.4)h(below)m(.)71
406 y Fm(v)o(oid)f Fl(partPush)i Fs(\()g Fm(P)o(art)25 b Fh(p)p
Fs(,)12 b Fm(v)o(oid)h(*)e Fh(addr)p Fs(,)h Fm(in)o(t)f Fh(len)p
Fs(\))0 553 y Fo(3.2.3)45 b(partPop)0 640 y Fs(Pop)11 b(an)g(address)g(of)o
(f)h(the)e(stack)h(of)g(participant)f Fr(p)p Fs(.)17 b(Returns)11
b(NULL)f(if)h(there)g(are)h(no)f(more)h(elements)f(on)g(the)g(stack.)71
721 y Fm(v)o(oid)i(*)e Fl(partP)n(op)p Fs(\()p Fm(P)o(art)k
Fh(p)c Fs(\))0 869 y Fo(3.2.4)45 b(partLen)0 956 y Fs(Report)11
b(the)g(number)g(of)g(participants)f(in)h(participant)e(list)h
Fr(p)p Fs(.)71 1037 y Fm(in)o(t)h Fl(partLen)p Fs(\()f Fm(P)o(art)15
b(*)c Fh(p)g Fs(\))0 1185 y Fo(3.2.5)45 b(partExternalize)0
1272 y Fs(T)m(akes)8 b(a)i(participant)d(list)h Fr(p)h Fs(and)f(externalizes)
g(it)h(into)f Fr(buf)g Fs(in)g(a)h(form)h(appropriate)e(for)h(transmission)e
(across)h(a)i(protection)0 1328 y(boundary)m(,)i(essentially)f(dereferencing)
i(all)f(the)g(pointers)g(except)g(special-value)g(pointers)f(pushed)h(with)f
(length)h(==)g(0.)0 1385 y(The)g Fr(int)g Fs(pointed)f(to)h(by)g
Fr(len)h Fs(holds)e(the)h(size)g(of)h(the)f(buf)o(fer)h(going)e(in)h(and)h
(holds)e(the)h(number)h(of)f(bytes)g(written)f(to)h(the)0 1441
y(buf)o(fer)g(on)e(return.)17 b(If)11 b(the)g(buf)o(fer)h(is)f(not)f(lar)o
(ge)h(enough,)g Fr(partExternalize)d Fs(will)i(fail.)71 1523
y Fm(xk)o(ern)p 173 1523 13 2 v 15 w(return)p 300 1523 V 16
w(t)i Fl(partExternalize)d Fs(\()i Fm(P)o(art)j(*)d Fh(pList)p
Fs(,)i Fm(v)o(oid)g(*)e Fh(buf)p Fs(,)g Fm(in)o(t)j(*)d Fh(len)h
Fs(\))0 1670 y Fo(3.2.6)45 b(partInternalize)0 1757 y Fs(T)m(akes)11
b(an)h(externalized)g(participant)e(buf)o(fer)i Fr(buf)f Fs(resulting)f(from)
j Fr(partExternalize)c Fs(and)i(recreates)i(the)f(participants)e(in)0
1814 y(the)h(uninitialized)e(participant)g(list)h Fr(p)p Fs(.)71
1895 y Fm(v)o(oid)g Fl(partIn)n(ternalize)g Fs(\()i Fm(P)o(art)i(*)d
Fh(p)p Fs(,)h Fm(v)o(oid)g(*)g Fh(buf)e Fs(\))0 2043 y Fo(3.2.7)45
b(partExtLen)0 2130 y Fs(Report)13 b(the)h(number)f(of)h(participants)d(in)i
(an)h(externalized)f(participant)f(buf)o(fer)h Fr(buf)g Fs(resulting)f(from)i
Fr(partExternaliz)o(e)p Fs(.)0 2186 y(This)c(can)i(be)f(useful)f(for)i
(allocating)d(the)i(appropriate)g(sized)f(participant)g(list)g(to)h(pass)f
(to)h Fr(partInternalize)p Fs(.)71 2267 y Fm(in)o(t)g Fl(partExtLen)p
Fs(\()f Fm(v)o(oid)j(*)e Fh(buf)f Fs(\))952 2753 y(24)p eop
%%Page: 25 25
24 bop 0 124 a Fn(3.3)50 b(Relative)12 b(Pr)o(otocol)g(Numbers)0
211 y Fs(Participant)h(lists)f(are)j(used)e(for)h(passing)e(addressing)g
(information)h(between)g(protocols.)23 b(An)13 b(additional)f(problem)i(is)0
268 y(how)g(a)g(high-level)f(protocol)f(identi\256es)h Fr(itself)g
Fs(to)h(a)g(low-level)f(protocol.)24 b(In)14 b(most)g(conventional)e
(protocols,)h(a)i(low-)0 324 y(level)10 b(protocol)f(uses)h(a)g
Fr(r)n(elative)g(pr)n(otocol)f(number)g Fs(to)h(identify)f(the)h(protocols)f
(above)h(it;)g(e.g.,)i(IP)f(identi\256es)e(UDP)h(with)0 381
y(protocol)g(number)h(17)g(and)g(TCP)g(as)g(protocol)f(number)h(6.)17
b(However)n(,)11 b(protocols)f(that)g(have)h(been)g(especially)f(designed)0
437 y(to)h(use)g(the)g Fr(x)p Fs(-kernel)g(use)g(an)g Fr(absolute)f
Fs(addressing)g(scheme.)71 494 y(V)-5 b(ersion)11 b(3.2)i(of)g(the)f
Fr(x)p Fs(-kernel)i(reconciles)e(these)g(two)g(approaches)h(by)f(maintaining)
f(a)i(table)f(of)h(relative)g(protocol)0 550 y(numbers.)j(\(See)c(Section)f
(12)f(for)i(the)e(format)i(of)f(this)e(table.\))17 b(Rather)11
b(than)g(embed)g(protocol)f(numbers)g(in)h(the)g(protocol)0
606 y(source)g(code,)i(protocols)d(learn)h(the)h(protocol)e(numbers)h(of)h
(protocols)e(above)h(them)h(by)f(querying)g(this)f(table)h(using)f(the)0
663 y(following)f(operation:)71 744 y Fm(long)h Fl(relProtNum)p
Fs(\()f Fm(X)o(Ob)r(j)j Fh(hlp)p Fs(,)g Fm(X)o(Ob)r(j)g Fh(llp)g
Fs(\))0 826 y(This)g(operation)g(returns)g(the)h(protocol)e(number)i(of)g
(the)g(high-level)e(protocol)h(relative)g(to)g(the)h(low-level)f(protocol,)g
(or)0 882 y(-1)h(if)f(no)h(such)f(binding)e(has)j(been)g(con\256gured)f(in)g
(the)g(protocol)g(tables.)20 b(This)12 b(number)g(will)g(have)g(to)h(be)f
(cast)h(into)e(the)0 939 y(appropriate)f(type;)h(e.g.,)h(an)f(unsigned)f
(short)g(by)h(the)g(ETH)f(protocol)g(and)h(an)h(unsigned)d(char)j(by)f(IP)-5
b(.)0 1063 y Fn(3.4)50 b(Usage)13 b(Rules)0 1150 y Fs(By)k(convention,)g
(active)f(participant)g(lists)f(have)i(the)f(remote)i(participant\(s\))d
(\256rst)i(followed)e(by)i(an)g(optional)e(local)0 1206 y(participant.)k(The)
12 b(local)g(participant)f(can)h(often)g(be)h(omitted,)f(in)g(which)f(case)i
(the)f(protocol)f(tries)h(to)g(use)g(a)h(reasonable)0 1263
y(default.)29 b(For)15 b(example,)i(a)f(UDP)f(participant)f(contains)g(a)i
(UDP)f(port)g(and)g(an)h(IP)g(host.)28 b(If)16 b(the)f(local)g(participant)f
(is)0 1319 y(missing)c(from)i(an)f(active)g(participant)e(list,)i(UDP)g
(selects)g(an)g(available)f(port)h(for)g(the)g(local)g(participant.)71
1376 y(In)k(some)h(cases,)h(it)e(is)g(necessary)h(to)f(specify)g(part)g(of)h
(the)f(information)g(in)g(a)h(participant,)g(but)e(it)h(is)h(convenient)0
1432 y(to)e(allow)f(the)h(lower)g(protocol)f(to)g(\252\256ll)h(in\272)g(the)g
(rest.)26 b(T)m(o)13 b(allow)h(this)f(\257exibility)m(,)g(one)h(can)h(use)e
(the)h(constant)f(pointer)0 1489 y(ANY)p 102 1489 14 2 v 16
w(HOST)d(to)h(specify)f(\252wildcard\272)g(hosts.)15 b(For)c(example,)g(if)g
(one)g(wants)e(to)i(open)f(UDP)h(with)e(a)i(speci\256c)g(local)f(port,)0
1545 y(but)i(does)f(not)h(care)h(which)e(local)h(host)g(number)g(is)g(used,)g
(one)g(could)g(construct)f(a)h(local)g(participant)f(with)g(the)h(speci\256c)
0 1601 y(local)e(port)g(but)f(with)h(the)g(pointer)f(ANY)p
650 1601 V 16 w(HOST)h(pushed)f(on)h(the)g(stack.)16 b(The)11
b(protocol)e(that)g(interprets)h(the)g(host)f(part)h(of)0 1658
y(the)h(participant)e(stack)i(could)f(then)h(choose)f(a)h(reasonable)g
(default.)16 b(Similarly)m(,)11 b(a)g(wildcard)f(value)h(ANY)p
1709 1658 V 16 w(POR)m(T)g(exists)0 1714 y(for)j(protocols)f(that)h(use)g
(ports)f(on)h(their)g(stacks.)25 b(Protocols)13 b(that)g(support)g(wildcards)
g(indicate)h(this)f(in)g(their)h(manual)0 1771 y(page.)71 1827
y(The)d(following)e(example)j(illustrates)d(how)i(a)h(protocol)e(that)h(is)f
(about)h(to)g(invoke)f Fr(xOpen)h Fs(on)g(a)h(low-level)f(protocol)0
1884 y(initializes)18 b(the)i(participant)f(list,)i(and)f(then)g(how)g(the)g
(low-level)f(protocol)f(extracts)i(that)g(information)f(from)h(the)0
1940 y(participant)10 b(list.)0 2046 y Fg({)109 2103 y(...)109
2159 y(/*)28 b(set)g(participant)i(addresses)g(before)f(calling)g(low-level)h
(protocol's)g(open)e(*/)109 2216 y(partInit\(p,)i(2\);)109
2272 y(partPush\(p[0])q(,)g(&ServerHostAd)q(dr,)h(sizeof\(IPhost\))q(\);)58
b(/*)28 b(remote)g(*/)109 2329 y(partPush\(p[0])q(,)i(&ServerPort,)h
(sizeof\(long\)\);)222 b(/*)28 b(remote)g(*/)109 2385 y(partPush\(p[1])q(,)i
(ANY_HOST,)g(0\);)601 b(/*)28 b(local)55 b(*/)109 2442 y(partPush\(p[1])q(,)
30 b(&ClientPort,)h(sizeof\(long\)\);)222 b(/*)28 b(local)55
b(*/)109 2498 y(xOpen\(self,)30 b(self,)f(llp,)f(p\);)109 2555
y(...)0 2611 y(})952 2753 y Fs(25)p eop
%%Page: 26 26
25 bop 0 237 a Fg(llpOpen\()29 b(XObj)g(self,)f(XObj)h(hlpRcv,)g(XObj)f
(hlpType,)i(Part)e(*p)g(\))0 294 y({)109 350 y(/*)g(get)g(participant)i
(addresses)g(within)f(low-level)h(protocol's)g(open)e(*/)109
407 y(remoteport)i(=)e(\(long)g(*\))g(partPop\(p[0]\))q(;)109
463 y(localport)i(=)d(\(long)i(*\))f(partPop\(p[1]\);)109 519
y(...)0 576 y(})71 682 y Fs(Notice)9 b(in)i(this)e(example)i(how)f(the)g
(high-level)f(protocol)g(pushes)h(two)g(items)g(\(a)h(host)f(address)g(and)g
(a)h(port)f(number\))0 739 y(onto)g(each)i(participant')m(s)e(address)g
(stack,)h(but)f(the)h(low-level)f(protocol)g(pops)g(only)g(one)h(item)g(of)o
(f.)17 b(This)10 b(is)g(because)h(the)0 795 y(low-level)h(protocol)h(does)g
(not)f(interpret)h(the)g(\256rst)h(item;)g(it)f(just)f(passes)h(it)g(on)g(to)
g Fr(its)g Fs(low-level)f(protocol.)22 b(Also)13 b(note)0 852
y(that)d(when)g(using)f(participants)g(that)h(have)g(been)g(passed)g(from)h
(other)f(protocols,)g(the)g(user)g(must)g(keep)h(in)f(mind)g(that)f(the)0
908 y(address)g(pointers)f(may)h(be)h(valid)e(only)g(for)i(the)f(duration)f
(of)h(the)g(current)g(subroutine.)14 b(Data)9 b(that)g(is)g(needed)g(beyond)f
(this)0 964 y(time)13 b(should)e(be)h(explicitly)f(copied)h(into)f(static)h
(storage.)20 b(In)13 b(addition,)f(because)g(the)h(participant)e(structure)h
(is)g(passed)0 1021 y(by)f(reference)h(in)f(the)g Fr(xOpen)g
Fs(call,)g(the)g(caller)g(should)f(consider)g(the)h(contents)f(invalid)g
(after)h(the)g(return.)952 2753 y(26)p eop
%%Page: 27 27
26 bop 0 124 a Ft(4)60 b(Message)14 b(Library)0 228 y Fs(The)k(message)g
(library)g(provides)f(a)h(set)g(of)g(ef)o(\256cient,)j(high-level)c
(operations)f(for)j(manipulating)d(messages.)37 b(The)0 284
y(underlying)16 b(data)i(structure)f(that)h(implements)f(messages)h(is)f
(optimized)g(for)i(fragmentation/reassembly)m(,)f(and)g(for)0
340 y(adding/strippin)o(g)d(headers.)38 b(Protocol)18 b(programmers)h(should)
d(manipulate)i(messages)g(only)f(with)h(the)g(operations)0
397 y(documented)11 b(here.)71 453 y(Future)e(releases)g(of)g(the)g(message)g
(library)g(will)f(accomodate)h(the)g(use)g(of)g(buf)o(fers)g(that)g(are)h
(owned)e(and)h(managed)h(by)0 510 y(dif)o(ferent)j(buf)o(fer)g(pools,)g
(including)e(device)i(memory)m(,)h(user)f(buf)o(fers,)h(simple)f(kernel)g
(buf)o(fers,)h(and)e(structured)g(kernel)0 566 y(buf)o(fers)f(such)g(as)g
(BSD)h Fr(mbufs)e Fs(and)h(System)g(V)g Fr(mblocks)p Fs(.)0
691 y Fn(4.1)50 b(T)l(ype)13 b(De\256nitions)0 778 y Fs(Loosely)i(speaking,)j
(V)-5 b(ersion)15 b(3.2)i(messages)g(include)e(two)h(main)h(components:)26
b(a)17 b Fr(stack)f Fs(that)g(holds)g(the)g(message)0 834 y(header)n(,)c(and)
f(pointer)f(\()p Fr(tr)n(ee)p Fs(\))i(to)f(a)g(tree)h(structure)e(of)h(buf)o
(fers)g(that)g(hold)f(the)h(data.)102 940 y Fm(t)o(yp)q(edef)k(struct)e
Fk(f)295 997 y Fm(c)o(har)185 b Fs(*headPtr;)295 1053 y Fm(c)o(har)g
Fs(*tailPtr;)295 1110 y Fm(c)o(har)g Fs(*stackHeadPtr;)295
1166 y Fm(c)o(har)g Fs(*stackT)m(ailPtr;)295 1223 y Fm(struct)13
b Fk(f)557 1279 y Fm(unsigned)h(short)19 b Fs(numNodes;)557
1335 y Fm(unsigned)14 b(in)o(t)61 b Fs(myStack;)295 1392 y
Fk(g)12 b Fs(state;)295 1448 y Fm(MNo)q(deLeaf)p Fs(*)29 b(stack;)295
1505 y Fm(MNo)q(de)p Fs(*)107 b(tree;)295 1561 y Fm(v)o(oid)p
Fs(*)162 b(attr;)295 1618 y Fm(MNo)q(deLeaf)p Fs(*)29 b(lastStack;)295
1674 y Fm(c)o(har)185 b Fs(*lastStackT)m(ailPtr;)295 1731 y
Fm(struct)13 b Fk(f)557 1787 y Fm(unsigned)h(in)o(t)61 b Fs(myLastStack;)295
1844 y Fk(g)12 b Fs(tailstate;)102 1900 y Fk(g)f Fl(Msg)h Fs(;)0
2024 y Fn(4.2)50 b(Constructor/Destructor)11 b(Operations)0
2111 y Fs(These)h(operations)f(are)i(used)f(to)f(create)i(and)f(destroy)g
(messages.)19 b(Many)13 b(of)f(them)h(are,)g(for)g(example,)g(used)e(by)h
(device)0 2168 y(drivers)f(and)g(system)f(call)h(code)g(that)g(has)g(to)g
(incorporate)f(a)i(data)f(buf)o(fer)g(into)f(an)i Fr(x)p Fs(-kernel)f
(message.)0 2290 y Fo(4.2.1)45 b(msgConstructEmpty)0 2377 y
Fs(A)14 b(message)g(structure)f(is)g(initialized)f(with)h(a)h(data)g(length)f
(set)g(to)h(zero.)25 b(The)13 b(user)h(must)g(provide)f(a)h(pointer)f(to)g
(valid)0 2434 y(memory)m(.)71 2515 y Fm(v)o(oid)d Fl(msgConstructEmpt)n(y)f
Fs(\()p Fm(Msg*)i Fh(this)p Fs(\);)952 2753 y(27)p eop
%%Page: 28 28
27 bop 0 124 a Fo(4.2.2)45 b(msgConstructBuffer)0 211 y Fs(Copies)8
b(data)g(from)h(a)g(user)f(buf)o(fer)h(into)e(an)h(uninitialized)e(message)j
(structure.)15 b(The)8 b(message)g(data)h(area)g(is)f(allocated)f(and)0
268 y(a)i(copy)g(is)f(performed.)16 b(This)8 b(constructor)f(is)i(used)f
(when)h(the)f(data)h(buf)o(fer)g(already)g(exists.)14 b(Use)9
b Fr(msgConstructAllo)o(cate)0 324 y Fs(when)i(you)f(have)i(the)e
(opportunity)f(to)i(\256ll)g(the)f(buf)o(fer)i(after)g(it)e(has)h(been)g
(created.)71 406 y Fm(v)o(oid)f Fl(msgConstructBu\013er)g Fs(\()p
Fm(Msg*)h Fh(this)p Fs(,)i Fm(c)o(har)e Fs(*)p Fh(buf)p Fs(,)g
Fm(long)f Fh(len)p Fs(\);)0 528 y Fo(4.2.3)45 b(msgConstructAllocate)0
615 y Fs(A)11 b(data)g(area)g(of)g(size)g Fr(len)g Fs(is)f(allocated)g(and)h
(associated)f(with)g(the)g(uninitialized)e(message)k(structure)e
Fr(this)p Fs(.)15 b(A)c(pointer)f(to)0 672 y(the)j(data)g(area)h(is)f
(returned)g(in)g Fr(buf)p Fs(.)22 b(A)13 b(device)g(driver)g(might)f(use)h
(this)f(constructor)n(,)h(handing)f Fr(buf)h Fs(to)g(the)f(device)i(as)f(a)0
728 y(place)e(to)g(put)f(down)h(an)g(incoming)f(packet.)71
809 y Fm(v)o(oid)g Fl(msgConstructAllo)r(cate)f Fs(\()p Fm(Msg*)i
Fh(this)p Fs(,)i Fm(long)d Fh(len)p Fs(,)j Fm(c)o(har)e Fs(**)p
Fh(buf)p Fs(\);)0 957 y Fo(4.2.4)45 b(msgConstructCopy)0 1044
y Fs(The)13 b(uninitialized)d(message)k Fr(this)e Fs(will)g(refer)i(to)e(the)
h(same)h(data)f(as)g(the)f(message)i Fr(another)p Fs(.)20 b(No)13
b(data)g(is)g(copied.)21 b(See)0 1100 y(also)11 b Fr(msgAssign)p
Fs(.)71 1182 y Fm(v)o(oid)f Fl(msgConstructCop)n(y)h Fs(\()p
Fm(Msg*)h Fh(this)p Fs(,)g Fm(Msg)g Fs(*)p Fh(another)p Fs(\);)0
1304 y Fo(4.2.5)45 b(msgAssign)0 1391 y Fs(The)12 b(assignment)g(of)g(one)g
(message)h Fr(m)g Fs(to)f(message)g Fr(this)g Fs(means)g(that)g(message)h
Fr(this)e Fs(will)h(refer)h(to)f(the)g(same)h(data)g(that)0
1448 y(as)d(message)h Fr(m)f Fs(currently)g(does.)16 b(No)10
b(data)g(copying)f(is)h(involved.)k(This)c(is)g(equivalent)e(to)i(doing)f(a)i
Fr(msgDestr)n(oy)e Fs(to)h Fr(this)p Fs(,)0 1504 y(followed)j(by)i(a)g
Fr(msgConstructCopy)p Fs(.)24 b(Therefore,)17 b(this)c(function)g(should)h
(be)g(used)g(only)g(when)g(both)g(messages)g(are)0 1561 y(valid.)i(Copying)10
b(to)g(an)i(uninitialized)c(structure)j(should)e(be)j(done)e(with)g
(msgConstructCopy)m(.)71 1642 y Fm(v)o(oid)g Fl(msgAssign)g
Fs(\()p Fm(Msg*)i Fh(this)p Fs(,)g Fm(Msg*)g Fh(m)p Fs(\);)0
1790 y Fo(4.2.6)45 b(msgConstructInplace)0 1877 y Fs(The)16
b(uninitialized)e(message)i Fr(this)f Fs(is)h(constructed)f(with)g(a)h
(direct)g(reference)i(to)d(the)h(buf)o(fer)h(speci\256ed.)31
b(A)16 b(function)0 1933 y(appropriate)7 b(for)h(freeing)f(the)g(buf)o(fer)i
(when)e(the)g(message)h(is)f(destroyed)g(must)g(be)g(provided.)15
b(The)7 b Fr(msgConstructInplace)0 1990 y Fs(function)k(is)g(recommended)i
(only)e(for)h(limited)f(use)h(\(e.g.)20 b(within)10 b(device)i(drivers\);)g
(it)f(might)h(not)f(be)h(compatible)f(with)0 2046 y(later)g(implementations)f
(of)h(the)g(message)g(library)g(that)f(will)g(provide)g(highly)g(ef)o
(\256cient)h(buf)o(fer)h(management.)71 2127 y Fm(v)o(oid)e
Fl(msgConstructInplace)g Fs(\()p Fm(Msg*)h Fh(this)p Fs(,)i
Fm(c)o(har)f Fs(**)p Fh(buf)o(fer)p Fs(,)d Fm(long)i Fh(length)p
Fs(,)h Fm(Pfv)f Fh(fr)o(eefunc)p Fs(\);)0 2250 y Fo(4.2.7)45
b(msgConstructAppend)0 2337 y Fs(The)13 b(uninitialized)e(message)j
Fr(this)e Fs(is)h(initialized)f(to)h(prepare)h(for)g(appending)e(data)h(with)
g Fr(msgAppend)p Fs(.)22 b(The)13 b(message)0 2394 y(can)e(be)h(used)e(in)h
(any)g(message)g(operation,)g(but)f Fr(msgPush)g Fs(will)g(cause)h
(additional)e(space)j(to)e(be)i(allocated.)71 2475 y Fm(v)o(oid)e
Fl(msgConstructApp)r(end)g Fs(\()p Fm(Msg*)i Fh(this)p Fs(,)g
Fm(c)o(har)g Fs(**)p Fh(buf)o(fer)p Fs(,)e Fm(long)g Fh(length)p
Fs(\))952 2753 y(28)p eop
%%Page: 29 29
28 bop 0 124 a Fo(4.2.8)45 b(msgDestr)o(oy)0 211 y Fs(Logically)10
b(frees)i(message)g Fr(this)p Fs(.)k(Data)11 b(portions)f(of)i(the)f(message)
h(deallocated)e(are)i(freed)h(as)e(a)h(result)f(of)g(this)g(function)0
268 y(should)f(there)h(be)g(no)g(other)g(outstanding)d(references)k(to)f
(them.)71 349 y Fm(v)o(oid)f Fl(msgDestro)n(y)g Fs(\()p Fm(Msg*)h
Fh(this)p Fs(\);)0 473 y Fn(4.3)50 b(Manipulation)10 b(Operations)0
560 y Fs(Protocols)i(manipulate)h(messages\320e.g.,)j(add)d(and)g(strip)g
(headers,)i(fragment)e(and)h(reassemble)f(packets\320using)f(the)0
617 y(following)d(set)i(of)g(operations.)0 739 y Fo(4.3.1)45
b(msgLen)0 826 y Fs(Returns)11 b(the)g(number)g(of)g(bytes)f(of)i(data)f(in)f
(message)i Fr(this)p Fs(.)71 908 y Fm(long)e Fl(msgLen)g Fs(\()p
Fm(Msg)h Fs(*)p Fh(this)p Fs(\);)0 1055 y Fo(4.3.2)45 b(msgT)m(runcate)0
1142 y Fs(T)n(runcate)12 b(the)f(data)h(in)f(the)g(message)h
Fr(this)f Fs(to)g(the)h(given)e(length.)17 b(Attempts)11 b(to)g(to)g(reduce)h
(the)g(length)e(to)i(less)f(than)g(zero)0 1199 y(will)f(result)h(in)g(no)g
(change)g(to)g(the)g(message.)18 b(No)11 b(storage)g(is)g(freed)h(as)f(a)h
(result)f(of)g(truncation.)16 b(This)10 b(operation)h(is)g(used)0
1255 y(to)g(strip)f(trailers)g(from)i(a)g(message.)71 1337
y Fm(v)o(oid)e Fl(msgT)-5 b(runcate)10 b Fs(\()p Fm(Msg*)i
Fh(this)p Fs(,)g Fm(long)f Fh(newLength)p Fs(\);)0 1484 y Fo(4.3.3)45
b(msgChopOff)0 1571 y Fs(Remove)12 b(data)g(from)g(the)g(message)f
Fr(this)g Fs(and)g(assign)g(it)g(to)g(the)h(message)g Fr(head)p
Fs(.)17 b(No)12 b(copying)e(is)h(done.)18 b(This)10 b(operation)0
1628 y(is)h(used)f(to)h(fragment)h(a)f(message)g(into)g(smaller)g(pieces.)16
b(Both)11 b(messages)g(must)g(be)g(valid)f(at)h(the)g(time)g(of)h(the)f
(call.)71 1709 y Fr(3.1)g(Compatibility)d(notes)p Fs(:)15 b(The)c(3.1)g
(version)g(of)g(this)f(was)h Fr(msg)p 1106 1709 14 2 v 15 w(br)n(eak)p
Fs(,)h(but)e(the)h(ar)o(guments)g(were)h(reversed.)71 1790
y Fm(v)o(oid)e Fl(msgChopO\013)h Fs(\()p Fm(Msg*)g Fh(this)p
Fs(,)i Fm(Msg*)e Fh(head)p Fs(,)h Fm(long)e Fh(len)p Fs(\);)0
1938 y Fo(4.3.4)45 b(msgJoin)0 2025 y Fs(Assign)11 b(\(in)i(the)f(same)i
(sense)e(as)h Fr(msgAssign)p Fs(\))d(to)j Fr(this)e Fs(message)i(the)g
(concatenation)e(of)i(messages)g Fr(m1)f Fs(to)g(the)h(front)f(of)0
2081 y Fr(m2)p Fs(.)26 b(This)14 b(operation)f(is)h(used)g(to)g(reassemble)h
(fragments)f(into)g(a)g(lar)o(ger)h(message.)27 b(The)14 b(\256rst)h(ar)o
(gument)f(must)g(be)h(a)0 2138 y(valid)10 b(message.)17 b(The)11
b(ar)o(guments)g(need)g(not)g(refer)h(to)e(distinct)g(messages.)71
2219 y Fm(v)o(oid)g Fl(msgJoin)g Fs(\()p Fm(Msg*)h Fh(this)p
Fs(,)i Fm(Msg*)e Fh(m1)p Fs(,)h Fm(Msg*)f Fh(m2)p Fs(\);)71
2301 y(Example)g(of)g(using)f(non-unique)f(ar)o(guments:)16
b Fl(msgJoin)9 b Fs(\()p Fh(this)p Fs(,)k Fh(this)p Fs(,)g
Fh(MessageT)-5 b(ail)p Fs(\);)952 2753 y(29)p eop
%%Page: 30 30
29 bop 0 124 a Fo(4.3.5)45 b(msgPush)0 211 y Fs(Prepend)12
b(data)f(pointed)f(to)h(by)g Fr(hdr)g Fs(to)g(the)h(front)f(of)g(message)h
Fr(this)p Fs(.)17 b(The)11 b(supplied)f(function)g Fr(stor)n(e)h
Fs(will)f(be)i(called)f(with)0 268 y(the)i Fr(hdr)g Fs(pointer)n(,)h(a)f
(pointer)g(to)g(the)g(message)h(data)f(area)h(where)g(the)f(header)h(data)f
(can)h(be)g(copied,)f(the)h Fr(hdrLen)f Fs(value)0 324 y(indicating)e(the)h
(length)g(of)h(the)f(data,)i(and)f(the)f Fr(ar)n(g)h Fs(pointer)m(.)21
b(The)12 b(last)h(ar)o(gument)f(is)h(not)f(interpreted)g(by)g(the)h
Fr(msgPush)0 381 y Fs(function;)c(its)i(semantics)f(are)i(determined)f
(entirely)f(by)h(the)g(user)g(store)g(function.)71 462 y Fm(v)o(oid)f
Fl(msgPush)h Fs(\()p Fm(Msg*)g Fh(this)p Fs(,)i Fm(MStoreF)m(un)f
Fh(stor)o(e)p Fs(,)g Fm(v)o(oid)e Fs(*)p Fh(hdr)p Fs(,)i Fm(long)e
Fh(hdrLen)p Fs(,)i Fm(v)o(oid)f Fs(*)p Fh(ar)o(g)p Fs(\);)71
543 y(Function)d Fr(stor)n(e)h Fs(typically)e(converts)i(the)g(header)h(to)f
(network)g(byte)f(order)i(and)f(stores)g(it)g(in)g(a)h(potentially)d
(unaligned)0 600 y(buf)o(fer;)j Fr(len)g Fs(is)f(the)g(number)h(of)f(bytes)g
(to)g(be)h(read)g(and)f Fr(ar)n(g)h Fs(is)f(an)g(arbitrary)h(ar)o(gument)f
(passed)g(through)f(from)j Fr(msgPush)p Fs(.)71 681 y Fm(t)o(yp)q(edef)j(v)o
(oid)d Fs(\()p Fl(*MStoreF)-5 b(un)12 b Fs(\)\()p Fm(v)o(oid)e
Fs(*)p Fh(hdr)p Fs(,)i Fm(c)o(har)g Fs(*)p Fh(des)p Fs(,)f
Fm(long)g Fh(len)p Fs(,)h Fm(v)o(oid)e Fs(*)p Fh(ar)o(g)p Fs(\);)71
763 y Fi(Example)j(Declaration:)18 b Fm(v)o(oid)11 b Fl(cop)n(ypush)p
Fs(\()p Fm(v)o(oid)g Fs(*)p Fh(sr)o(c)p Fs(,)g Fm(c)o(har)h
Fs(*)p Fh(dst)p Fs(,)g Fm(long)f Fh(count)p Fs(,)h Fm(v)o(oid)f
Fs(*)p Fh(type)p Fs(\)\))0 885 y Fo(4.3.6)45 b(msgPop)0 972
y Fs(Removes)10 b(data)g(from)h(the)f(front)f(of)i(message)f
Fr(this)p Fs(.)15 b(After)10 b(making)g(the)f(requested)h(data)g(contiguous,)
e Fr(msgPop)h Fs(calls)g(the)0 1029 y(function)f Fr(load)g
Fs(with)g(the)g Fr(hdr)g Fs(ar)o(gument,)i(a)g(pointer)e(to)g(the)h(start)f
(of)h(the)g(contiguous)d(data,)k Fr(hdrLen)p Fs(,)f(and)g(the)g
Fr(ar)n(g)f Fs(pointer)m(.)0 1085 y(Function)i Fr(load)g Fs(should)f(return)h
(an)h(integer)g(representing)f(the)g(amount)h(data)f(that)h(should)e(be)i
(popped)f(of)o(f)h(the)g(message.)0 1142 y(In)k(optimized)g(code,)h(no)f
(validity)f(check)h(is)g(done)g(on)g(this)f(number)m(.)29 b(This)15
b(function)f(returns)g(TRUE)i(if)f(successful,)0 1198 y(F)m(ALSE)c(if)g(the)g
(message)g(is)g(shorter)g(than)f Fr(hdrLen)h Fs(bytes.)71 1279
y Fm(b)q(o)q(ol)f Fl(msgP)n(op)h Fs(\()p Fm(Msg*)h Fh(this)p
Fs(,)g Fm(MLoadF)m(un)f Fh(load)p Fs(,)i Fm(v)o(oid)d Fs(*)p
Fh(hdr)p Fs(,)i Fm(long)e Fh(hdrLen)p Fs(,)i Fm(v)o(oid)f Fs(*)p
Fh(ar)o(g)p Fs(\);)71 1361 y(Function)d Fr(load)g Fs(loads)h(the)g(header)h
(from)g(a)g(potentially)d(unaligned)h(buf)o(fer)i(and)f(converts)g(it)g(to)g
(machine)g(byte)g(order)m(.)0 1417 y(The)i Fr(len)f Fs(is)h(the)f(number)h
(of)g(bytes)f(guaranteed)h(contiguous)d(and)j Fr(ar)n(g)f Fs(is)h(an)g
(arbitrary)f(ar)o(gument)h(passed)f(through)g(from)0 1474 y
Fr(msgPop)p Fs(.)25 b(This)13 b(function)g(should)g(return)h(the)g(number)h
(of)f(bytes)g(to)g(be)g(actually)f(popped)h(from)h(the)f(message.)26
b(This)0 1530 y(information)10 b(is)h(used)f(by)h Fr(msgPop)f
Fs(to)h(update)f(the)h(internal)f(message)i(structure.)71 1611
y Fm(t)o(yp)q(edef)i(long)d Fs(\()p Fl(*MLoadF)-5 b(un)12 b
Fs(\)\()p Fm(v)o(oid)f Fs(*)p Fh(hdr)p Fs(,)g Fm(c)o(har)h
Fs(*)p Fh(sr)o(c)p Fs(,)g Fm(long)e Fh(len)p Fs(,)i Fm(v)o(oid)f
Fs(*)p Fh(ar)o(g)p Fs(\);)71 1693 y Fi(Example)i(declaration:)19
b Fm(long)10 b Fl(cop)n(yp)r(op)p Fs(\()i Fm(v)o(oid)e Fs(*)p
Fh(dst)p Fs(,)i Fm(c)o(har)g Fs(*)p Fh(sr)o(c)p Fs(,)f Fm(long)g
Fh(count)p Fs(,)h Fm(v)o(oid)f Fs(*)p Fh(type)p Fs(\)\))0 1815
y Fo(4.3.7)45 b(msgPopDiscard)0 1902 y Fs(Discards)10 b Fr(len)h
Fs(bytes)g(from)g(the)g(front)g(of)g(message)h Fr(this)p Fs(.)j(Returns)c
Fr(TRUE)g Fs(if)g(successful.)71 1984 y Fm(b)q(o)q(ol)f Fl(msgP)n(opDiscard)h
Fs(\()p Fm(Msg)h Fs(*)p Fh(this)p Fs(,)g Fm(long)f Fh(len)p
Fs(\))0 2131 y Fo(4.3.8)45 b(msgAppend)0 2218 y Fs(Append)9
b(data)g(pointed)g(to)g(by)g Fr(tail)g Fs(to)g(the)g(end)h(of)f(message)h
Fr(this)p Fs(.)15 b(The)10 b(supplied)e(function)g Fr(stor)n(e)h
Fs(will)g(be)g(called)h(with)e(the)0 2275 y Fr(tail)h Fs(pointer)n(,)i(a)g
(pointer)e(to)h(the)h(message)f(data)h(area)g(where)g(the)f(data)h(can)g(be)f
(copied,)h(the)f Fr(tailLen)g Fs(value)g(indicating)e(the)0
2331 y(length)j(in)g(bytes)g(fo)h(the)g(data,)g(and)g(the)g
Fr(ar)n(g)g Fs(pointer)m(.)18 b(If)12 b(it)g(is)f(necessary)h(to)f(allocate)h
(new)g(space)g(to)f(hold)g(the)h(data,)g(the)0 2388 y Fr(newlength)c
Fs(parameter)i(designates)e(the)g(minimum)h(amount)g(of)g(space)g(for)g(the)g
(allocation.)14 b(See)c Fr(msgConstructAppend)p Fs(,)0 2444
y(also.)71 2526 y Fm(v)o(oid)23 b Fl(msgApp)r(end)g Fs(\()p
Fm(Msg*)i Fh(this)p Fs(,)k Fm(MStoreF)m(un)c Fh(stor)o(e)p
Fs(,)j Fm(v)o(oid)23 b Fs(*)p Fh(tail)p Fs(,)29 b Fm(long)24
b Fh(tailLen)p Fs(,)29 b Fm(v)o(oid)24 b Fs(*)p Fh(ar)o(g)p
Fs(,)j Fm(long)0 2582 y Fh(newlength)p Fs(\);)952 2753 y(30)p
eop
%%Page: 31 31
30 bop 0 124 a Fo(4.3.9)45 b(msgSetAttr)0 211 y Fs(Associates)9
b(an)i Fr(attribute)e Fs(of)i Fr(len)f Fs(bytes)g(with)g Fr(name)g
Fs(and)h(attaches)f(it)g(to)h(message)f Fr(this)p Fs(.)16 b(Setting)10
b(an)g(attribute)g(overrides)0 268 y(any)g(previous)f(attribute)f(with)h(the)
h(same)h(name.)16 b(Message)11 b(attributes)d(are)j(used)e(to)h(communicate)g
(ancillary)f(properties)0 324 y(of)i(messages)g(from)h(a)g(protocol)d(to)i(a)
h(session,)e(or)h(between)g(protocols.)71 381 y(The)h(only)f(name)i
(supported)e(at)h(this)f(time)h(is)g Fr(0)p Fs(.)20 b(Attempting)11
b(to)g(set)h(an)h(attribute)e(with)g(another)h(name)h(will)e(result)0
437 y(in)g(an)g Fr(XK)p 162 437 14 2 v 16 w(F)-6 b(AILURE)11
b Fs(return)g(value.)71 518 y Fm(xk)o(ern)p 173 518 13 2 v
15 w(return)p 300 518 V 16 w(t)h Fl(msgSetA)n(ttr)e Fs(\()p
Fm(Msg)h Fs(*)p Fh(this)p Fs(,)i Fm(in)o(t)d Fh(name)p Fs(,)i
Fm(v)o(oid)e Fs(*)p Fh(attribute)p Fs(,)i Fm(in)o(t)f Fh(len)p
Fs(\);)0 666 y Fo(4.3.10)45 b(msgGetAttr)0 753 y Fs(Retrieves)15
b(an)f(attribute)g(previously)e(attached)j(to)f(message)h Fr(this)e
Fs(with)h Fr(name)p Fs(.)26 b(If)16 b(no)e(attribute)f(has)i(been)f
(associated)0 809 y(with)c Fr(name)p Fs(,)h Fr(0)g Fs(will)g(be)g(returned.)
71 891 y Fm(v)o(oid)i(*)e Fl(msgGetA)n(ttr)e Fs(\()p Fm(Msg)j
Fs(*)p Fh(this)p Fs(,)g Fm(in)o(t)f Fh(name)g Fs(\);)0 1013
y Fo(4.3.11)45 b(msgForEach)0 1100 y Fs(For)11 b(each)f(contiguous)e(data)j
(area)g(in)f(the)g(message,)h(invoke)e(the)h(function)f Fr(f)h
Fs(with)g(three)g(ar)o(guments:)15 b(the)10 b(address)g(of)g(the)0
1157 y(data,)15 b(the)e(length)g(of)h(the)f(data,)i(and)f(a)g(user)f
(supplied)g(ar)o(gument)g Fr(ar)n(g)p Fs(.)24 b(The)14 b(iteration)f(stops)f
(when)h Fr(f)h Fs(does)f(not)g(return)0 1213 y Fr(TRUE)p Fs(.)71
1295 y Fm(v)o(oid)d Fl(msgF)-5 b(orEac)n(h)11 b Fs(\()p Fm(Msg)h
Fs(*)p Fh(this)p Fs(,)g Fm(MCharF)m(un)f Fh(f)p Fs(,)h Fm(v)o(oid)e
Fs(*)p Fh(ar)o(g)p Fs(\);)71 1376 y Fm(t)o(yp)q(edef)i(b)q(o)q(ol)e
Fs(\()p Fl(*MCharF)-5 b(un)14 b Fs(\)\()p Fm(c)o(har)e Fs(*)p
Fh(ptr)p Fs(,)f Fm(long)f Fh(len)p Fs(,)j Fm(v)o(oid)d Fs(*)p
Fh(ar)o(g)p Fs(\);)0 1557 y Fn(4.4)50 b(Usage)13 b(Rules)0
1644 y Fs(The)c Fr(x)p Fs(-kernel)h(coding)e(conventions)f(dictate)i(that)f
(messages)i(should)d(be)j(destroyed)e(by)h(the)g(same)h(entity)e(that)g
(originally)0 1700 y(constructed)19 b(them.)43 b(Thus,)21 b(the)f(ethernet)f
(driver)h(is)f(responsible)g(for)h(destroying)e(messages)h(after)i
(successfully)0 1757 y(delivering)8 b(them)i(upward,)g(and)g(the)g(top-level)
e(protocols)g(that)i(interface)g(to)f(user)h(functions)e(should)g(destroy)h
(messages)0 1813 y(that)i(have)g(been)g(successfully)e(delivered)i(to)g
(their)f(destination.)71 1870 y(When)h(a)h(protocol)f(passes)g(passes)g(a)h
(message)g(to)f(an)h(adjacent)f(protocol)g(\(via)g Fr(xPush)p
Fs(,)h Fr(xDemux)p Fs(,)g(etc.\))19 b(its)11 b(view)g(of)0
1926 y(the)h(message)g(becomes)g(invalid.)18 b(The)12 b(contents)e(of)i(the)g
(message)g(after)h(such)e(an)h(operation)f(depend)h(on)f(which)h(lower)0
1983 y(headers)e(were)h(pushed)e(onto)g(it.)15 b(Should)9 b(a)i(protocol)e
(want)g(to)h(keep)g(a)g(reference)h(to)f(the)g(message\320e.g.,)i(so)d(it)h
(can)g(later)0 2039 y(retransmit)15 b(it\320it)f(must)g(explicitly)f(save)i
(a)h(copy)e(using)g(the)h Fr(msgAssign)d Fs(or)j Fr(msgConstructCopy)e
Fs(operation)h(before)0 2095 y(passing)c(the)h(message)g(on)g(to)g(another)f
(protocol.)71 2152 y(Note)17 b(that)f(although)g(a)i(protocol)e(which)g
(constructs)g(a)i(message)g(invalidates)d(its)i(view)g(of)g(the)g(message)h
(after)0 2208 y(performing)11 b(a)g(UPI)h(operation)e(involving)f(that)h
(message,)i(it)f(is)f(still)g(responsible)f(for)j(destroying)d(the)i
(message.)71 2265 y(Message)f(attributes)e(passed)i(between)g(protocols)e
(should)h(consist)f(of)i(exportable)g(data,)g(i.e.)17 b(not)9
b(pointers.)15 b(Adher)o(-)0 2321 y(ence)d(to)e(this)g(convention)g(will)g
(ensure)h(that)f(the)h(protocol)f(can)i(be)f(in)g(used)f(in)h(a)h
(multi-adress)e(space)h(environment.)952 2753 y(31)p eop
%%Page: 32 32
31 bop 0 124 a Ft(5)60 b(Event)14 b(Library)0 228 y Fs(The)g(event)f(library)
g(provides)f(a)i(mechanism)g(for)g(scheduling)e(a)i(procedure)g(to)f(be)h
(called)f(after)h(a)g(certain)g(amount)f(of)0 284 y(time.)j(By)c(registering)
d(a)i(procedure)g(with)f(the)h(event)f(library)m(,)h(protocols)e(are)j(able)e
(to)h(\252timeout\272)f(and)h(act)g(on)f(messages)0 340 y(that)h(have)g(not)f
(been)h(acknowledged)f(or)h(to)g(perform)h(periodic)e(maintenance)h
(functions.)0 465 y Fn(5.1)50 b(T)l(ype)13 b(De\256nitions)0
552 y Fs(The)g(only)f(event-related)h(type)g(that)f(protocol)g(programmers)i
(need)g(be)f(aware)h(of)f(is)g(the)g(type)g Fr(Event)p Fs(.)22
b(However)n(,)14 b(this)0 608 y(type)d(is)f(de\256ned)h(by)g(the)g
(underlying)f(platform)g(and)h(is)g(opaque)g(to)f(the)h(protocol)f
(programmer)m(.)0 733 y Fn(5.2)50 b(Operations)0 820 y Fo(5.2.1)45
b(evSchedule)0 907 y Fs(Schedule)13 b(an)g(event)g(that)g(executes)g
(function)f Fr(f)h Fs(with)f(ar)o(gument)h Fr(a)g Fs(after)h(delay)f
Fr(t)g Fs(usec;)h Fr(t)f Fs(may)g(equal)g(0.)23 b(A)13 b(handle)g(to)0
963 y(the)d(event)g(is)g(returned,)h(and)f(this)f(can)i(be)g(used)f(to)g
(cancel)g(the)g(event)h(at)f(some)h(later)f(time.)16 b(When)10
b(an)h(event)f(\256res,)h(a)g(new)0 1019 y(thread)j(is)f(created)h(to)f(run)h
(function)f Fr(f)p Fs(.)24 b(Note)13 b(that)g(even)h(after)g(an)g(event)g
(\256res)g(and)g(a)g(thread)f(had)h(been)g(scheduled)f(to)0
1076 y(handle)d(it,)h(the)g(thread)f(does)h(not)f(run)g(until)g(sometime)g
(after)i(the)e(currently)h(executing)e(thread)i(gives)f(up)g(the)h(processor)
m(.)0 1132 y(See)h(Section)f(7)g(for)g(a)h(description)d(of)i(how)g(threads)g
(are)g(scheduled.)71 1214 y Fm(Ev)o(en)o(t)g Fl(evSc)n(hedule)g
Fs(\()p Fm(EvF)m(unc)g Fh(f)p Fs(,)h Fm(v)o(oid)p Fs(*)e Fh(a)p
Fs(,)i Fm(in)o(t)e Fh(t)p Fs(\))71 1270 y Fm(t)o(yp)q(edef)k(v)o(oid)d
Fs(\()p Fl(*)18 b(EvF)-5 b(unc)12 b Fs(\))f(\()h Fm(Ev)o(en)o(t)g
Fs(*,)f Fm(v)o(oid)g Fs(*)g(\))71 1352 y(Function)e Fr(f)i
Fs(must)g(be)g(of)g(type)f Fr(void)g Fs(and)h(take)g(two)f(ar)o(guments:)16
b(the)11 b(\256rst,)g(of)g(type)f Fr(Event)p Fs(,)h(is)g(a)g(handle)f(to)h
(the)g(event)0 1408 y(itself)e(and)g(the)g(second,)h(of)g(type)f
Fr(void)g(*)p Fs(,)h(is)f(the)g(ar)o(gument)h(passed)f(to)g(evSchedule.)16
b(In)10 b(order)f(to)h(satisfy)e(the)h(C)h(compiler)0 1464
y(type)h(checking)g(rules)g(when)g(accessing)g(the)g(ar)o(guments,)h
(function)e Fr(f)i Fs(must)f(begin)g(by)g(casting)f(its)h(second)g(ar)o
(gument)h(to)0 1521 y(be)f(a)h(non-void)d(type.)0 1644 y Fo(5.2.2)45
b(evDetach)0 1731 y Fs(Releases)16 b(a)h(handle)e(to)h(an)g(event.)30
b(As)16 b(soon)f(as)h Fr(f)g Fs(completes,)h(the)f(internal)f(resources)h
(associated)f(with)g(the)h(event)0 1787 y(are)e(freed.)24 b(All)13
b(events)g(should)f(eventually)g(be)i(either)f(detached)g(or)h(canceled)g(to)
f(assure)g(that)g(system)g(resources)h(are)0 1843 y(released.)71
1925 y Fm(v)o(oid)c Fl(evDetac)n(h)h Fs(\()p Fm(Ev)o(en)o(t)h
Fh(e)p Fs(\))0 2072 y Fo(5.2.3)45 b(evCancel)0 2159 y Fs(Cancels)12
b(event)g Fr(e)g Fs(and)g(returns)f(EVENT)p 668 2159 14 2 v
16 w(FINISHED)h(if)g(the)g(event)f(has)h(already)g(happened,)g(EVENT)p
1688 2159 V 15 w(RUNNING)g(if)0 2216 y(the)e(event)g(is)g(currently)g
(running,)f(and)i(EVENT)p 784 2216 V 15 w(CANCELLED)f(if)g(the)g(event)g(has)
g(not)g(run)g(and)g(can)h(be)g(guaranteed)f(to)0 2272 y(not)h(run.)16
b(In)c(the)f(case)g(where)h Fl(evCancel)e Fs(returns)h(EVENT)p
1009 2272 V 15 w(RUNNING,)h(the)f(caller)g(must)g(be)g(careful)h(to)f(not)f
(delete)0 2329 y(resources)h(required)g(by)g(the)g(event.)71
2410 y Fm(EvCancelReturn)h Fl(evCancel)e Fs(\()p Fm(Ev)o(en)o(t)i
Fh(e)p Fs(\))952 2753 y(32)p eop
%%Page: 33 33
32 bop 0 124 a Fo(5.2.4)45 b(evIsCancelled)0 211 y Fs(Returns)11
b(true)f(if)h(an)g Fl(evCancel)g Fs(has)f(been)h(performed)h(on)e(the)h
(event.)16 b(Because)c(event)f(handlers)f(receive)h(their)g(event)0
268 y(as)f(the)g(\256rst)g(calling)g(ar)o(gument,)g(it)g(is)g(possible)e(for)
j(a)f(handler)g(to)g(check)h(for)f(cancellation)f(of)h(itself)g(from)h(other)
e(threads.)71 349 y Fm(in)o(t)i Fl(evIsCancelled)e Fs(\()p
Fm(Ev)o(en)o(t)j Fh(e)p Fs(\))0 472 y Fo(5.2.5)45 b(evDump)0
559 y Fs(Displays)8 b(a)i Fr(ps)p Fs(-style)e(listing)g(of)h
Fr(x)p Fs(-kernel)h(threads)f(in)h Fr(x)p Fs(-kernel')m(s)g(compiled)f(with)g
(DEBUG)g(mode.)16 b(The)10 b(address)f(of)g(the)0 615 y(entry)j(function,)f
(the)h(thread)g(state)f(\(pending,)h(scheduled,)f(running,)h(\256nished,)f
(or)h(blocked\),)g(the)g(time)g(relevant)g(to)f(the)0 672 y(thread)g(state,)f
(and)h(\257ags)g(\(detached)g(or)g(cancelled\),)g(are)h(displayed)d(for)i
(each)g(thread)g(controlled)e(by)i Fr(x)p Fs(-kernel)g(monitor)m(.)0
728 y(The)f(meaning)g(of)h(the)f(time)g(entry)h(varies)f(according)g(to)f
(the)i(state.)k(For)c(pending)e(threads,)i(the)f(time)g(is)g(the)g(time)h
(until)e(it)0 785 y(will)i(be)i(scheduled;)e(for)i(other)e(states)h(it)g(is)f
(the)h(time)h(the)f(thread)g(has)g(spent)f(in)h(that)g(state.)19
b(The)12 b(time)h(is)f(reset)g(on)g(each)0 841 y(transition,)d(i.e.,)k(it)d
(is)h(not)f(cumulative.)71 922 y Fm(v)o(oid)g Fl(evDump)f Fs(\()p
Fm(v)o(oid)p Fs(\))0 1047 y Fn(5.3)50 b(Usage)13 b(Rules)0
1134 y Fo(5.3.1)45 b(Repeating)12 b(Events)0 1221 y Fs(Each)f(event)g(that)g
(is)f(scheduled)g(executes)h(at)g(most)g(one)g(time.)17 b(Repeating)10
b(events)h(are)h(programmed)f(as)h(follows:)218 1383 y Fg(foo_init\(\))218
1440 y({)327 1496 y(...)327 1553 y(evDetach\()30 b(evSchedule\()g(f,)e
(argument,)i(INTERVAL)f(\))f(\);)218 1609 y(})218 1779 y(f\()g(Event)h(self,)
f(void)h(*arg)f(\))218 1835 y({)327 1891 y(actual)h(work)327
1948 y(...)327 2004 y(evDetach\()h(evSchedule\()g(f,)e(arg,)g(INTERVAL)i(\))d
(\);)218 2061 y(})0 2240 y Fo(5.3.2)45 b(Cancellable)11 b(Events)0
2327 y Fs(The)h(evIsCancelled)h(routine)e(is)h(designed)f(to)h(make)h(it)f
(easy)h(to)f(write)g(events)g(which)g(might)f(be)i(cancelled)f(before)h(\(or)
0 2383 y(while\))f(they)g(run.)22 b(It)12 b(is)h(common)g(practice,)g(for)g
(example,)h(for)f(a)g(session)f(to)g(pass)g(session)f(state)i(to)f(a)h
(timeout)f(event.)0 2440 y(The)f(evIsCancelled)g(noti\256cation)e(can)i(be)g
(used)g(to)f(synchronize)g(the)h(timeout)f(event)g(and)h(the)g(possible)e
(destruction)g(of)0 2496 y(the)i(session)f(state.)16 b(Here)11
b(is)g(an)g(example:)952 2753 y(33)p eop
%%Page: 34 34
33 bop 218 124 a Fg(foo_destroy\(\))218 181 y({)327 237 y(...)327
294 y(evCancel\()30 b(state->timeou)q(tEve)q(nt)g(\);)327 350
y(...)218 407 y(})218 576 y(foo_timeout\()h(Event)d(self,)h(void)f(*state)h
(\))218 632 y({)300 689 y(...)300 745 y(xPush\(lls,)h(retransmitMsg)q(\);)300
802 y(/*)327 858 y(*)e(xPush)g(may)h(have)f(blocked)h(--)f(check)h(to)e(see)h
(if)g(state)h(is)327 915 y(*)f(still)g(valid)327 971 y(*/)327
1028 y(if)g(\()g(evIsCancelled\(s)q(elf)q(\))i(\))e({)436 1084
y(return;)327 1140 y(})327 1197 y(state->timeo)q(utEv)q(ent)j(=)c
(evSchedule\()k(foo_timeout,)f(arg,)e(INTERVAL)i(\);)218 1253
y(})0 1432 y Fo(5.3.3)45 b(Event)12 b(Granularity)0 1519 y
Fs(Although)d(the)h(event)h(library)f(uses)g(an)h(ef)o(\256cient)g
(representation)f(\(timing)g(wheels\))g(protocol)f(programmers)j(should)d(be)
0 1576 y(careful)15 b(to)e(not)h(schedule)f(events)h(that)f(are)i(too)f
(\256ne)g(grained.)25 b(For)15 b(example,)g(in)f(TCP)-5 b(,)15
b(it)f(is)f(better)h(to)g(schedule)f(one)0 1632 y(event)e(for)g(every)g
(session)f(rather)i(than)e(for)i(every)f(message)g(that)g(is)f(sent.)952
2753 y(34)p eop
%%Page: 35 35
34 bop 0 124 a Ft(6)60 b(Map)15 b(Library)0 228 y Fs(The)e(map)h(library)e
(provides)g(a)i(facility)e(for)i(maintaining)d(a)j(set)f(of)g(bindings)e
(between)i(identi\256ers.)22 b(The)13 b(map)h(library)0 284
y(supports)e(operations)f(for)j(adding)e(new)i(bindings)d(to)i(the)g(set,)h
(removing)e(bindings)g(from)i(the)f(set,)h(and)f(mapping)f(one)0
340 y(identi\256er)e(into)h(another)n(,)g(relative)f(to)h(a)h(set)f(of)g
(bindings)e(\(lookup\).)15 b(Protocol)c(implementations)e(use)i(these)g
(operations)0 397 y(to)i(translate)g(identi\256ers)f(extracted)h(from)h
(message)g(headers)f(\(e.g.,)i(addresses,)f(port)f(numbers\))g(into)f
(capabilities)g(for)0 453 y(kernel)f(objects)f(\(e.g.,)j Fr(XObj)p
Fs(,)d Fr(Enable)p Fs(\).)0 578 y Fn(6.1)50 b(T)l(ype)13 b(De\256nitions)0
665 y Fs(The)e(map)h(library)e(de\256nes)h(two)g(data)g(structures:)k
Fr(MapElement)9 b Fs(and)i Fr(Map)p Fs(.)16 b Fr(Bind)11 b
Fs(is)f(a)i(pointer)e(to)h(a)g Fr(MapElement)p Fs(.)102 796
y Fm(t)o(yp)q(edef)k(struct)e Fs(mapelement)e Fk(f)295 852
y Fm(struct)16 b(map)q(elemen)o(t)181 b Fs(*next;)295 909 y
Fm(v)o(oid)13 b(*)196 b Fs(internalid;)295 965 y Fm(v)o(oid)13
b(*)196 b Fs(externalid;)102 1022 y Fk(g)11 b Fl(MapElemen)n(t)p
Fs(,)f(*)p Fl(Bind)p Fs(;)102 1135 y Fm(t)o(yp)q(edef)15 b(struct)e
Fk(f)295 1191 y Fm(in)o(t)257 b Fs(nEntries,)10 b(keySize;)295
1247 y Fm(MapElemen)o(t)75 b Fs(*cache;)295 1304 y Fm(MapElemen)o(t)g
Fs(*freelist;)295 1360 y Fm(MapElemen)o(t)g Fs(**table;)295
1417 y Fm(xk)o(ern)p 397 1417 13 2 v 16 w(return)p 525 1417
V 16 w(t)47 b Fs(\(*resolve\)\(\);)295 1473 y Fm(Bind)220 b
Fs(\(*bind\)\(\);)295 1530 y Fm(xk)o(ern)p 397 1530 V 16 w(return)p
525 1530 V 16 w(t)47 b Fs(\(*unbind\)\(\);)295 1586 y Fm(xk)o(ern)p
397 1586 V 16 w(return)p 525 1586 V 16 w(t)g Fs(\(*remove\)\(\);)102
1643 y Fk(g)11 b Fs(*)p Fl(Map)p Fs(;)0 1767 y Fn(6.2)50 b(Operations)0
1854 y Fo(6.2.1)45 b(mapCr)o(eate)0 1941 y Fs(Creates)16 b(a)f(map)g(with)f
Fr(nEntries)g Fs(elements)g(in)h(it.)27 b(External)15 b(ids)f(bound)g(in)g
(this)g(map)h(are)h Fr(keySize)f Fs(bytes)f(long.)27 b(The)0
1997 y(maximum)9 b(value)f(for)h(the)f(key)g(size)g(is)g(MAX)p
727 1997 14 2 v 16 w(MAP)p 841 1997 V 17 w(KEY)p 952 1997 V
16 w(SIZE,)h(currently)f(100)f(bytes.)15 b(Programmers)10 b(will)d(normally)0
2054 y(use)h Fi(sizeof\(structuretype\))f Fs(as)h(the)g(keysize)f(to)h
(facilitate)f(platform)h(independence.)14 b(Note)8 b(that)f(maps)h(never)g
(over\257ow)m(,)0 2110 y(but)i(they)h(perform)h(best)e(if)i
Fr(nEntries)d Fs(is)i(chosen)f(so)h(that)g(the)f(map)i(is)f(at)g(most)g
(50-80\045)f(full.)71 2192 y Fm(Map)25 b Fl(mapCreate)10 b
Fs(\()p Fm(in)o(t)h Fh(nEntries)p Fs(,)h Fm(in)o(t)f Fh(keySize)p
Fs(\);)0 2314 y Fo(6.2.2)45 b(mapResolve)0 2401 y Fs(Looks)9
b(for)i(the)f(internal)g(identi\256er)g(bound)f(to)h(the)h(external)f
(identi\256er)g Fr(ext)h Fs(in)f(the)g(map)h Fr(Map)p Fs(.)16
b(Note)10 b(that)g(the)g(resolution)0 2458 y(will)h(be)i(done)f(with)f
Fr(keysize)h Fs(bytes)g(of)g(what)g(the)h Fr(ext)f Fs(identi\256er)g(points)f
(to,)h(where)h Fr(keysize)f Fs(is)g(the)g(parameter)i(that)d(was)0
2514 y(used)j(in)f(the)h Fr(mapCr)n(eate)g Fs(call.)25 b(If)14
b(a)h(binding)d(is)h(found,)i Fr(*ptr)e Fs(is)h(assigned)e(the)i(value)g(of)g
(the)g(internal)f(identi\256er)g(and)0 2571 y(XK)p 69 2571
V 16 w(SUCCESS)f(is)f(returned.)16 b(If)11 b(no)g(appropriate)f(binding)f(is)
i(found,)g(mapResolve)f(returns)h(XK)p 1590 2571 V 16 w(F)m(AILURE.)g(If)g
Fr(ptr)g Fs(is)0 2627 y(NULL,)g(only)f(the)h(error)h(code)f(is)g(returned.)
952 2753 y(35)p eop
%%Page: 36 36
35 bop 71 124 a Fm(xk)o(ern)p 173 124 13 2 v 15 w(return)p
300 124 V 16 w(t)12 b Fl(mapResolv)n(e)d Fs(\()p Fm(Map)i Fh(Map)p
Fs(,)h Fm(v)o(oid)e Fs(*)p Fh(ext)p Fs(,)i Fm(v)o(oid)e Fs(**)p
Fh(ptr)h Fs(\);)0 247 y Fo(6.2.3)45 b(mapBind)0 334 y Fs(Adds)15
b(a)i(binding)d(of)i(external)g(id)g Fr(ext)g Fs(to)g(internal)f(id)h
Fr(intern)f Fs(to)h(map)h Fr(Map)p Fs(.)31 b(Note)15 b(that)h(the)g(binding)e
(will)h(be)i(done)0 390 y(with)c Fr(keysize)h Fs(bytes)f(of)g(what)h(the)f
Fr(ext)h Fs(identi\256er)g(points)e(to,)i(where)g Fr(keysize)g
Fs(is)f(the)h(parameter)h(that)e(was)h(used)f(in)g(the)0 447
y Fr(mapCr)n(eate)g Fs(call.)25 b(The)14 b(return)g(value)f(uniquely)f
(identi\256es)h(this)g(binding;)g(it)g(can)i(later)e(be)i(given)e(as)h(an)g
(ar)o(gument)g(to)0 503 y Fr(mapRemoveBinding)p Fs(.)h(A)d(return)f(value)g
(of)h(ERR)p 811 503 14 2 v 16 w(BIND)g(indicates)f(that)f(the)i(external)f
(identi\256er)g(is)g(already)g(bound)g(in)0 560 y(the)g(map.)71
641 y Fm(Bind)g Fl(mapBind)f Fs(\()i Fm(Map)f Fh(Map)p Fs(,)h
Fm(v)o(oid)e Fs(*)p Fh(ext)p Fs(,)h Fm(v)o(oid)i(*)e Fh(intern)h
Fs(\);)0 764 y Fo(6.2.4)45 b(mapRemoveBinding)0 851 y Fs(Removes)12
b(binding)d Fr(Bind)h Fs(from)i(map)f Fr(Map)p Fs(.)16 b(Returns)11
b Fr(XK)p 942 851 V 17 w(F)-6 b(AILURE)11 b Fs(if)g(the)g(item)g(is)f(not)h
(in)g(the)g(map.)71 932 y Fr(3.1)g(Compatibility)d(note)p Fs(:)15
b(Same)e(as)e(3.1)g Fr(mapunbindbindi)o(ng)p Fs(.)71 1013 y
Fm(xk)o(ern)p 173 1013 13 2 v 15 w(return)p 300 1013 V 16 w(t)h
Fl(mapRemo)n(v)n(eBi)o(nding)d Fs(\()p Fm(Map)i Fh(Map)p Fs(,)h
Fm(Bind)f Fh(Bind)p Fs(\);)0 1136 y Fo(6.2.5)45 b(mapUnbind)0
1223 y Fs(Removes)14 b(binding)e(of)i(the)f(association)f(key)i
Fr(ext)g Fs(from)g(the)g(map)g Fr(Map)p Fs(.)24 b(This)13 b(is)g(the)h
(inverse)f(of)h Fr(mapBind)p Fs(.)23 b(Returns)0 1280 y(XK)p
69 1280 14 2 v 16 w(F)m(AILURE)11 b(if)g(the)g(item)g(is)g(not)f(in)h(the)g
(map.)71 1361 y Fr(3.1)g(Compatibility)d(note:)16 b Fs(Same)c(as)g(3.1)f
(mapremove.)71 1442 y Fm(xk)o(ern)p 173 1442 13 2 v 15 w(return)p
300 1442 V 16 w(t)h Fl(mapUn)n(bind)f Fs(\()p Fm(Map)g Fh(Map)p
Fs(,)h Fm(v)o(oid)24 b Fs(*)p Fh(ext)p Fs(\);)0 1565 y Fo(6.2.6)45
b(mapClose)0 1652 y Fs(Destroys)15 b(the)h(map)g(and)g(frees)g(its)g(space.)
31 b(Any)15 b(elements)h(left)g(in)g(the)f(map)i(will)e(be)h(unbound)e
(before)i(the)g(map)h(is)0 1708 y(destroyed.)71 1790 y Fm(v)o(oid)10
b Fl(mapClose)g Fs(\()p Fm(Map)i Fh(Map)p Fs(\);)0 1912 y Fo(6.2.7)45
b(mapForEach)0 1999 y Fs(Allows)9 b(iterative)g(access)i(to)f(the)f(entries)h
(of)g(a)h(map)g(by)f(the)g(provided)f(function)g Fr(f)p Fs(.)16
b(Each)10 b(call)g(to)g Fr(mapForEach)e Fs(puts)h(the)0 2056
y(key)i(and)h(its)f(value)g(into)g(ar)o(guments)g(passed)g(the)g(function)g
Fr(f)p Fs(.)18 b(The)11 b(third)g(ar)o(gument)g(passed)g(to)h
Fr(f)f Fs(is)g(the)h(supplied)e(value)0 2112 y Fr(ar)n(g)p
Fs(.)25 b(As)14 b(long)f(as)h(the)f(\257ag)i Fr(MFE)p 559 2112
14 2 v 16 w(CONTINUE)g Fs(is)e(set)h(in)f(the)h(function')m(s)f(return)h
(value)g(and)g(there)g(are)g(unprocessed)0 2169 y(keys,)d Fr(mapForEach)e
Fs(will)h(continue)g(to)h(call)g Fr(f)p Fs(.)71 2225 y(If)i(the)g(\257ag)g
Fr(MFE)p 361 2225 V 16 w(REMOVE)f Fs(is)h(set)f(in)h(the)g(return)g(value,)g
Fr(mapForEach)e Fs(will)h(remove)i(the)f(entry)f(from)i(the)f(map)0
2282 y(after)e(the)g(user)f(function)g(returns)g(and)g(before)h(it)f(is)h
(called)f(with)g(the)g(next)g(map)h(entry)m(.)16 b(This)10
b(is)g(the)h(only)f(recommended)0 2338 y(way)g(to)g(remove)g(the)g
(\252current\272)h(map)f(entry)g(during)f(a)i Fr(mapForEach)d
Fs(operation.)15 b(If)c(the)e(user)i(function)d(tries)i(to)g(remove)0
2395 y(the)j(\252current\272)g(entry)g(directly)f(\(via)h(mapRemove)h(or)f
(mapUnbind\),)f Fr(mapForEach)f Fs(may)j(fail)f(to)f(\256nd)h(all)g(of)g(the)
g(map)0 2451 y(entries.)71 2507 y(New)g(map)g(entries)g(added)f(in)h(the)g
(middle)f(of)h(a)h Fr(mapForEach)d Fs(iteration)h(may)h(or)g(may)h(not)e
(show)g(up)h(during)f(that)0 2564 y(iteration.)j(Map)d(manipulations)d
(within)g(a)j Fr(mapForEach)d Fs(user)i(function)f(are)i(generally)f(not)f
(recommended.)952 2753 y(36)p eop
%%Page: 37 37
36 bop 71 124 a Fr(MFE)p 168 124 14 2 v 15 w(REMOVE)13 b Fs(and)h
Fr(MFE)p 553 124 V 15 w(CONTINUE)h Fs(are)g(binary)e(\257ags)h(which)f(may)h
(be)g(combined)f(using)f(bitwise)h(OR.)h(A)0 181 y(return)d(value)g(of)g(0)g
(negates)g(both)f(\257ags.)71 237 y(The)h(order)g(in)g(which)f(keys)h(are)h
(returned)e(depends)h(on)g(the)f(internal)h(structure)f(of)h(the)g(map.)71
319 y Fm(v)o(oid)f Fl(mapF)-5 b(orEac)n(h)p Fs(\()p Fm(Map)11
b Fh(m)p Fs(,)h Fm(MapF)m(orEac)o(hF)m(un)f Fh(f)p Fs(,)g Fm(v)o(oid)g
Fs(*)p Fh(ar)o(g)f Fs(\))71 400 y Fm(t)o(yp)q(edef)k(in)o(t)d
Fl(MapF)-5 b(orEac)n(hF)g(un)14 b Fs(\()d Fm(v)o(oid)g Fs(*)p
Fh(key)p Fs(,)f Fm(v)o(oid)h Fs(*)p Fh(value)p Fs(,)h Fm(v)o(oid)e
Fs(*)p Fh(ar)o(g)h Fs(\))0 524 y Fn(6.3)50 b(Usage)13 b(Rules)0
611 y Fo(6.3.1)45 b(External)12 b(Keys)0 698 y Fs(Maps)j(are)g(used)f(to)g
(bind)g(a)h(variable)f(length)g(external)g(id)g(to)g(an)h(internal)f(id)g(of)
g(type)h Fr(int)p Fs(.)26 b(The)14 b(size)h(of)f(the)h(external)0
755 y(id)g(is)h(given)f(as)h(an)g(ar)o(gument)f(when)h(a)g(particular)f(map)i
(is)e(created.)31 b(All)15 b(external)g(ids)g(bound)g(using)g(this)f(map)j
(are)0 811 y(expected)10 b(to)f(be)h(of)g(this)f(size.)16 b(The)10
b(user)g(is)g(warned)f(to)h(use)g(a)g(zero-izing)g(routine)e(like)i
Fi(bzero)h Fs(before)f(assigning)e(values)0 868 y(to)14 b(a)h(structure)f
(that)f(will)h(be)g(used)g(with)g(the)g(map)h(routines.)25
b(The)14 b(C)h(language)f(can)h(have)f(uninitialized)e(data)i(in)g(the)0
924 y(interstices)e(of)h(structures)f(\(i.e.,)j(padding)c(areas\),)k(and)e
(these)g(can)g(cause)g(structures)f(that)h(are)h(\252equal\272)f(\(i.e.,)i
(all)e(\256elds)0 980 y(have)e(the)g(same)h(values\))e(to)h(fail)g(to)g(map)h
(to)e(the)h(same)h(value)f(in)f(the)h Fr(x)p Fs(-kernel.)0
1103 y Fo(6.3.2)45 b(Active)11 b(and)h(Passive)e(Maps)0 1190
y Fs(Protocols)j(generally)h(maintain)f(two)h(maps:)22 b(an)14
b(active)g(map)h(and)f(a)h(passive)e(map.)26 b(Active)14 b(maps)g(are)h(used)
f(to)g(map)0 1247 y(keys)c(found)f(in)h(incoming)g(messages)g(into)f(the)h
(session)f(that)h(will)f(process)h(the)g(message.)17 b(Thus,)10
b(the)g(active)g(map)g(holds)0 1303 y(information)e(about)g(the)h(set)g(of)g
(currently)g(active)g(connections.)14 b(Passive)9 b(maps)g(are)h(used)e(to)h
(bind)f(identi\256ers)h(to)f Fr(Enable)0 1359 y Fs(objects)i(\(section)h
(2.1.2\),)h(thereby)f(allowing)f(a)i(protocol)e(to)h(create)h(a)g(session)e
(when)h(a)h(message)g(that)f(is)g(part)g(of)g(a)h(new)0 1416
y(connection)e(arrives.)71 1472 y(T)m(ypically)m(,)g(a)i(protocol)e(binds)h
(an)g(active)h(key)f(to)g(a)h(session)f(in)g(its)g Fr(open)g
Fs(routine,)g(and)g(a)h(passive)f(key)g(to)h(an)f(enable)0
1529 y(object)f(in)g(its)g Fr(openEnable)f Fs(routine.)15 b(These)10
b(bindings)f(are)i(then)f(used)g(in)g(the)h(protocol')m(s)e
Fr(demux)i Fs(operation,)f(according)0 1585 y(to)h(the)g(general)g(pattern)f
(illustrated)g(in)g(\256gure)i(1.)71 1642 y(Notice)g(two)h(things)e(about)h
(the)h(example.)23 b(First,)13 b(in)g(the)g(case)g(where)h(a)f(new)g(session)
f(is)h(created,)h(it)f(is)f(necessary)0 1698 y(to)h(call)h
Fr(xDuplicate)f Fs(on)g(the)h(lower)o(-level)f(session)f(to)i(make)g(the)g
(reference)h(we)f(hold)f(to)g(it)h(permanent)g(\(see)g(Sections)0
1755 y(2.2.15)e(and)g(11\).)19 b(Second,)13 b(it)e(is)h(useful)g(to)f(save)h
(the)g(binding)e(of)j(an)f(active)g(key)g(to)f(the)h(newly)g(created)g
(session)f(in)g(the)0 1811 y(session)e(object)h(itself.)16
b(\(The)10 b(same)h(thing)f(is)g(done)g(when)g(a)h(session)e(is)h(created)h
(in)g(the)f(protocol')m(s)g Fr(open)g Fs(routine\).)15 b(This)0
1868 y(is)f(because)h(it)f(will)f(be)i(necessary)f(to)g(be)h(able)f(to)g
(remove)h(the)f(binding)f(from)i(the)f(active)g(map)h(when)f(the)h(session)e
(is)0 1924 y(closed,)c(and)g(this)f(is)h(often)g(easier)g(or)h(more)f(ef)o
(\256cient)h(if)f(the)g(binding)e(itself)i(is)f(available.)16
b(Finally)m(,)9 b(the)g(active)g(key)g(in)f(this)0 1980 y(example)13
b(includes)e(both)g(\256elds)h(found)g(in)g(the)g(message)h(header)g(and)f
(the)g(lower)o(-level)g(session)f(that)h(called)g(xDemux.)0
2037 y(Using)g(the)g(lower)o(-level)g(session)f(as)i(part)g(of)g(the)f
(active)h(key)f(is)h(fairly)f(common;)i(it)e(helps)g(to)g(disambiguate)g
(protocol)0 2093 y(header)f(\256elds)g(that)g(are)h(not)e(unique)g(across)h
(all)g(lower)o(-level)g(connections.)952 2753 y(37)p eop
%%Page: 38 38
37 bop 574 151 a Fs(Figure)11 b(1:)k(Example)c(of)h(using)d(maps)j(in)e
(demux)0 257 y Fg(static)29 b(xkern_return_t)0 314 y(yap_demux\(sel)q(f,)h
(lls,)f(msg\))109 370 y(XObj)f(self;)109 426 y(XObj)g(lls;)109
483 y(Msg)g(*msg;)0 539 y({)109 596 y(Enable)56 b(*e;)109 709
y(/*)28 b(get)g(protocol-spec)q(ific)j(state)e(from)f(self)g(*/)109
765 y(pstate)h(=)f(self->state;)109 878 y(/*)g(extract)h(the)f(header)h(from)
f(the)h(message)g(*/)109 935 y(msgPop\(msg,)h(yapHdrLoad,)h(&hdr,)d(HLEN,)h
(0\);)109 1047 y(/*)f(make)g(an)g(active)h(key)f(from)g(fields)h(in)f(the)g
(header)h(\(and)g(other)f(info\))h(*/)109 1104 y(/*)f(then)g(see)g(if)g(it)g
(is)g(in)g(active)h(map;)f(if)g(found,)h(call)f(pop)g(*/)109
1160 y(activeid.loca)q(lpor)q(t)i(=)e(hdr.dstport;)109 1217
y(activeid.remo)q(tepo)q(rt)j(=)c(hdr.srcport;)109 1273 y(activeid.lls)k(=)c
(lls;)109 1330 y(if)h(\(mapResolve\(ps)q(tat)q(e->a)q(ctiv)q(ema)q(p,)i
(&activeid,)g(&s\))e(!=)g(XK_FAILURE\))109 1386 y({)218 1443
y(xkr)g(=)g(xPop\(s,)h(msg,)f(lls,)h(&hdr\);)218 1499 y(return)g(xkr;)109
1556 y(})109 1668 y(/*)f(make)g(a)g(passive)h(key)f(from)g(fields)h(in)f(the)
g(header)h(\(and)g(other)f(info\))h(*/)109 1725 y(/*)f(then)g(for)g(it)g(in)g
(the)g(passive)h(map)f(*/)109 1781 y(/*)55 b(if)28 b(found,)h(create)g(a)e
(new)h(session,)i(*/)109 1838 y(/*)e(save)g(a)g(binding)h(to)f(it)g(in)f(the)
i(active)f(map,)h(*/)109 1894 y(/*)f(and)g(call)g(opendone)i(and)e(pop)g(*/)
109 1951 y(passiveid)i(=)d(hdr.dstport;)109 2007 y(if)h(\(mapResolve\(ps)q
(tat)q(e->p)q(assi)q(vem)q(ap,)j(&passiveid,)f(&e\))e(!=)g(XK_FAILURE\))109
2064 y({)218 2120 y(s)g(=)f(yapCreateSes)q(sn\(s)q(elf,)k(e->hlpRcv,)f
(e->hlpType,)g(&activeid\);)218 2177 y(xDuplicate\(ll)q(s\);)218
2233 y(s->binding)g(=)e(mapBind\(pstate)q(->ac)q(tive)q(map)q(,)i(&activeid,)
g(\(int\)s\);)218 2289 y(xOpenDone\(e->)q(hlp)q(Rcv,)h(s,)d(self\);)218
2346 y(xkr)g(=)g(xPop\(s,)h(lls,)f(msg,)h(&hdr\);)218 2402
y(return)g(xkr;)82 2459 y(})109 2572 y(/*)f(don't)h(know)f(how)g(to)g
(process)h(this)f(message,)i(so)e(drop)g(it)g(*/)109 2628 y(return;)0
2685 y(})952 2753 y Fs(38)p eop
%%Page: 39 39
38 bop 0 124 a Ft(7)60 b(Thr)o(ead)14 b(Library)0 228 y Fs(The)c
Fr(x)p Fs(-kernel)h(uses)f(a)h(\252thread-per)o(-message\272)g(model)g(of)f
(computation,)g(and)g(provides)g(primitives)f(for)h(synchronizing)0
284 y(threads.)25 b(The)14 b(operations)f(af)o(fect)i(thread)f(scheduling.)23
b(Of)14 b(these,)h(only)e Fr(semW)l(ait)g Fs(can)i(cause)f(the)g
Fr(x)p Fs(-kernel)g(to)g(run)g(a)0 340 y(dif)o(ferent)d(thread)g(than)g(the)g
(current)g(one.)71 397 y(Note)g(that)g(this)f(section)h(does)g(not)g
(de\256ne)g(any)h(operations)e(for)i(creating)f(or)h(destroying)d(threads.)17
b(This)11 b(is)g(because)0 453 y Fr(x)p Fs(-kernel)g(threads)e(are)i(created)
g(and)f(destroyed)f(implicitly:)k(threads)d(are)h(created)g(by)f(the)g
(device)g(driver)g(\(in)g(the)f(case)i(of)0 510 y(incoming)d(messages\),)i
(by)f(the)g(system)f(call)h(interface)h(\(in)f(the)g(case)g(of)g(outgoing)e
(messages\),)j(and)f(by)g(the)g(event)g(library)0 566 y(\(in)i(the)g(case)g
(of)h(an)f(event)g(\256ring\).)16 b(Threads)11 b(are)h(destroyed)e(when)h
(they)f(return)h(from)h(the)f(outer)o(-most)f(procedure.)0
691 y Fn(7.1)50 b(T)l(ype)13 b(De\256nitions)0 778 y Fs(The)e(only)f
(thread-related)h(type)g(that)f(protocol)g(programmers)i(need)f(be)h(aware)g
(of)f(is)g(the)f(type)h Fr(Semaphor)n(e)p Fs(.)16 b(However)n(,)0
834 y(this)10 b(type)h(is)f(de\256ned)i(by)e(the)h(underlying)f(platform)g
(and)h(is)g(opaque)g(to)g(the)f(protocol)g(programmer)m(.)0
958 y Fn(7.2)50 b(Synchr)o(onization)10 b(Operations)0 1045
y Fo(7.2.1)45 b(semInit)0 1132 y Fs(Initializes)10 b(semaphore)i
Fr(s)f Fs(with)f(a)i(count)f(of)h Fr(cnt)p Fs(.)17 b(Semaphores)12
b(in)f(the)g(kernel)g(are)i(normally)d(allocated)h(statically)f(\(i.e.,)0
1189 y Fr(Semaphor)n(e)g(x)p Fs(\))i(and)f(must)g(be)g(initialized)e(\()p
Fr(semInit\(&x,)i(1\))p Fs(\))h(before)f(they)g(are)h(used.)71
1270 y Fm(v)o(oid)e Fl(semInit)f Fs(\()p Fm(Semaphore)i Fs(*)p
Fh(s)p Fs(,)h Fm(in)o(t)f Fh(cnt)p Fs(\))0 1449 y Fo(7.2.2)45
b(semW)m(ait)0 1536 y Fs(Increments)12 b(the)f(use)h(count)e(for)i(the)g
(semaphore.)18 b(The)11 b(current)h(thread)f(will)g(either)g(acquire)g(the)h
(semaphore)g Fr(s)f Fs(or)h(give)0 1593 y(up)f(control)f(until)g(a)h
Fr(semSignal)e Fs(is)i(done)g(by)g(another)f(thread)h(and)g(the)g(scheduler)g
(runs.)71 1674 y Fm(v)o(oid)f Fl(semW)-5 b(ait)10 b Fs(\()p
Fm(Semaphore)h Fs(*)p Fh(s)p Fs(\))0 1853 y Fo(7.2.3)45 b(semSignal)0
1940 y Fs(The)10 b(current)h(thread)f(decrements)g(the)h(use)f(count)f(for)i
(semaphore)g Fr(s)p Fs(.)16 b(The)10 b(current)g(thread)h(continues)d
(executing.)16 b(Note)0 1997 y(that)8 b(if)h(multiple)e(threads)h(are)i
(blocked)e(on)g(the)h(semaphore,)g(there)g(is)f(no)h(policy)e(about)h(which)g
(thread)h(will)e(be)i(awakened)0 2053 y(by)i(the)g Fr(semSignal.)71
2134 y Fm(v)o(oid)f Fl(semSignal)f Fs(\()p Fm(Semaphore)i Fs(*)p
Fh(s)p Fs(\))0 2259 y Fn(7.3)50 b(Delay)0 2346 y Fs(Delays)11
b(the)g(current)g(thread)h(for)f(at)h(least)f Fr(msec)g Fs(milliseconds.)16
b(This)10 b(is)h(not)g(a)h(thread)f(primitive,)g(but)g(a)g(library)g(routine)
0 2402 y(built)h(on)h(top)g(of)g Fr(semW)l(ait)p Fs(/)p Fr(semSignal)o
Fs(.)21 b(Note)13 b(that)g(the)g(ar)o(gument)g(is)g(in)g(milliseconds,)g
(while)f(the)i(time)f(ar)o(gument)h(to)0 2459 y Fr(evSchedule)d
Fs(is)f(in)h(microseconds.)71 2540 y Fm(v)o(oid)f Fl(Dela)n(y)h
Fs(\()g Fm(in)o(t)23 b Fs(msec)11 b(\))952 2753 y(39)p eop
%%Page: 40 40
39 bop 0 124 a Fn(7.4)50 b(Locking)12 b(Operations)0 211 y
Fs(The)i Fr(x)p Fs(-kernel)g(provides)f(a)h(readers/writers)f(lock)g
(synchronization)f(type,)i Fr(ReadW)m(riteLock)p Fs(.)24 b(This)13
b(type)h(is)f(currently)0 268 y(built)d(on)h(top)g(of)g(the)h
Fr(x)p Fs(-kernel)f Fr(Semaphor)n(e)g Fs(type.)17 b(Although)9
b(originally)h(developed)g(for)i(the)f(machNetIPC)h(protocols,)0
324 y(the)g(lock)g(can)g(be)h(used)e(for)i(more)g(general)f(synchronization.)
17 b(The)12 b Fr(ReadW)m(riteLock)g Fs(implementation)f(favors)h(writers)0
381 y(\(i.e.,)g(if)g(queues)e(of)h(readers)h(and)f(writers)g(both)f(exist,)g
(writers)h(will)f(always)h(be)g(favored.\))71 437 y(Note)h(that)g(we)g
(expect)h(these)f(locking)f(operations)g(to)h(be)h(used)f(in)g(a)h
(multiprocessor)e(environment,)h(although)f(we)0 494 y(have)f(not)f(yet)h
(used)f(them)i(for)f(this)f(purpose.)15 b(Protocol)9 b(developers)g(working)g
(in)g(an)h(MP)h(environment)e(should)g(attempt)0 550 y(to)h(adhere)g(to)g
(this)f(interface.)16 b(However)n(,)11 b(we)f(consider)f(locking)g(on)g(an)h
(MP)h(to)f(be)g(an)g(unresolved)f(issue,)h(and)g(so)f(we)h(are)0
606 y(eager)i(to)e(hear)i(about)e(experiences)h(using)f(these)h(operations)f
(in)g(such)h(an)g(environment.)0 729 y Fo(7.4.1)45 b(rwLockInit)0
816 y Fs(Initializes)10 b(the)h(lock)f(for)i(subsequent)d(operations.)71
897 y Fm(v)o(oid)h Fl(rwLo)r(c)n(kInit)g Fs(\()p Fm(ReadW)m(riteLo)q(c)o(k)h
Fs(*\))0 1020 y Fo(7.4.2)45 b(rwLockDestr)o(oy)0 1107 y Fs(All)8
b(threads)h(waiting)e(on)i(this)e(lock)i(will)f(be)h(released)g(and)f(their)h
(locking)e(operations)h(will)f(return)i Fr(XK)p 1629 1107 14
2 v 17 w(F)-6 b(AILURE)p Fs(.)8 b(When)0 1164 y(both)i(the)h(reader)g(and)g
(writer)g(queue)f(are)i(empty)m(,)f(the)g(user)o(-supplied)e(RwlDestroyFunc)h
(will)f(be)i(called)g(with)f(a)h(pointer)0 1220 y(to)g(the)g(lock)f(and)h
(the)g Fr(void)p Fs(*)g(ar)o(gument.)71 1301 y Fm(v)o(oid)f
Fl(rwLo)r(c)n(kDestro)n(y)g Fs(\()i Fm(ReadW)m(riteLo)q(c)o(k)f
Fs(*,)g Fm(RwlDestro)o(yF)m(unc)p Fs(,)h Fm(v)o(oid)e Fs(*\))71
1383 y Fm(t)o(yp)q(edef)k(v)o(oid)d Fs(\()p Fl(*RwlDestro)n(yF)-5
b(unc)11 b Fs(\))h(\()f Fm(ReadW)m(riteLo)q(c)o(k)g Fs(*,)g
Fm(v)o(oid)g Fs(*)g(\);)0 1505 y Fo(7.4.3)45 b(r)o(eaderLock)0
1592 y Fs(Acquire)14 b(a)h(reader)g(lock.)26 b(Many)15 b(readers)g(may)g
(hold)e(the)h(lock)g(at)h(one)f(time,)i(but)e(no)g(writers)g(will)f(acquire)i
(the)f(lock)0 1649 y(while)c(at)i(least)e(one)h(reader)h(holds)e(the)h(lock.)
16 b(W)n(ill)11 b(return)g Fr(XK)p 1008 1649 V 16 w(F)-6 b(AILURE)11
b Fs(if)g(the)g(lock)g(was)g(destroyed)f(before)i(the)f(lock)0
1705 y(was)g(acquired.)71 1787 y Fm(xk)o(ern)p 173 1787 13
2 v 15 w(return)p 300 1787 V 16 w(t)h Fl(readerLo)r(c)n(k)d
Fs(\()j Fm(ReadW)m(riteLo)q(c)o(k)f Fs(*)g(\))0 1909 y Fo(7.4.4)45
b(r)o(eaderUnlock)0 1996 y Fs(Releases)11 b(a)h(reader)g(lock.)k(It)11
b(is)g(an)g(error)h(to)e(call)h Fr(r)n(eaderUnlock)g Fs(without)e(holding)g
(a)j(reader)g(lock.)71 2078 y Fm(v)o(oid)e Fl(readerUnlo)r(c)n(k)g
Fs(\()h Fm(ReadW)m(riteLo)q(c)o(k)g Fs(*)g(\))0 2200 y Fo(7.4.5)45
b(writerLock)0 2287 y Fs(Acquire)9 b(a)h(writer)f(lock.)15
b(While)9 b(a)h(writer)f(lock)f(is)h(held,)h(no)f(other)g(reader)h(or)f
(writer)g(may)h(acquire)f(the)g(lock.)16 b(W)n(ill)8 b(return)0
2344 y Fr(XK)p 61 2344 14 2 v 16 w(F)-6 b(AILURE)11 b Fs(if)g(the)g(lock)g
(was)g(destroyed)f(before)i(the)e(lock)h(was)g(acquired.)71
2425 y Fm(xk)o(ern)p 173 2425 13 2 v 15 w(return)p 300 2425
V 16 w(t)h Fl(writerLo)r(c)n(k)d Fs(\()j Fm(ReadW)m(riteLo)q(c)o(k)f
Fs(*)g(\))952 2753 y(40)p eop
%%Page: 41 41
40 bop 0 124 a Fo(7.4.6)45 b(writerUnlock)0 211 y Fs(Releases)11
b(a)h(writer)f(lock.)16 b(It)11 b(is)g(an)g(error)h(to)e(call)h
Fr(writerUnlock)f Fs(without)f(holding)h(a)h(writer)g(lock.)71
285 y Fm(v)o(oid)f Fl(writerUnlo)r(c)n(k)g Fs(\()h Fm(ReadW)m(riteLo)q(c)o(k)
g Fs(*)g(\))0 406 y Fn(7.5)50 b(Usage)13 b(Rules)0 493 y Fo(7.5.1)45
b(Scheduling)12 b(and)g(Pr)o(eemption)0 580 y Fs(The)g(currently)f(executing)
g(thread)h(gives)f(up)g(control)g(by)h(either)f(terminating)g(or)h(executing)
f(a)h Fr(semW)l(ait)e Fs(operation.)18 b(In)0 636 y(other)d(words,)h(the)f
Fr(x)p Fs(-kernel)h(does)e(not)h(preempt)g(threads;)i(threads)e(voluntarily)e
(give)h(up)h(control)g(of)g(the)g(processor)m(.)0 693 y(However)n(,)9
b(because)g(each)f(protocol)f(is)h(assumed)g(to)g(be)h(an)f(independent)f
(component,)h(protocols)f(are)i(written)e(to)h(assume)0 749
y(that)15 b(control)f(may)i(be)f(given)g(up)g(when)g(a)h(higher)e(or)i(lower)
f(level)g(protocol)f(is)g(invoked.)28 b(Therefore,)17 b(all)e(protocol-)0
805 y(protocol)8 b(operations)h(are)h(considered)f(to)g(have)h(the)f
(potential)f(to)i(cause)g(a)g(thread)f(switch,)g(and)h(all)f(data)h
(structures)f(must)0 862 y(be)i(\252secured\272)h(before)f(calling)f(such)h
(operations.)0 981 y Fo(7.5.2)45 b(Blocking)0 1068 y Fs(Although)15
b(the)i Fr(x)p Fs(-kernel)h(advocates)e(a)i(\252thread-per)o(-message\272)f
(model,)i(and)e(it)g(provides)f(primitives)g(for)h(blocking)0
1124 y(threads,)10 b(as)h(a)g(general)f(rule,)h(threads)f(should)f(not)g
(block)h(except)g(when)g(waiting)f(for)i(a)g(reply)f(in)g(an)g(RPC-like)h
(protocol.)0 1181 y(In)18 b(most)f(other)h(cases,)i(should)c(a)i(thread)g
(\(message\))h(not)e(be)h(able)f(to)h(proceed,)i(it)d(should)g(put)g(the)g
(message)h(in)g(a)0 1237 y(protocol-dependent)11 b(queue)i(and)g(return.)23
b(Later)n(,)14 b(another)f(thread)g(can)g(pick)g(the)g(message)h(up)e(out)h
(of)g(the)g(queue)g(and)0 1294 y(continue)d(processing)g(it.)71
1350 y(For)i(example,)i(when)e(an)g(incoming)f(thread/message)h(arrives)g(in)
g(IP)h(and)g(discovers)e(that)h(it)g(is)f(just)h(one)g(fragment)0
1407 y(of)h(a)h(lar)o(ger)g(datagram,)g(rather)g(than)f(blocking)e(the)i
(thread)g(and)h(wait)e(for)i(the)f(other)g(fragments)g(to)g(arrive,)h(the)f
(thread)0 1463 y(should)f(insert)i(the)f(fragment)i(into)e(a)h(reassembly)g
(buf)o(fer)g(and)g(return.)25 b(The)14 b(thread)f(that)h(delivers)f(the)h
(last)f(fragment)0 1519 y(will)d(then)h(reassemble)g(the)g(fragments)g(into)f
(a)i(single)e(datagram)h(and)g(continue.)0 1638 y Fo(7.5.3)45
b(External)12 b(Thr)o(eads)0 1725 y Fs(Where)c(the)f Fr(x)p
Fs(-kernel)h(is)f(embedded)g(in)g(another)g(operating)g(system,)h(there)f
(may)h(be)g(asynchronous)d(threads)i(representing)0 1782 y(device)17
b(drivers)f(or)h(user)f(requests)g(that)g(want)g(to)h(enter)g(the)f
Fr(x)p Fs(-kernel.)34 b(These)16 b(threads)g(must,)i(in)f(general,)h(acquire)
0 1838 y(the)e Fr(x)p Fs(-kernel)h(master)g(lock)f(\(i.e.,)j(enter)d(the)g
Fr(x)p Fs(-kernel)h(monitor\))f(with)f Fr(xk)p 1232 1838 14
2 v 17 w(master)p 1374 1838 V 15 w(lock)h Fs(before)h(performing)f(any)g
Fr(x)p Fs(-)0 1895 y(kernel)j(operations,)g(including)e(other)h(thread)h
(synchronization)d(operations.)39 b(\(This)17 b(isn')o(t)i(necessary)f(for)h
(normal)0 1951 y Fr(x)p Fs(-kernel)10 b(threads)e(because)i(threads)e
(started)h(by)g Fr(evSchedule)g Fs(acquire)g(the)g(master)h(lock)e
(automatically)g(when)h(they)g(start)0 2008 y(running.\))15
b(Unless)9 b(a)h(call)g(is)g(explicitly)e(documented)h(otherwise,)h(threads)f
(may)i(not)e(make)i Fr(x)p Fs(-kernel)f(system)g(or)g(library)0
2064 y(calls)h(without)e(holding)g(the)i(master)h(lock.)71
2121 y(A)f(thread)g(acquires)g(and)g(releases)g(the)g(master)g
Fr(x)p Fs(-kernel)h(lock)e(with)h(the)f(following)g(operations.)71
2194 y Fm(v)o(oid)g Fl(xk)p 221 2194 17 2 v 19 w(master)p 408
2194 V 19 w(lo)r(c)n(k)g Fs(\()i Fm(v)o(oid)e Fs(\))0 2286
y Fo(xk)p 51 2286 14 2 v 16 w(master)p 201 2286 V 16 w(unlock)71
2368 y Fm(v)o(oid)g Fl(xk)p 221 2368 17 2 v 19 w(master)p 408
2368 V 19 w(unlo)r(c)n(k)h Fs(\()g Fm(v)o(oid)g Fs(\))71 2459
y(Note)g(that)h(normal)g(protocols)e(should)h(not)g(use)h(these)g
(operations.)18 b(The)12 b(only)f(place)h(that)g(they)f(are)i(meaningful)f
(is)0 2516 y(in)h(anchor)g(protocols,)g(such)g(as)g(device)g(drivers)g(and)g
(application-level)e(interface,)j(that)f(have)g(to)g(transition)f(between)0
2572 y(the)h Fr(x)p Fs(-kernel)g(and)g(the)g(host)f(OS.)h(Also)f(note)h(that)
f(this)g(interface)h(is)g(not)f(part)h(of)g(the)g(of)o(\256cial)g
Fr(x)p Fs(-kernel)g(interface;)h(it)f(is)0 2629 y(internal)d(to)h(the)g
(current)g(implementation)f(of)h(the)g Fr(x)p Fs(-kernel.)952
2753 y(41)p eop
%%Page: 42 42
41 bop 0 124 a Fo(7.5.4)45 b(Thr)o(ead)13 b(T)l(urnar)o(ound)0
211 y Fs(Protocols)f(should)f(refrain)j(from)g(taking)d(threads)i(which)f
(are)i(shepherding)e(outgoing)e(messages)j(down)g(the)g(protocol)0
268 y(stack)i(and)h(turning)f(them)h(around)f(to)g(accompany)h(messages)g
(traveling)f(up)g(the)h(protocol)e(stack.)31 b(Since)16 b(protocols)0
324 y Fr(ar)n(e)h Fs(allowed)g(to)g(reverse)g(thread)g(direction)f(from)i
(incoming)e(to)h(outgoing,)g(allowing)f(turnaround)g(from)h(outgoing)0
381 y(to)h(incoming)f(could)h(lead)g(to)g(a)g(thread)g(caught)g(in)g(a)h
(recursive)f(loop.)37 b(If)19 b(an)f(outgoing)e(thread)i(needs)g(to)g(send)g
(a)0 437 y(message)i(back)g(up,)i(it)d(should)f(start)i(a)g(new)g(thread)f
(to)g(do)h(this.)41 b(The)20 b(push)f(routine)g(of)h(the)f(ethernet)h
(protocol)0 494 y(\()p Fi(/usr/xkernel/protocols/eth)p Fs(\))11
b(has)g(an)h(example)f(of)g(how)g(this)f(is)h(done.)0 616 y
Fo(7.5.5)45 b(Multipr)o(ocessor)11 b(Support)0 703 y Fs(T)m(o)e(date,)h(we)f
(do)g(not)f(have)h(signi\256cant)f(experience)h(running)f(the)h
Fr(x)p Fs(-kernel)g(on)g(a)h(multiprocessor)m(.)15 b(W)l(e)9
b(have)h(introduced)0 760 y(locking)h(operations)g(that)h(are)i(useful)e(in)g
(certain)h(situations)d(on)i(a)h(uniprocessor)n(,)f(and)h(while)e(these)i
(operations)e(might)0 816 y(extend)h(to)h(an)g(MP)g(environment,)g(we)g
(cannot)f(be)h(certain)g(that)f(they)h(will.)20 b(Moreover)n(,)14
b(we)f(certainly)g(expect)f(that)g(the)0 873 y(implementation)7
b(of)i(both)e(the)i(locking)e(and)h(the)h(semaphore)f(operations)g(will)f
(need)i(to)f(change)g(in)h(an)f(MP)i(environment,)0 929 y(even)h(if)g(the)g
(interface)h(remains)f(the)g(same.)71 985 y(It)h(should)g(be)g(noted)g(that)h
(the)f Fr(x)p Fs(-kernel,)i(as)f(currently)f(implemented,)h(is)g(MP-safe,)h
(although)d(probably)h(not)g(MP-)0 1042 y(performant.)38 b(This)17
b(is)h(because)g(all)g(threads)f(executing)g(in)h(the)g Fr(x)p
Fs(-kernel)g(must)g(\256rst)g(aquire)g(a)h(master)f(lock;)j(i.e.,)0
1098 y(the)c Fr(x)p Fs(-kernel)g(is)g(currently)f(implemented)h(as)g(a)g
(single)f(monitor)m(.)34 b(Our)17 b(experience)g(suggests,)g(however)n(,)i
(that)d(this)0 1155 y(implementation)10 b(is)g(reasonably)h(ef)o(\256cient)g
(a)h(small)f(number)g(of)g(processors.)952 2753 y(42)p eop
%%Page: 43 43
42 bop 0 124 a Ft(8)60 b(T)l(race)13 b(Library)0 228 y Fs(The)7
b(trace)g(library)g(provides)g(a)g(facility)g(for)g(tracing)g(system)g
(events.)12 b(Most)7 b(importantly)m(,)f(the)h(library)g(allows)g(conditio)o
(nal)0 284 y(printing)i(in)i Fr(printf)e Fs(format)j(of)f(statements)f
(taking)g(from)i(zero)g(to)f(six)f(variables.)0 408 y Fn(8.1)50
b(T)l(ype)13 b(De\256nitions)0 495 y Fs(The)8 b(current)h(value)f(of)h(the)f
(tracing)g(variable)g Fr(tracevar)g Fs(is)g(used)g(to)g(control)g(whether)g
(or)h(not)e(a)i(particular)f(trace)h(operation)0 552 y(takes)h(place.)16
b(The)10 b(trace)h(variable)f(values)g(can)g(be)h(set)f(at)g(system)g(build)f
(time;)h(see)h(section)e(13.)16 b(The)10 b(following)e(de\256ned)0
608 y(constants)i(are)h(suggestive)f(of)h(how)g(to)f(use)h(trace)h(levels:)
102 714 y(TR)p 163 714 14 2 v 17 w(NEVER)398 b(for)12 b(debugging)d
(statements)h(that)h(are)h(unused)e(\(noop\))102 771 y(TR)p
163 771 V 17 w(FULL)p 294 771 V 16 w(TRACE)271 b(every)12 b(subroutine)d
(entry)i(and)g(exit)102 827 y(TR)p 163 827 V 17 w(DET)l(AILED)328
b(all)11 b(functions)f(plus)g(dumps)g(of)i(data)f(structures)f(at)h
(strategic)f(points)102 884 y(TR)p 163 884 V 17 w(FUNCTIONAL)p
471 884 V 15 w(TRACE)95 b(all)11 b(the)g(functions)f(of)h(the)g(module)f(and)
h(their)g(parameters)102 940 y(TR)p 163 940 V 17 w(MORE)p 311
940 V 16 w(EVENTS)228 b(even)11 b(more)h(detail)f(on)f(events)102
997 y(TR)p 163 997 V 17 w(EVENTS)375 b(more)12 b(detail)e(than)h(major)g
(events)102 1053 y(TR)p 163 1053 V 17 w(SOFT)p 291 1053 V 16
w(ERROR)272 b(mild)11 b(warnings)102 1110 y(TR)p 163 1110 V
17 w(MAJOR)p 334 1110 V 16 w(EVENTS)205 b(open,)11 b(close,)g(etc.)102
1166 y(TR)p 163 1166 V 17 w(GROSS)p 326 1166 V 17 w(EVENTS)212
b(the)11 b(coarsest)g(tracing)g(level)102 1223 y(TR)p 163 1223
V 17 w(ERRORS)374 b(serious)10 b(non-fatal)h(errors;)g(some)g(residual)f
(event)h(traces)102 1279 y(TR)p 163 1279 V 17 w(AL)m(W)-5 b(A)l(YS)367
b(normally)11 b(only)f(used)h(during)f(protocol)g(development)0
1403 y Fn(8.2)50 b(Operations)0 1490 y Fo(8.2.1)45 b(xT)m(race)0
1577 y Fs(The)14 b Fr(xT)m(race)p Ff(n)i Fs(macro)f(takes)f
Fg(n)h Fs(ar)o(guments)f(in)g(addition)f(to)h(the)g(variables)f
Fr(tracevar)p Fs(,)i Fr(tracelevel)p Fs(,)g(and)f Fr(formatstring)p
Fs(.)0 1634 y Fr(tracevar)h Fs(is)g(a)h(name)g(associated)f(with)f(the)i
(variable)f(being)g(traced.)30 b Fr(tracelevel)15 b Fs(is)g(compared)h(to)f
(the)h(value)f(of)g(the)0 1690 y(trace)d(variable)f(to)g(determine)h(at)f
(runtime)h(if)f(the)g(trace)i(statement)e(should)e(be)j(printed.)17
b Fr(formatstrin)o(g)9 b Fs(is)i(a)h Fr(printf)p Fs(-style)0
1747 y(formatting)e(statement.)71 1803 y(Each)e(protocol)e(has)i(a)g(trace)h
(variable)e(based)h(on)f(the)h(protocol)f(name)h(with)f(\252p\272)h
(appended;)g(e.g.)16 b(udp)8 b(has)f Fr(traceudpp)p Fs(.)0
1860 y(In)20 b(addition)e(to)i(protocol)e(tracing,)k(there)e(are)h
Fr(x)p Fs(-kernel)f(trace)g(variables)g(for)g(subsystems:)31
b(init,)22 b(processswitch,)0 1916 y(protocol,)16 b(processcreation,)h
(cksum,)g(event,)g(system,)g(msg,)h(ptbl,)e(and)g(sessn.)30
b(Most)16 b(of)g(these)g(are)g(de\256ned)g(in)g(\256le)0 1973
y Fi(xkernel/include/xk)p 364 1973 V 17 w(debug.h)p Fs(.)71
2029 y(Note)9 b(that)h(the)g(trace)h(facility)e(automatically)g(supplies)f(a)
j(newline)e(at)h(the)g(end)h(of)f(the)g(trace)h(message;)f(the)g(supplied)0
2085 y(format)g(string)f(need)h(not.)16 b(Also,)9 b(note)h(that)f(there)h
(should)f(be)h(no)g(whitespace)f(preceding)g(a)i(trace)f(variable)g(name)h
(in)e(any)0 2142 y(tracing)i(statement.)16 b(Whitespace)10
b(will)g(cause)h(errors)h(in)e(the)h(macro)h(expansion)e(and)h(result)f(in)h
(compilation)f(errors.)71 2223 y Fl(xT)-5 b(race)p Fr(n)p Fs(\()p
Fm(in)o(t)10 b Fh(tracevar)p Fs(,)h Fm(in)o(t)g Fh(tracelevel)p
Fs(,)h Fm(c)o(har)g Fs(*)p Fh(formatstring)p Fs(,)f Fh(ar)o(gs,)i(...)18
b Fs(\))0 2305 y(For)11 b(example:)0 2411 y Fg(int)28 b(traceudpp;)82
2524 y(xTrace2\(udpp,)j(TR_ERRORS,)f("input)f(port)f(\045d)g(output)h(port)f
(\045d",)g(inp,)h(outp\);)952 2753 y Fs(43)p eop
%%Page: 44 44
43 bop 0 124 a Fo(8.2.2)45 b(xIfT)m(race)0 211 y Fs(If)8 b(the)g
Fr(tracelevel)f Fs(is)g(less)g(than)g(or)h(equal)f(to)g(the)h(value)f(of)h
(the)f Fr(tracevar)p Fs(,)h(then)f(execute)h(the)f(statement)g(directly)g
(following.)71 349 y Fl(xIfT)-5 b(race)10 b Fs(\()p Fm(in)o(t)h
Fh(tracevar)p Fs(,)h Fm(in)o(t)f Fh(tracelevel)p Fs(\))0 430
y(For)g(example:)218 537 y Fg(int)28 b(traceudpp;)218 650 y(xIfTrace\(udpp)q
(,)i(TR_ERRORS\))436 706 y(dump_header\()q(\);)0 829 y Fo(8.2.3)45
b(xAssert)0 916 y Fs(If)12 b(the)f(expression)e Fr(exp)j Fs(evaluates)e(to)h
(F)m(ALSE,)g(the)g Fr(x)p Fs(-kernel)h(will)e(print)g(a)i(message)f(and)g
(halt.)71 997 y Fl(xAssert)f Fs(\()p Fm(b)q(o)q(ol)h Fh(exp)p
Fs(\))0 1120 y Fo(8.2.4)45 b(xErr)o(or)0 1207 y Fs(Non-fatal)11
b(error)g(conditions)e(can)i(print)g(warnings)f(even)h(in)g(nondebugging)d
(mode)j(by)g(using)f(the)h Fr(xErr)n(or)f Fs(call.)71 1288
y Fl(xError)g Fs(\()p Fm(c)o(har)k(*)d Fh(Err)o(orString)p
Fs(\))0 1412 y Fn(8.3)50 b(Usage)13 b(Rules)0 1499 y Fs(T)n(race)21
b(and)e(assert)h(statements)e(are)j(macros)f(which)f(are)h(only)f(active)g
(in)g(DEBUG)h(mode)g(\(see)g(section)e(13\).)42 b(In)0 1556
y(OPTIMIZE)14 b(mode,)h(debugging)d(and)i(trace)h(statements)e(go)g(away)h
(completely)m(.)25 b(One)13 b(should)g(keep)h(this)f(in)g(mind)h(to)0
1612 y(avoid)c(bugs)h(that)f(show)g(up)h(only)f(in)h(OPTIMIZE)h(mode.)k(For)c
(example,)g(the)f(statment:)218 1719 y Fg(xAssert\()30 b(mapResolve\(map,)h
(key,)d(&p\))g(==)g(XK_SUCCESS)i(\);)0 1825 y Fs(will)12 b(have)h(no)f(ef)o
(fect)i(in)e(OPTIMIZE)h(mode.)22 b(One)13 b(should)e(be)i(careful)g(to)g
(separate)g(the)f(operation)g(and)h(the)f(check)h(of)0 1881
y(the)e(return)g(code:)218 1988 y Fg(res)28 b(=)g(mapResolve\(map)q(,)i(key,)
f(&p\);)218 2044 y(xAssert\()h(res)e(==)g(XK_SUCCESS)i(\);)71
2150 y Fs(If)13 b(you)f(are)h(writing)f(a)h(new)f(protocol,)g(you)h(should)e
(insert)h(trace)h(statements.)20 b(Even)13 b(though)e(there)i(will)e(never)i
(be)0 2207 y(bugs)c(left)i(after)f(you)g(release)h(your)f(protocol,)f(it)h
(may)h(help)f(others)f(in)h(debugging)f(their)g(protocol)g(which)h(sits)f(on)
h(top)g(of,)0 2263 y(or)h(below)m(,)g(yours.)16 b(Don')o(t)10
b(delete)h(these)g(very)g(helpful)f(debugging)g(libraries)g(when)h(you)f(are)
i(done.)952 2753 y(44)p eop
%%Page: 45 45
44 bop 0 124 a Ft(9)60 b(Utility)13 b(Routines)0 229 y Fn(9.1)50
b(Storage:)17 b(xMalloc)12 b(and)g(xFr)o(ee)0 316 y Fs(These)f(are)i(just)d
(like)h(Unix)g(malloc)h(and)f(free)i(functions.)j(The)11 b
Fr(xMalloc)g Fs(function)g(will)f(cause)i(an)g Fr(x)p Fs(-kernel)g(abort)f
(if)h(no)0 373 y(storage)f(is)f(available;)g(therefore,)i(it)f(has)g(no)g
(error)g(return)g(value.)71 451 y Fm(c)o(har)g Fl(*xMallo)r(c)p
Fs(\()p Fm(in)o(t)f Fh(size)p Fs(\))71 586 y Fm(in)o(t)h Fl(xF)-5
b(ree)p Fs(\()p Fm(c)o(har)11 b Fs(*)p Fh(buf)p Fs(\))0 709
y Fn(9.2)50 b(T)o(ime)0 796 y Fs(The)11 b Fr(x)p Fs(-kernel)h(uses)e(the)h
(same)h(time)f(structure)f(as)i(Unix:)102 893 y Fm(t)o(yp)q(edef)j(struct)e
Fk(f)295 949 y Fm(long)e Fs(sec;)295 1005 y Fm(long)g Fs(usec;)102
1062 y Fk(g)g Fl(XTime)f Fs(;)0 1240 y Fo(9.2.1)45 b(xGetT)o(ime)0
1327 y Fs(Set)11 b Fr(*t)g Fs(to)g(the)g(current)g(time)g(of)g(day:)71
1405 y Fm(v)o(oid)f Fl(xGetTime)e Fs(\()p Fm(XTime)i Fs(*)p
Fh(t)p Fs(\))0 1526 y Fo(9.2.2)45 b(xAddT)o(ime)0 1613 y Fs(Sets)12
b(the)f Fr(r)n(es)h Fs(to)g(the)f(sum)h(of)g Fr(t1)f Fs(and)h
Fr(t2.)18 b Fs(Assumes)11 b Fr(t1)g Fs(and)h Fr(t2)f Fs(are)i(in)e(standard)g
(time)h(format)g(\(i.e.,)i(does)d(not)g(check)h(for)0 1670
y(integer)f(over\257ow)g(of)g(the)g(usec)g(value.\))71 1748
y Fm(v)o(oid)f Fl(xAddTime)f Fs(\()p Fm(XTime)i Fs(*)p Fh(r)o(es)p
Fs(,)g Fm(XTime)f Fh(t1)p Fs(,)i Fm(XTime)e Fh(t2)p Fs(\))0
1870 y Fo(9.2.3)45 b(xSubT)o(ime)0 1957 y Fs(Sets)11 b(the)g
Fr(r)n(es)g Fs(to)g(the)g(dif)o(ference)h(of)f Fr(t1)g Fs(and)g
Fr(t2.)16 b Fs(The)11 b(resulting)e(value)i(may)h(be)f(negative.)71
2035 y Fm(v)o(oid)f Fl(xSubTime)f Fs(\()p Fm(XTime)h Fs(*)p
Fh(r)o(es)p Fs(,)i Fm(XTime)e Fh(t1)p Fs(,)i Fm(XTime)e Fh(t2)p
Fs(\))0 2180 y Fn(9.3)50 b(Byte)12 b(Order:)18 b(ntohs,)12
b(ntohl,)g(ntons,)g(and)f(htonl)0 2267 y Fs(The)g(byte)g(order)g(functions)e
(are)j(the)f(same)h(as)f(the)g(Unix)f(functions.)102 2386 y
Fm(u)p 127 2386 13 2 v 15 w(short)i Fl(n)n(tohs)p Fs(\()p Fm(u)p
416 2386 V 16 w(short)g Fh(n)p Fs(\))102 2442 y Fm(u)p 127
2442 V 15 w(long)f Fl(n)n(tohl)p Fs(\()p Fm(u)p 394 2442 V
15 w(long)f Fh(n)p Fs(\))102 2499 y Fm(u)p 127 2499 V 15 w(short)i
Fl(h)n(tons)p Fs(\()p Fm(u)p 416 2499 V 16 w(short)g Fh(n)p
Fs(\))102 2555 y Fm(u)p 127 2555 V 15 w(long)f Fl(h)n(tonl)p
Fs(\()p Fm(u)p 394 2555 V 15 w(long)f Fh(n)p Fs(\))952 2753
y(45)p eop
%%Page: 46 46
45 bop 0 124 a Fn(9.4)50 b(Checksum)0 211 y Fo(9.4.1)45 b(inCkSum)0
298 y Fs(Calculate)11 b(a)h(16-bit)e(1')m(s)h(complement)h(checksum)f(over)g
(the)g(buf)o(fer)h Fr(*buf)e Fs(\(of)h(length)g Fr(len)p Fs(\))g(and)g(the)g
(msg)g Fr(*m)p Fs(,)g(returning)0 355 y(the)f(bit)g(complement)h(of)g(the)f
(sum.)17 b Fr(len)10 b Fs(should)f(be)i(even)g(and)g(the)f(buf)o(fer)h(must)f
(be)h(aligned)f(on)g(a)i(16-bit)d(boundary)m(.)15 b Fr(len)0
411 y Fs(may)d(be)f(zero.)71 493 y Fm(u)p 96 493 13 2 v 15
w(short)h Fl(inCkSum)e Fs(\()p Fm(Msg)h Fs(*)p Fh(m)p Fs(,)h
Fm(u)p 666 493 V 15 w(short)g Fs(*)p Fh(buf)p Fs(,)e Fm(in)o(t)h
Fh(len)p Fs(\);)0 615 y Fo(9.4.2)45 b(ocsum)0 702 y Fs(Return)14
b(the)g(1')m(s)g(complement)g(sum)g(of)g(the)f Fr(count)g Fs(16-bit)g(words)g
(pointed)g(to)g(by)h Fr(hdr)p Fs(,)g(which)g(must)f(be)h(aligned)f(on)h(a)0
759 y(16-bit)c(boundary)m(.)71 840 y Fm(u)p 96 840 V 15 w(short)i
Fl(o)r(csum)d Fs(\()j Fm(u)p 430 840 V 15 w(short)g Fs(*)p
Fh(hdr)p Fs(,)f Fm(in)o(t)g Fh(count)p Fs(\);)0 964 y Fn(9.5)50
b(Strings)12 b(to)g(Hosts)0 1051 y Fs(Utility)6 b(routines)g(exist)h(for)i
(converting)d(from)j(string)d(representations)h(of)h(IP)g(and)g(Ethernet)f
(addresses)g(to)h(their)f(structural)0 1108 y(counterparts)j(and)h
(vice-versa.)0 1230 y Fo(9.5.1)45 b(ipHostStr)0 1317 y Fs(Returns)11
b(a)h(string)f(with)g(a)h(\252dotted-decimal\272)f(representation)f(of)i(IP)g
(host)f Fr(h)h Fs(\(e.g.,)h(\252192.12.69.1\272\))e(This)g(string)f(is)i(in)f
(a)0 1374 y(static)f(buf)o(fer)n(,)i(so)f(it)g(must)g(be)g(copied)f(if)i(its)
e(value)h(is)f(to)h(be)g(preserved.)71 1455 y Fm(c)o(har)j(*)d
Fl(ipHostStr)g Fs(\()g Fm(IPhost)h Fs(*)p Fh(h)f Fs(\))0 1578
y Fo(9.5.2)45 b(str2ipHost)0 1665 y Fs(Interprets)10 b Fr(str)h
Fs(as)g(a)g(\252dotted-decimal\272)g(representation)f(of)h(an)g(IP)h(host)e
(and)h(assigns)e(the)i(\256elds)g(of)g Fr(h)g Fs(accordingly)m(.)k(The)0
1721 y(operation)10 b(fails)h(if)g Fr(str)f Fs(does)h(not)f(seem)i(to)f(be)g
(in)g(dotted-decimal)f(form.)71 1803 y Fm(xk)o(ern)p 173 1803
V 15 w(return)p 300 1803 V 16 w(t)i Fl(str2ipHost)e Fs(\()i
Fm(IPhost)g Fs(*)p Fh(h)p Fs(,)f Fm(c)o(har)26 b Fs(*)p Fh(str)11
b Fs(\))0 1925 y Fo(9.5.3)45 b(ethHostStr)0 2012 y Fs(Returns)14
b(a)g(string)f(with)g(a)h(representation)f(of)h(Ethernet)f(host)g
Fr(h)h Fs(\(e.g.,)i(\2528:0:2b:ef:23:11)o(\272\))c(This)h(string)g(is)g(in)h
(a)g(static)0 2069 y(buf)o(fer)n(,)e(so)f(it)g(must)f(be)i(copied)e(if)h(its)
g(value)f(is)h(to)g(be)g(preserved.)71 2150 y Fm(c)o(har)j(*)d
Fl(ethHostStr)f Fs(\()i Fm(ETHhost)g Fs(*)p Fh(h)f Fs(\))0
2273 y Fo(9.5.4)45 b(str2ethHost)0 2360 y Fs(Interprets)12
b Fr(str)g Fs(as)g(a)h(six-hex-digit-colon)o(-separated)d(representation)h
(of)i(an)f(Ethernet)g(host)f(and)i(assigns)e(the)h(\256elds)g(of)0
2416 y Fr(h)f Fs(accordingly)m(.)k(The)d(operation)e(fails)g(if)h
Fr(str)g Fs(does)f(not)h(seem)h(to)e(be)i(in)e(the)h(correct)h(format.)71
2498 y Fm(xk)o(ern)p 173 2498 V 15 w(return)p 300 2498 V 16
w(t)g Fl(str2ethHost)e Fs(\()i Fm(ETHhost)g Fs(*)p Fh(h)p Fs(,)f
Fm(c)o(har)26 b Fs(*)p Fh(str)11 b Fs(\))952 2753 y(46)p eop
%%Page: 47 47
46 bop 0 124 a Ft(10)74 b(Contr)o(ol)15 b(Operations)0 228
y Fs(Control)e(operations)e(are)k(used)e(to)f(perform)i(arbitrary)g
(operations)e(on)h(protocols)e(and)j(sessions.)21 b(Control)13
b(operations)0 284 y(return)d(an)h(integer)f(that)f(indicates)g(the)i(length)
e(in)h(bytes)f(of)i(the)f(information)f(which)h(was)g(written)g(into)f(the)h
(buf)o(fer)n(,)i(or)e(-1)0 340 y(to)h(indicate)f(an)h(error)m(.)71
397 y(All)j(implementations)e(of)j(control)f(operations)f(should)g(check)i
(the)f(length)g(\256eld)g(before)h(reading)g(or)f(writing)f(the)0
453 y(buf)o(fer)n(,)g(returning)e(-1)h(if)g(the)f(buf)o(fer)i(is)e(too)g
(small.)19 b(The)11 b Fi(checkLen\(actualLength,)16 b(expectedLength\))d
Fs(macro)g(can)0 510 y(be)e(used)g(for)g(this.)71 566 y(There)c(are)i(two)e
(\252classes\272)h(of)f(operations:)13 b(standard)7 b(ones)g(that)g(may)i(be)
e(implemented)h(by)f(more)h(than)g(one)f(protocol,)0 623 y(and)k
(protocol-speci\256c)f(ones.)0 747 y Fn(10.1)62 b(Standard)11
b(Contr)o(ol)h(Operations)0 834 y Fo(10.1.1)56 b(Pr)o(otocol)11
b(and)h(Session)f(Operations)0 921 y Fs(These)g(operations)f(can)h(be)g
(performed)h(on)f(both)f(sessions)f(and)i(protocols.)114 1027
y(GETMYHOST)m(,)f(GETMYHOSTCOUNT)214 1121 y(When)g(used)g(on)g(a)h(protocol,)
e(GETMYHOST)h(asks)g(for)g(all)g(possible)f(host)g(addresses)h(for)h(the)214
1178 y(local)e(host.)16 b(When)10 b(used)f(on)h(a)h(session,)e(GETMYHOST)h
(asks)g(for)g(the)g(local)g(host)f(addresses)214 1234 y(actually)i(being)g
(used)h(on)f(the)h(connection.)18 b(If)13 b(the)e(buf)o(fer)i(is)f(too)f
(small)h(for)g(all)g(of)g(the)g(hosts,)214 1290 y(GETMYHOST)e(will)f(write)h
(as)g(many)h(hosts)e(as)h(the)h(buf)o(fer)f(allows)g(\(GETMYHOST)g(with)f(a)
214 1347 y(buf)o(fer)k(lar)o(ge)g(enough)f(to)g(hold)g(one)h(host)f(will)f
(return)i(the)f(most)h(common)g(or)g(default)f(host.\))214
1403 y(GETMYHOSTCOUNT)17 b(asks)h(for)h(the)g(number)f(of)h(hosts)e(which)h
(will)g(be)h(returned)f(by)214 1460 y(GETMYHOST)m(.)114 1554
y(GETMAXP)l(ACKET)m(,)10 b(GET)o(OPTP)l(ACKET)214 1647 y(T)n(reats)15
b(the)g(buf)o(fer)h(as)g(a)f(pointer)g(to)g(an)g(integer)g(and)g(sets)g(it)g
(to)g(the)g(length)f(of)i(the)f(longest)214 1704 y(message)c(that)f(the)g
Fr(XObj)g Fs(can)h(deliver)f(\(GETMAXP)l(ACKET\))g(or)h(the)f(length)g(of)h
(the)f(longest)214 1760 y(message)d(that)g(can)g(be)g(delivered)g(witho)o(ut)
g(fragmentati)o(on)g(\(GET)n(OPTP)l(ACKET)m(.\))g(A)g(pro)o(tocol)214
1817 y(typically)f(implements)h(this)g(operation)f(by)i(querying)f(the)g
(lower)h Fr(XObj)p Fs(s)e(and)i(then)f(subtracting)214 1873
y(its)j(header)h(length.)214 1951 y(Although)h(GETMAXP)l(ACKET)i(and)h(GET)o
(OPTP)l(ACKET)f(can)h(be)g(performed)h(on)e(proto-)214 2007
y(cols,)i(it)f(is)g(preferable)h(to)f(use)g(them)g(on)g(sessions,)g(since)g
(dif)o(ferent)h(sessions)d(of)j(the)f(same)214 2063 y(protocol)10
b(may)h(return)g(dif)o(ferent)g(values.)114 2157 y(RESOL)l(VE,)g(RRESOL)l(VE)
214 2251 y(These)d(operations)e(map)j(high-level)e(addresses)g(into)g
(low-level)g(addresses)h(\(RESOL)l(VE\))g(and)214 2307 y(vice)j(versa)g
(\(RRESOL)l(VE.\))0 2430 y Fo(10.1.2)56 b(Session)11 b(Operations)114
2517 y Fs(GETPEERHOST)m(,)f(GETPEERHOSTCOUNT)952 2753 y(47)p
eop
%%Page: 48 48
47 bop 214 124 a Fs(GETPEERHOST)13 b(returns)g(the)g(host)g(addresses)g(of)g
(all)h(peers)f(of)h(a)g(session.)23 b(It)13 b(is)g(an)h(error)214
181 y(to)d(submit)h(a)g(buf)o(fer)h(that)e(is)h(too)f(small)h(for)h(all)f(of)
g(the)g(peer)g(hosts,)g(and)g(-1)g(will)f(be)i(returned.)214
237 y(GETPEERHOSTCOUNT)h(asks)g(for)i(the)f(number)g(of)g(hosts)f(which)h
(will)f(be)h(returned)g(by)214 294 y(GETPEERHOST)m(.)114 387
y(GETMYPROT)o(O,)c(GETPEERPROT)o(O)214 481 y(T)n(reats)j(the)g(buf)o(fer)h
(as)g(a)f(pointer)g(to)g(a)g(long)g(and)g(sets)g(it)f(to)h(the)h(local)e(or)i
(remote)g(\252protocol)214 538 y(number)r(\272)j(of)h(the)f(session.)37
b(For)18 b(example,)j(UDP)e(returns)f(the)g(local)g(UDP)g(port)g(from)h(a)214
594 y(GETMYPROT)o(O)11 b(operation.)114 688 y(GETP)l(AR)m(TICIP)l(ANTS)214
782 y(T)n(reats)h(the)g(buf)o(fer)h(as)f(a)h(simple)e(array)i(of)f(bytes.)19
b(The)12 b(lower)g(session)f(creates)h(a)h(participant)214
838 y(list)e(with)g(data)i(that)f(was)g(used)g(to)g(open)g(the)h(session.)19
b(This)11 b(participant)g(list)h(is)g(then)g(written)214 895
y(into)e(the)i(control)f(buf)o(fer)h(using)e Fr(partExternalize)f
Fs(\(see)j(section)f(3.\))18 b(The)12 b(caller)g(will)e(have)i(to)214
951 y(run)f Fr(partInternali)o(ze)e Fs(on)h(the)h(buf)o(fer)h(before)f(it)g
(can)h(be)f(used)f(as)i(a)f(participant)f(list.)214 1016 y(Sessions)17
b(typically)f(implement)i(this)g(control)f(op)h(by)g(\256rst)g(executing)f
(it)h(on)g(their)g(lower)214 1072 y(session.)f(If)12 b(their)g(protocol)e
(uses)i(information)e(on)i(participant)e(stacks,)i(they)f(then)h(run)f
Fr(part-)214 1129 y(Internalize)f Fs(on)h(the)h(buf)o(fer)n(,)h(push)d(their)
i(protocol-speci\256c)e(information)h(on)g(the)h(participant)214
1185 y(stacks,)e(and)h(then)g(re-externalize)g(the)g(participant)f(list)g
(into)g(the)h(buf)o(fer)m(.)114 1279 y(FREERESOURCES)214 1373
y(T)n(reats)j(the)f(buf)o(fer)h(as)g(a)g(pointer)f(to)g(an)h
Fr(xmsg)p 965 1373 14 2 v 16 w(handle)p 1106 1373 V 15 w(t)p
Fs(.)25 b(This)12 b(value)i(is)f(interpreted)g(as)h(the)214
1429 y(result)c(of)h(a)h(previous)e Fr(xPush)g Fs(and)h(frees)h(the)f
(resources)g(associated)f(with)g(that)h(message.)114 1523 y(SETNONBLOCKINGIO)
214 1617 y(T)n(reats)19 b(the)h(buf)o(fer)g(as)f(a)h(pointer)e(to)i(an)f
Fr(int)g Fs(\(non-zero)g(==)g(TRUE.\))h(This)f(operation)f(is)214
1673 y(interpreted)k(by)g(sessions)f(which)i(do)f(output)f(buf)o(fering.)52
b(Such)23 b(sessions)e(may)i(block)214 1730 y(threads)18 b(executing)g(an)h
(xPush)g(until)f(suf)o(\256cient)g(buf)o(fer)i(space)f(is)g(available)f(to)h
(hold)f(the)214 1786 y(outgoing)c(message.)32 b(If)16 b
(SETNONBLOCKINGIO\(true\))g(is)g(performed)g(on)g(such)g(a)h(ses-)214
1843 y(sion,)k(a)g(thread)f(which)f(would)g(normally)h(block)f(in)h(such)f(a)
i(situation)d(returns)h(with)g(an)214 1899 y(XMSG)p 348 1899
V 16 w(ERR)p 452 1899 V 17 w(WOULDBLOCK)11 b(message)g(handle)g(instead.)0
2024 y Fn(10.2)62 b(Pr)o(otocol-Speci\256c)12 b(Contr)o(ol)f(Operations)0
2111 y Fs(Protocol-speci\256c)h(opcodes)h(are)h(de\256ned)f(relative)f(to)h
(an)g(identi\256er)g(that)f(has)h(been)g(assigned)f(to)h(each)h(protocol.)21
b(For)0 2167 y(example,)c(the)e(protocol)f(ARP)i(has)f(been)h(assigned)e(the)
h(id)g Fi(ARP)p 1092 2167 V 17 w(CTL)p Fs(.)g(Individual)f(opcodes)g(are)i
(then)f(de\256ned)g(\(in)0 2223 y Fi(arp.h)p Fs(\))d(as)136
2330 y Fg(#define)30 b(ARP)p 439 2330 V 17 w(INSTALL)449 b(\(ARP)p
1202 2330 V 17 w(CTL*MAXOPS)30 b(+)e(0\))136 2386 y(#define)i(ARP)p
439 2386 V 17 w(IPINTERFACES)314 b(\(ARP)p 1202 2386 V 17 w(CTL*MAXOPS)30
b(+)e(1\))136 2443 y(#define)i(ARP)p 439 2443 V 17 w(IPADDRS)449
b(\(ARP)p 1202 2443 V 17 w(CTL*MAXOPS)30 b(+)e(2\))0 2549 y
Fs(This)9 b(scheme)i(is)f(used)g(to)f(ensure)h(that)g(all)g(control)f
(opcodes)h(are)g(unique.)16 b(By)10 b(convention,)f(protocol-speci\256c)g
(opcodes)0 2605 y(de\256ned)k(by)f(protocol)f(XYZ)i(are)g(pre\256xed)g(with)e
Fi(XYZ)p 890 2605 V 17 w Fs(.)21 b(Also,)13 b(until)e(an)i(identi\256er)f
(has)g(been)h(assigned)e(to)h(a)i(protocol)952 2753 y(48)p
eop
%%Page: 49 49
48 bop 0 124 a Fs(you)11 b(are)h(writing)f(\(i.e.,)i Fi(upi.h)f
Fs(has)g(been)f(edited\),)h(you)f(can)h(use)f(a)i(set)e(of)h(temporary)f
(ids:)16 b Fi(TMP0)p 1592 124 14 2 v 17 w(CTL)p Fs(,)c Fi(TMP1)p
1839 124 V 17 w(CTL)p Fs(,)0 181 y(etc.)71 237 y(Protocol-speci\256c)e
(control)g(operations)g(are)i(described)e(in)h(the)g(manual)g(page)g(for)h
(each)f(protocol)f(in)h(appendix)f(A.)0 361 y Fn(10.3)62 b(Forwarding)12
b(Contr)o(ol)g(Operations)0 448 y Fs(There)e(are)h(several)f(situations)e
(where)i(an)g Fr(XObj)f Fs(may)i(not)e(be)h(prepared)h(to)e(handle)h(a)g
(control)f(operation.)15 b(For)c(example,)0 505 y(a)k(protocol-speci\256c)e
(control)g(operation)g(may)i(be)g(sent)e(through)g(several)i(intermediate)e
Fr(XObj)p Fs(s)g(in)h(a)h(graph)f(before)h(it)0 561 y(reaches)i(an)g
Fr(XObj)e Fs(that)h(understands)f(the)i(operation.)31 b(Because)17
b(of)g(this,)g Fr(XObj)p Fs(s)f(should)f(be)h(prepared)h(to)f(forward)0
618 y(control)10 b(operations)g(which)g(they)h(don')o(t)f(understand)g(or)h
(can')o(t)h(satisfy)e(to)h(their)f(lower)h Fr(XObj)p Fs(s.)952
2753 y(49)p eop
%%Page: 50 50
49 bop 0 124 a Ft(11)60 b(Refer)o(ence)12 b(Counting)j(XObjs)0
228 y Fs(V)-5 b(ersion)14 b(3.2)g(of)h(the)g Fr(x)p Fs(-kernel)g(maintains)e
(reference)j(counts)e(for)g(sessions)f(in)i(order)f(to)h(facilitate)e(their)i
(destruction.)0 284 y(The)10 b(following)f(implementation)g(notes)h(should)f
(guide)h(the)g(protocol)f(writer)i(towards)e(programming)i(techniques)e(that)
0 340 y(are)j(consistent)d(with)h(the)h(reference)i(count)d(mechanism.)71
397 y(In)h(v3.1,)h(the)f Fr(XObj)f Fs(structure)h(had)g(a)h(reference)g
(count)f(\256eld)g(which)g(was)g(supposed)f(to)h(keep)g(track)h(of)f(the)g
(number)0 453 y(of)16 b(external)g(references)h(to)e(that)h(object.)30
b(The)16 b(intent)f(was)g(that)h(the)g(object)f(could)g(safely)h(be)g
(destroyed)f(when)g(the)0 510 y(reference)d(count)f(fell)g(to)f(zero.)71
566 y(Unfortunately)m(,)15 b(the)g(proper)g(use)g(of)h(reference)h(counts)d
(was)h(never)h(documented.)29 b(W)n(ith)14 b(each)i(protocol)e(writer)0
623 y(deciding)e(to)h(handle)f(session)g(reference)j(counts)d(in)g(a)i(dif)o
(ferent)f(manner)h(\(if)f(at)g(all\),)h(reference)h(counts)d(were)i(seldom)0
679 y(accurate.)22 b(This)12 b(resulted)g(in)g(idle)h(sessions)e(that)h(were)
h(never)g(freed)h(and)e(in)h(dangling)e(references)i(to)g(sessions)e(which)0
736 y(had)g(been)g(destroyed.)71 792 y(Constructing)17 b(a)j(protocol)f
(which)g(directly)g(manipulates)f(reference)j(counts)e(and)g(does)g(so)h
(correctly)f(can)h(be)0 849 y(awkward)11 b(and)g(tedious.)k(V)-5
b(ersion)10 b(3.2)h(of)h(the)f Fr(x)p Fs(-kernel)g(has)g(addressed)g(this)f
(dif)o(\256culty)g(by:)68 954 y Fk(\017)23 b Fs(moving)10 b(all)h(direct)g
(reference)h(count)e(manipulation)g(into)g(the)h Fr(x)p Fs(-kernel)g
(infrastructure.)68 1048 y Fk(\017)23 b Fs(changing)10 b(the)h(semantics)f
(of)h(some)h(of)f(the)g(UPI)g(functions)68 1141 y Fk(\017)23
b Fs(explicitly)9 b(documenting)g(how)i(references)h(to)f(other)g
Fr(XObj)p Fs(s)f(may)h(be)h(used.)68 1235 y Fk(\017)23 b Fs(adding)10
b(system)g(support)g(for)h(session)f(caching)h(and)g(garbage)g(collection.)71
1340 y(The)g(rest)g(of)h(this)f(section)f(discusses)g(the)h(system)h(support)
e(for)h(reference)i(counts)e(and)g(explains)f(how)i(to)f(modify)g(a)0
1397 y(v3.1)g(protocol)f(to)g(properly)h(use)g(reference)h(counts)e(in)h
(v3.2.)71 1453 y(W)l(e)j(discuss)e Fr(XObj)h Fs(reference)j(counts)c(in)i
(the)f(context)g(of)h(sessions)e(\(rather)i(than)g(protocols\))e(because)i
(protocols)0 1510 y(are)e(relatively)e(static)g(objects)g(and)h(the)g(issues)
f(surrounding)f(their)i(reference)h(counts)e(are)i(not)f(very)g(interesting.)
0 1634 y Fn(11.1)50 b(Refer)o(ences)0 1721 y Fs(An)11 b Fr(XObj)f
Fs(reference)j(is)d(a)i(pointer)e(to)h(an)g Fr(XObj)p Fs(.)16
b(References)c(come)g(in)f(two)f(\257avors:)16 b Fe(permanent)11
b Fs(and)g Fe(temporary)p Fs(.)71 1777 y(A)f(permanent)g(reference)h(can)f
(be)g(used)g(inde\256nitely)m(.)15 b(As)9 b(long)g(as)h(the)g(holder)g(of)g
(a)g(permanent)g(reference)h(does)f(not)0 1834 y(call)i Fr(xClose)g
Fs(on)f(the)h(reference,)i(the)d(holder)g(knows)g(that)h(the)f(pointer)g
(will)g(remain)h(valid.)18 b(Permanent)13 b(references)g(are)0
1890 y(returned)e(by)g Fr(xOpen)p Fs(.)71 1947 y(An)e Fr(XObj)g
Fs(pointer)f(received)i(as)g(a)g(parameter)g(in)f(a)h(function)e(call)i(is)f
(a)h(temporary)f(reference.)18 b(It)9 b(can)h(only)f(be)g(safely)0
2003 y(used)i(for)g(the)g(duration)f(of)h(that)g(function)e(call.)71
2060 y(A)f(permanent)h(reference)h(may)f(be)g(created)g(from)h(a)f(temporary)
f(reference)i(by)f(using)e(the)i(UPI)g(function)e Fr(xDuplicate)p
Fs(.)0 2116 y(For)14 b(example,)h Fr(xDemux)e Fs(passes)g(a)h(reference)h(to)
e(the)h(lower)f(session)f(as)i(a)g(parameter)g(to)f(the)h(upper)f(protocol.)
22 b(If)14 b(the)0 2172 y(upper)f(protocol)f(wishes)h(to)g(save)g(this)f
(reference)j(beyond)d(the)h(extent)g(of)h(the)f(demux)g(call,)h(the)f
(protocol)g(should)e(call)0 2229 y Fr(xDuplicate)f Fs(on)h(the)g(session.)k
(The)c(protocol)f(can)h(then)g(safely)g(use)f(the)h(reference)i(until)d(it)g
(calls)h Fr(xClose)p Fs(.)0 2353 y Fn(11.2)50 b(Refer)o(ence)12
b(counts)0 2440 y Fs(Session)e(reference)j(counts)d(in)g(v3.2)h(are)h(a)g
(sum)f(of:)168 2546 y Fo(\261)23 b Fs(the)11 b(number)g(of)g(permanent)g
(external)g(references)h(to)f(the)g(session)168 2619 y Fo(\261)23
b Fs(the)11 b(number)g(of)g(outstanding)d Fr(xPop)p Fs(')m(s)k(on)e(the)h
(session)952 2753 y(50)p eop
%%Page: 51 51
50 bop 0 124 a Fo(11.2.1)56 b(Counting)12 b(External)f(Refer)o(ences)0
211 y Fs(Several)h(of)g(the)g(UPI)g(functions)e(are)j(involved)d(in)h
(maintaining)f(the)i(count)f(of)h(permanent)g(external)f(references.)20
b(They)0 268 y(are)14 b(listed)f(here)h(along)f(with)g(their)g(semantics)g
(with)g(respect)h(to)f(reference)i(counts)e(\(and)g(how)h(these)f(semantics)g
(have)0 324 y(changed)e(from)h Fr(x)p Fs(-kernel)f(version)f(3.1\):)114
430 y Fr(xCr)n(eateSessn\()g(...)18 b(\))214 524 y Fs(The)11
b(newly)f(created)i(session)d(has)i(an)h(initial)d(reference)j(count)f(of)g
(0)g(\(it)g(was)g(1)g(in)g(v3.1.\))114 631 y Fr(xOpen\()g(...)17
b(\))214 724 y Fs(The)10 b(session)g(returned)g(by)g(invoking)f(the)i(lower)f
(protocol')m(s)g(open)g(routine)g(has)g(its)g(reference)214
781 y(count)15 b(incremented)g(before)h(it)g(is)f(returned)g(to)h(the)f
(caller)h(of)g Fr(xOpen)p Fs(,)h(indicating)d(that)h(the)214
837 y(caller)h(now)g(has)h(a)f(permanent)h(reference)h(to)e(the)g(session.)31
b(\()p Fr(xOpen)17 b Fs(did)f(not)f(manipulate)214 894 y(reference)d(counts)e
(in)h(v3.1.\))114 1000 y Fr(xClose\()g(XObj)f(s)h(\))214 1094
y Fs(Decrements)f(the)g(reference)h(count)e(of)h(the)g(session,)f(indicating)
f(that)i(a)g(permanent)g(reference)214 1150 y(to)17 b(the)g(session)g(has)g
(been)h(released.)37 b(The)17 b(lower)h(protocol')m(s)f(close)g(operation)g
(is)g(called)214 1207 y Fe(only)10 b Fs(if)i(the)f(session')m(s)g(new)h
(reference)h(count)d(is)i(zero.)18 b(\()p Fr(xClose)12 b Fs(always)f(invoked)
f(the)i(lower)214 1263 y(protocol')m(s)e(close)h(operation)f(in)g(v3.1.\))114
1369 y Fr(xDuplicate\()g(XObj)g(s)h(\))214 1476 y Fs(By)d(default,)h
(increments)f(the)g(session')m(s)g(reference)h(count,)g(indicating)d(that)i
(a)h(new)f(permanent)214 1532 y(reference)g(to)f(the)g(session)f(has)i(been)f
(created.)16 b(If)8 b(the)f(session)f(has)h(its)f(own)h(duplicate)g
(function,)214 1589 y(that)j(is)h(called)g(instead.)k(\()p
Fr(xDuplicate)10 b Fs(did)h(not)f(exist)g(in)h(v3.1.\))0 1711
y Fo(11.2.2)56 b(Counting)12 b(xPops)0 1798 y Fs(T)m(o)f(understand)e(the)i
(second)g(component)f(of)h(the)g(reference)h(count,)f(the)g(number)g(of)g
(outstanding)e Fr(xPop)p Fs(s)h(on)h(a)g(session,)0 1855 y(it)e(is)h
(important)f(to)g(realize)h(that)g(a)g(protocol)e(does)i(not)f(have)h
(explicit)e(references)j(to)f(its)f(own)g(sessions.)14 b(That)c(is,)g(while)f
(a)0 1911 y(protocol)h(usually)g(maintains)h(pointers)f(to)h(its)g(sessions)f
(\(in)h(a)h(map\))g(and)g(invokes)e(operations)g(on)h(them,)i(the)e
(sessions')0 1968 y(reference)h(counts)e(do)g(not)g(take)h(these)f(pointers)f
(into)h(account.)16 b(\(This)10 b(is)g(why)g Fr(xCr)n(eateSessn)g
Fs(returns)g(an)h(object)f(with)g(a)0 2024 y(reference)i(count)f(of)g(0)g
(and)g(not)g(1.\))71 2081 y(For)e(a)h(protocol)e(to)h(safely)g(send)g(this)f
(session)g(pointer)h(outside)e(of)j(the)f(protocol)f(\(e.g.,)j(as)f(a)f
(parameter)i(in)e Fr(xDemux)p Fs(\),)0 2137 y(it)g(needs)h(to)g(turn)f(the)h
(pointer)f(into)g(a)h(reference)h(by)f(incrementing)f(the)h(session')m(s)e
(reference)k(count.)j(It)10 b(could)f(do)h(this)f(by)0 2193
y(calling)j Fr(xDuplicate)f Fs(on)h(the)g(session)f(as)i(soon)f(as)g(it)g(is)
h(extracted)f(from)h(the)f(session)g(map,)h(making)f(the)h(external)f(call,)0
2250 y(and)g(then)f(closing)f(the)i(session.)k(But)c(since)f(all)h(protocols)
e(must)h(do)h(this)e(for)i(incoming)f(messages,)h(this)f(functionality)0
2306 y(has)k(been)g(absorbed)f(into)g Fr(xPop)p Fs(.)28 b Fr(xPop)15
b Fs(increments)g(the)f(reference)j(count)d(of)h(the)g(session)f(before)h
(calling)f(the)h(pop)0 2363 y(function)10 b(and)h(decrements)g(it)g
(\(possibly)e(calling)h(the)h(session')m(s)f(close)h(operation\))f
(afterwards.)71 2419 y(It)18 b(could)g(be)h(ar)o(gued)g(that)f(all)h(UPI)g
(functions,)g(not)f(just)g Fr(xPop)p Fs(,)i(should)e(indicate)f(their)i(use)f
(of)h(a)g(session)f(by)0 2476 y(incrementing)9 b(the)h(reference)h(count)e
(at)h(their)f(start)g(and)h(decrementing)g(it)f(at)h(their)f(completion.)15
b(T)m(o)9 b(perform)i(any)f(other)0 2532 y(UPI)g(operation)e(on)h(a)g
(session,)g(however)n(,)g(one)h(must)e(already)i(have)f(a)g(reference)i(to)e
(that)f(session.)15 b(As)8 b(long)h(as)g(an)g Fr(xClose)0 2589
y Fs(is)14 b(not)g(performed)h(on)f(that)g(reference,)j(the)d(session)f(is)h
(not)g(going)f(to)h(go)g(away;)i(maintaining)d(reference)j(counts)d(for)952
2753 y(51)p eop
%%Page: 52 52
51 bop 0 124 a Fs(these)10 b(operations)g(is)g(not)g(necessary)m(.)17
b Fr(xPop)p Fs(s)10 b(are)h(dif)o(ferent)g(in)f(that)h(a)g(session')m(s)f
(reference)i(count)e(does)g(not)g(re\257ect)i(that)0 181 y(its)e(protocol)g
(may)i(send)e(messages)i(up)e(through)g(it.)71 237 y(Note)e(that)f(reference)
j(counts)e(will)f(not)h(help)g(a)h(protocol)e(which)h(performs)g(an)h
Fr(xClose)f Fs(on)g(a)h(session)e(reference)j(while)0 294 y(another)e(thread)
h(has)f(an)h(outstanding)e(operation)g(on)i(that)f(same)h(reference.)17
b(T)m(o)9 b(perform)g(such)f(a)h(sequence)g(is)f(a)i(protocol)0
350 y(error)m(.)25 b(If)14 b(two)f(threads)g(share)h(a)f(session)g
(reference,)i(they)e(should)f(either)i(synchronize)e(to)h(avoid)g(such)g
(sequences)g(or)0 407 y(they)f(should)f(duplicate)h(the)g(reference)i(with)e
Fr(xDuplicate)f Fs(and)h(each)i(thread)e(should)f Fr(xClose)i
Fs(its)e(reference)j(when)f(it)f(is)0 463 y(through.)0 587
y Fn(11.3)50 b(Internal)12 b(vs.)19 b(External)11 b(Refer)o(ence)i(Counts)0
674 y Fs(Session)c(reference)i(counts)e(are)h(meant)h(to)e(count)g(the)h
(number)g(of)g Fr(external)f Fs(references)h(to)g(the)g(session)e(\(i.e.,)j
(references)0 731 y(held)j(outside)f(of)i(the)f(protocol.\))26
b(If)16 b(a)f(protocol)e(must)h(keep)h(track)g(of)f(session)g(references)h
(internal)f(to)g(the)h(protocol)0 787 y(itself,)c(a)g(separate)g(mechanism)h
(must)f(be)g(used.)71 844 y(This)d(requirement)h(is)f(driven)h(by)g(upper)g
(protocols)e(which)i(require)g(that)f(when)h(they)g(release)g(all)g(of)h
(their)e(references)0 900 y(to)j(a)g(lower)g(session)e(that)h(the)h(session')
m(s)f(reference)i(count)e(goes)h(to)f(zero.)17 b(V)m(irtual)11
b(protocols)e(which)h(manipulate)h(lower)0 957 y(session')m(s)f(upper)h
(protocol)f(pointers)g(are)h(speci\256c)h(examples)f(of)g(these)g(upper)g
(protocols.)0 1081 y Fn(11.4)50 b(Session)12 b(Caching)g(Strategies)0
1168 y Fs(In)g(the)g(presence)g(of)g(correct)h(management)f(of)h(reference)g
(counts,)e(protocols)g(may)h(want)g(to)g(implement)f(some)i(sort)e(of)0
1224 y(session)j(caching.)28 b(For)16 b(example,)g(many)g(of)f(the)g
(sessions)f(created)h(on)g(the)g(receiving)g(end)g(of)g(a)h(remote)f
(procedure)0 1281 y(call)g(will)f(have)h(their)g(reference)h(counts)e(go)h
(to)g(zero)h(after)f(the)g(reply)g(has)g(been)g(sent,)h(and)f(without)e
(caching,)j(all)f(of)0 1337 y(those)f(sessions)f(will)h(be)i(destroyed.)27
b(While)14 b(caching)h(may)g(not)g(be)g(important)f(for)h(all)g(protocols,)g
(it)f(is)h(vital)f(to)g(the)0 1394 y(performance)e(of)f(protocols)f(that)g
(experience)i(a)f(high)f(frequency)h(of)h(traf)o(\256c)g(from)f(the)g(same)h
(sources.)71 1450 y(If)f(a)g(protocol)f(does)g(cache)i(idle)e(sessions,)g(it)
g(is)h(important)e(to)i(make)g(the)g(caching)g(transparent)f(to)g(upper)h
(protocols)0 1507 y(\(i.e.,)h(an)f(upper)g(protocol)f(should)f(not)i(be)g
(able)g(to)f(distinguish)e(a)j(newly)g(created)g(lower)g(session)e(from)j(a)f
(cached)g(lower)0 1563 y(session)f(that)g(is)h(being)f(reused.\))17
b(One)11 b(aspect)g(of)g(this)g(requirement)g(is)f(that)h(protocols)f(which)g
(cache)i(sessions)d(must)i(be)0 1619 y(sure)i(to)g(check)g(for)h(the)e
(presence)i(of)f(openEnables)f(when)g(reusing)h(sessions)e(which)h(would)g
(otherwise)h(be)g(passively)0 1676 y(created)f(and)f(to)f(call)h(xOpenDone)f
(for)i(when)e(reusing)h(such)f(sessions)g(from)h(the)g(cache.)71
1732 y(Here)f(are)h(some)f(examples)g(of)g(caching)f(strategies)g(and)h(how)g
(a)g(protocol)f(might)g(implement)h(them.)16 b(These)10 b(are)g(just)0
1789 y(examples)h(\261)g(other)g(strategies)f(are)i(certainly)e(possible:)68
1895 y Fk(\017)23 b Fs(Destroy)10 b(the)h(session)e(if)j(inactive.)114
1970 y(In)f(this)f(\252null)g(caching\272)h(strategy)m(,)g(the)g(session')m
(s)f(close)g(routine)h(destroys)e(the)i(session:)332 2095 y
Fg(foo_close\(s\))550 2152 y(xAssert\(s->rc)q(nt)30 b(==)e(0\);)550
2208 y(xDestroy\(s\);)68 2333 y Fk(\017)23 b Fs(Garbage)11
b(collector)f(on)h(a)h(per)o(-session)e(basis)114 2408 y(A)16
b(garbage)g(collector)g(event)g(is)g(started)g(for)g(each)h(idle)f(session.)
30 b(When)16 b(the)g(event)g(expires,)i(the)e(session)f(is)114
2465 y(collected.)293 2579 y Fd(foo_demux)q(\(\))472 2624 y(if)24
b(\()e(active)j(session)h(does)e(not)f(exist)i(\))e({)952 2753
y Fs(52)p eop
%%Page: 53 53
52 bop 652 124 a Fd(if)23 b(\()g(openEnable)j(exists)f(\))e({)831
170 y(if)g(\()g(cached)i(session)g(exists)g(\))e({)1010 216
y(evCancel)q(\(ss)q(ta)q(te)q(->g)q(c\))q(;)1010 261 y(sstate->)q(gc)j(=)d
(0;)831 307 y(})g(else)h({)1010 353 y(s)f(=)g(foo_open\()q(\);)831
398 y(})831 444 y(xOpenDone)q(\(s)q(,)i(...\);)652 490 y(})d(else)j({)831
535 y(drop)f(packet;)h(return;)652 581 y(})472 627 y(})472
672 y(xPop\(\))293 764 y(foo_open\()q(\))472 809 y(...)472
855 y(if)f(\()e(active)j(session)h(does)e(not)f(exist)i(\))e({)652
901 y(if)g(\(cached)i(session)h(exists)e(\))f({)831 946 y(evCancel\()q(ss)q
(tat)q(e-)q(>gc)q(\);)831 992 y(sstate->g)q(c)j(=)c(0;)652
1037 y(})472 1083 y(})472 1129 y(...)293 1220 y(foo_close)q(\(s)q(\))472
1266 y(sstate->)q(gc)k(=)d(evRegister)q(\(f)q(oo)q(_gc)q(,)j(s\);)472
1311 y(mark)e(session)i(as)d(cached)293 1403 y(foo_gc\(s\))472
1448 y(xDestroy)q(\(s\))q(;)68 1569 y Fk(\017)g Fs(Garbage)11
b(collector)f(on)h(a)h(per)o(-protocol)e(basis)114 1643 y(There)h(is)f(a)i
(single)d(garbage)j(collector)e(for)h(the)g(protocol\320it)e(runs)i(every)g
(so)f(often)h(and)g(looks)e(for)j(idle)e(sessions)114 1700
y(in)g(the)h(protocol')m(s)f(session)g(map,)i(calling)e(a)i
(protocol-speci\256c)e(destroy)g(function)g(if)h(it)f(\256nds)h(one.)114
1774 y(The)i Fr(x)p Fs(-kernel)h(has)f(a)h(default)f(session)f(garbage)i
(collector)e(which)h(a)h(protocol)e(can)i(use)g(for)f(this)g(purpose.)22
b(See)114 1831 y(xkernel/include/gc.h)8 b(for)k(the)f(interface.)305
1951 y Fc(foo_init\(\))495 2008 y(...)495 2064 y
(initSessionCollector\(cacheMap)o(,)21 b(interval,)i(foo_destroy\);)305
2177 y(foo_demux\(\))495 2233 y(if)h(\()g(active)f(session)g(does)g(not)g
(exist)h(\))f({)686 2290 y(if)h(\()g(openEnable)e(exists)h(\))h({)877
2346 y(if)g(\()g(cached)f(session)g(exists)g(\))g({)1068 2403
y(move)g(sessn)h(from)f(cached)g(map)g(to)1068 2459 y(active)g(map)877
2516 y(})h(else)f({)1068 2572 y(s)h(=)g(foo_open\(\);)877 2629
y(})952 2753 y Fs(53)p eop
%%Page: 54 54
53 bop 877 124 a Fc(xOpenDone\(s,)22 b(...\);)686 181 y(})i(else)f({)877
237 y(drop)h(packet;)e(return;)686 294 y(})495 350 y(})495
407 y(xPop\(\))305 519 y(foo_open\(\))495 576 y(...)495 632
y(if)i(\()g(active)f(session)g(does)g(not)g(exist)h(\))f({)686
689 y(if)h(\(cached)f(session)g(exists)g(\))h({)877 745 y(move)g(sessn)f
(from)g(cached)g(map)h(to)f(active)g(map)686 802 y(})495 858
y(})495 915 y(...)305 1028 y(foo_close\(s\))495 1084 y(xAssert\(s->rcnt)f(==)
i(0\);)495 1140 y(move)g(sessn)f(from)g(active)g(map)h(to)f(cached)g(map)305
1253 y(foo_destroy\(s\))495 1310 y(xDestroy\(s\);)0 1490 y
Fn(11.5)50 b(Modifying)11 b(v3.1)h(pr)o(otocols)0 1577 y Fs(In)f(addition)f
(to)h(the)g(other)g(modi\256cations)e(one)j(needs)f(to)f(make)i(to)f
(translate)g(an)g(existing)e(protocol)h(from)i(v3.1)f(to)g(v3.2,)0
1633 y(one)g(should)f(make)h(the)g(following)e(modi\256cations)h(with)g
(respect)i(to)e(reference)j(counts:)68 1737 y Fk(\017)23 b
Fg(foo)p 198 1737 14 2 v 17 w(open)12 b Fs(should)e(not)g(increment)h(the)g
(reference)i(count)114 1811 y(v3.1)e(protocols)e(often)i(followed)f(the)h
(format:)550 1933 y Fg(foo_open\(\))768 1990 y(if)28 b(\(session)h(s)f
(exists\))h({)986 2046 y(s->rcnt++;)768 2103 y(})f(else)g({)986
2159 y(s)g(=)f(xCreateSessn)q(\(\);)986 2216 y(fill)i(in)f(state;)768
2272 y(})768 2328 y(return)h(s;)114 2450 y Fr(xOpen)11 b Fs(now)f
(automatically)g(increments)h(the)g(reference)h(count)f(so)f(the)h(format)h
(should)d(be)j(more)f(like:)550 2572 y Fg(foo_open\(\))768
2629 y(if)28 b(\(session)h(s)f(does)g(not)g(exist\))h({)952
2753 y Fs(54)p eop
%%Page: 55 55
54 bop 986 124 a Fg(s)28 b(=)f(xCreateSessn)q(\(\);)986 181
y(fill)i(in)f(state;)768 237 y(})768 294 y(return)h(s;)68 419
y Fk(\017)23 b Fg(foo)p 198 419 14 2 v 17 w(close)13 b Fs(should)c(not)i
(decrement)g(the)g(reference)i(count)114 494 y(In)e(v3.1,)g
Fg(foo)p 349 494 V 17 w(close)i Fs(was)e(called)g(whenever)g
Fr(xClose)g Fs(was)g(called,)g(so)g Fg(foo)p 1385 494 V 17
w(close)i Fs(often)e(looked)f(like:)550 619 y Fg(foo_close\(\))768
675 y(if)28 b(\(--s->rcnt)i(==)e(0\))g({)986 732 y(xDestroy\(s\);)768
788 y(})114 913 y Fs(In)14 b(v3.2,)i(the)e(protocol')m(s)g(close)g(function)g
(is)g(called)g(only)g(when)g(the)h(reference)g(count)f(reaches)h(zero)g
(\(see)g(the)114 969 y(examples)c(in)f(the)h(caching)g(section.\))68
1063 y Fk(\017)23 b Fr(xPop)10 b Fs(should)g(not)g(be)i(bypassed)114
1138 y(Since)f Fr(xPop)f Fs(in)h(v3.1)g(did)f(nothing)f(more)j(than)e(call)h
(the)f(session')m(s)g(pop)h(operation,)f(v3.1)h(protocols)e(often)i(either)
114 1195 y(called)e(their)h(pop)f(routine)g(directly)g(or)n(,)h(if)g(their)g
(pop)f(routine)g(was)g(small,)i(they)e(absorbed)g(this)g(functionality)e
(into)114 1251 y(their)k(demux)g(routine)f(and)h(bypassed)g
Fr(xPop)g Fs(altogether)m(.)16 b(Since)c Fr(xPop)f Fs(manipulates)f
(reference)j(counts)d(in)h(v3.2,)114 1308 y(it)f(can)i(not)e(be)h(bypassed.)
68 1402 y Fk(\017)23 b Fr(xDemux)11 b Fs(should)e(not)i(use)g
Fr(xOpen)g Fs(to)g(create)g(new)h(sessions)114 1477 y(It)f(is)f(common)i
(practice)f(for)g(a)g(protocol)f(to)h(create)h(passive)e(sessions)f(\(where)i
(session)f(creation)h(is)f(triggered)h(by)114 1533 y(an)h(incoming)e(packet)i
(rather)g(than)f(an)h(xOpen\))f(by)h(having)e Fg(foo)p 1171
1533 V 17 w(demux)k Fs(call)d Fg(foo)p 1495 1533 V 18 w(open)i
Fs(and)e(then)g(possibly)114 1590 y(customizing)d(the)j(session.)j(There)d
(is)f(nothing)e(wrong)i(with)g(this)f(practice,)i(but)f(such)g(a)g(protocol)f
(should)g(invoke)114 1646 y Fg(foo)p 198 1646 V 17 w(open)17
b Fs(directly)d(rather)i(than)f(using)f Fr(xOpen)p Fs(.)30
b(The)16 b(passively)e(created)i(session)e(should)g(have)h(an)h(initial)114
1703 y(reference)c(count)e(of)i(0,)f(but)g Fr(xOpen)g Fs(would)f(return)g(a)i
(session)e(with)g(an)h(initial)f(reference)i(count)e(of)i(1.)952
2753 y(55)p eop
%%Page: 56 56
55 bop 0 124 a Ft(12)60 b(Pr)o(otocol)12 b(T)-5 b(ables)0 228
y Fs(The)13 b Fr(x)p Fs(-kernel)g(determines)g(relative)g(protocol)f(numbers)
g(by)h(reading)g(protocol)f(table)g(\256les)h(at)g(boot)g(time.)22
b(Here)13 b(is)g(an)0 284 y(example)e(of)h(a)f(\256le)h(de\256ning)e(a)h
(protocol)f(table)h(\(see)h(section)e(3.3)h(for)g(an)h(operation)e(that)g
(queries)h(this)f(table\):)0 381 y Fg(#)0 437 y(#)28 b(prottbl)0
494 y(#)0 550 y(#)g(This)g(file)g(describes)i(absolute)f(protocol)h(id's)0
607 y(#)e(and)g(gives)g(relative)i(protocol)f(numbers)g(for)f(those)0
663 y(#)g(protocols)h(which)g(use)f(them)0 719 y(#)0 776 y(#)g(x-kernel)h
(v3.2)0 889 y(eth)246 b(1)0 945 y({)218 1002 y(ip)g(x0800)218
1058 y(arp)219 b(x0806)218 1115 y(rarp)192 b(x8035)218 1171
y(#)218 1228 y(#)28 b(ethernet)h(types)g(x3***)f(are)h(not)f(reserved)218
1284 y(#)218 1340 y(blast)165 b(x3001)0 1397 y(})0 1453 y(ip)273
b(2)0 1510 y({)218 1566 y(icmp)192 b(1)218 1623 y(tcp)219 b(6)218
1679 y(udp)g(17)218 1736 y(#)218 1792 y(#)28 b(IP)g(protocol)h(numbers)g(n,)f
(91)g(<)f(n)h(<)f(255,)i(are)f(unassigned)218 1849 y(#)218
1905 y(blast)165 b(101)0 1961 y(})0 2018 y(arp)246 b(3)0 2074
y(rarp)219 b(4)0 2131 y(udp)246 b(5)0 2187 y(tcp)g(6)0 2244
y(icmp)219 b(7)0 2300 y(blast)192 b(8)0 2357 y(sunrpc)165 b(9)0
2510 y Fs(Each)11 b(protocol)f(has)h(an)g(entry)g(of)g(the)g(form:)114
2629 y Fg(name)28 b(idNumber)h([)f Fk(f)f Fg(hlp1)h(relNum1)i(hlp2)e(relNum2)
h(...)55 b Fk(g)27 b Fg(])952 2753 y Fs(56)p eop
%%Page: 57 57
56 bop 0 124 a Fs(where)11 b(the)g(idNumber)g(uniquely)e(identi\256es)h(each)
i(protocol.)71 181 y(There)f(are)g(two)f(ways)h(for)f(a)i(protocol)d(to)h
(de\256ne)h(its)f(relative)h(protocol)e(number)i(space.)17
b(Using)9 b(the)i(\256rst)f(technique)0 237 y(\(e.g.,)15 b(ETH)e(and)f(IP\),)
j(the)d(protocol)g(explicitly)f(indicates)h(which)g(protocols)g(may)h(be)h
(con\256gured)e(above)h(it)g(and)g(what)0 294 y(their)g(relative)g(numbers)g
(are.)24 b(Use)14 b(of)f(this)g(numbering)f(scheme)i(is)f(indicated)f(by)i
(the)f(presence)g(of)h(the)f(optional)f(hlp)0 350 y(list)e(after)i(the)e
(protocol')m(s)h(idNumber)m(.)71 407 y(W)n(ith)18 b(the)h(second)f
(technique,)i(the)f(protocol)f(does)g(not)h(explicitly)e(name)i(its)f
(allowed)g(upper)h(protocols,)h(but)0 463 y(will)11 b(implicitly)g(use)h
(each)g(protocol')m(s)g(unique)f(idNumber)h(as)g(its)f(relative)h(protocol)f
(number)m(.)21 b(BLAST)m(,)12 b(for)h(example,)0 519 y(employs)8
b(this)f(technique)h(and)g(would)g(use)g(SUNRPC')m(s)i(idNumber)e(9)g(as)h
(its)f(relative)g(protocol)f(number)i(above)f(BLAST)m(.)0 576
y(Protocols)i(using)g(this)g(second)h(scheme)g(use)g(a)h(4-byte)e(\256eld)h
(in)g(their)g(headers)g(for)g(the)g(relative)g(protocol)f(number)m(.)71
632 y(The)15 b(latter)h(technique)f(clearly)g(allows)g(more)i(\257exibility)c
(in)j(how)f(protocols)g(may)h(be)g(composed.)30 b(As)16 b(\257exible)0
689 y(composability)11 b(is)i(one)h(of)f(the)g(goals)g(of)g(the)h
Fr(x)p Fs(-kernel,)g(all)f(new)h(protocols)e(written)g(in)h(the)g
Fr(x)p Fs(-kernel)h(should)e(use)h(this)0 745 y(absolute)d(numbering)g
(scheme.)71 802 y(All)c(protocols)g(must)h(have)h(an)g(entry)f(in)g(the)g
(protocol)f(table.)15 b(If)8 b(you)f(are)h(writing)e(a)i(new)g(protocol,)f
(you)g(will)f(probably)0 858 y(want)13 b(to)h(de\256ne)g(an)g(auxiliary)f
(protocol)f(table)i(which)f(assigns)f(a)j(temporary)f(idNumber)f(to)h(your)f
(new)h(protocol)e(and)0 915 y(then)i(con\256gure)h(your)f(kernel)h(to)f(read)
h(in)g(both)f(the)g(system)g(table)h(and)f(your)h(auxiliary)e(table)i(\(see)g
(section)e(13.1)i(for)0 971 y(con\256guration)9 b(examples.\))17
b(If)11 b(you)g(need)f(to)h(con\256gure)g(your)f(new)h(protocol)e(above)i(an)
g(existing)e(protocol)h(which)g(uses)0 1028 y(explicit)g(numbering,)g(you)h
(can)g(augment)g(the)g(table)g(for)g(the)g(existing)f(protocol)f(as)j(in)e
(this)g(example:)0 1134 y Fg(#)0 1190 y(#)28 b(Auxiliary)h(protocol)h(table)0
1247 y(#)0 1360 y(yap)e(1000)0 1473 y(ip)g(2)55 b({)218 1529
y(yap)28 b(200)0 1585 y(})71 1692 y Fs(Here)12 b(we)h(de\256ne)f(our)g(new)h
(protocol)e(Y)-5 b(AP)12 b(and)g(indicate)f(that)h(it)g(has)g(protocol)f
(number)h(200)g(relative)g(to)f(IP)-5 b(.)14 b(Note)0 1748
y(that)i(when)h(augmenting)f(the)g(tables)g(of)h(other)g(protocols,)g(the)f
(idNumber)h(of)g(the)f(other)h(protocol)e(must)i(match)g(its)0
1805 y(number)11 b(in)g(the)g(system)f(\256le.)71 1861 y(The)j
Fr(x)p Fs(-kernel)h(runs)f(consistency)e(checks)j(on)f(the)g(protocol)f
(tables)h(and)g(will)f(give)h(error)h(messages)f(and)h(abort)f(in)0
1918 y(the)e(presence)g(of)g(inconsistencies.)952 2753 y(57)p
eop
%%Page: 58 58
57 bop 0 124 a Ft(13)60 b(Con\256guring)14 b(a)h(Kernel)0 228
y Fs(This)10 b(section)g(describes)h(how)f(to)h(con\256gure)g(and)g(build)f
(an)h Fr(x)p Fs(-kernel.)0 351 y Fn(13.1)50 b(Specifying)11
b(a)h(Pr)o(otocol)h(Graph)0 438 y Fs(A)8 b(new)g(instance)f(of)h(the)g
Fr(x)p Fs(-kernel)g(is)f(con\256gured)h(by)g(specifying)e(the)i(collection)e
(of)i(protocols)e(that)i(are)g(to)g(be)g(included)f(in)0 495
y(the)h(kernel)f(in)g(a)i(\256le)f(called)f Fi(graph.comp)p
Fs(.)17 b(Example)7 b Fi(graph.comp)i Fs(\256les)f(can)g(be)g(found)f(in)g
Fi(xkernel/build/T)-5 b(emplate)p Fs(.)71 551 y(The)20 b Fi(graph.comp)h
Fs(\256le)g(is)e(divided)g(into)g(three)h(sections:)33 b(device)20
b(drivers,)i(protocols,)f(and)f(miscellaneous)0 608 y(con\256guration)11
b(parameters.)22 b(The)12 b(sections)g(are)h(separated)f(by)h(lines)e
(beginning)g(with)h Fi(@;)h Fs(and)f(each)h(section)f(may)h(be)0
664 y(empty)m(.)71 721 y(The)h(\256rst)g(two)f(sections,)h(device)g(drivers)f
(and)h(protocols,)g(describe)f(the)h(protocol)f(graph)h(to)f(be)i
(con\256gured)e(into)0 777 y(your)e(kernel.)16 b(Device)11
b(drivers)g(and)g(protocols)e(are)j(described)f(by)f(the)h(same)h(types)e(of)
i(entries,)f(as)g(in)g(the)f(example:)0 869 y Fd(name=yap)26
b(files=yap,)q(ya)q(p_)q(cln)q(t,)q(yap)q(_s)q(rv)q(r)f(dir=yap,)h(protocols)
q(=i)q(p,)q(eth)g(trace=TR)q(_MA)q(JO)q(R_E)q(VE)q(NT)q(S;)71
972 y Fs(The)11 b(\256rst)h(\256eld)f(gives)g(the)g(protocol')m(s)g(name.)19
b(The)11 b(rest)h(of)f(the)h(\256elds)f(are)h(optional)e(and)i(may)g(occur)g
(in)f(any)g(order)m(.)0 1029 y(The)g Fi(dir)h Fs(and)f Fi(\256les)h
Fs(\256elds)f(describe)g(the)g(names)g(and)h(locations)d(of)j(the)f(source)g
(\256les)g(used)g(to)g(build)f(the)h(protocol.)16 b(Files)0
1085 y(are)d(speci\256ed)f(without)e(extensions.)17 b(If)c(no)f(dir)f(entry)h
(is)g(speci\256ed,)g Fr(compose)f Fs(will)g(search)i(for)f(the)g(source)g
(\256les)g(in)f(the)0 1142 y(current)g(build)f(directory)m(,)i(a)f
(subdirectory)f(in)h(the)g(current)h(build)e(directory)g(with)h(the)g
(protocol')m(s)f(name,)j(and)e(\256nally)g(in)0 1198 y(the)i(system)h
(protocol)e(library)m(.)24 b(An)13 b(empty)h Fi(\256les)g Fs(entry)f
(defaults)g(to)g(a)h(single)f Fi(.c)g Fs(\256le)h(with)f(the)g(protocols)g
(name.)24 b(An)0 1254 y(entry)11 b(for)g(a)h(protocol)e(from)h(the)g(library)
g(should)e(contain)h(neither)h(a)h Fi(dir)f Fs(nor)g(a)h Fi(\256les)f
Fs(entry)m(.)71 1311 y(The)k Fi(protocols)h Fs(\256eld)g(indicates)e(the)h
(protocols)f(below)h(the)g(current)h(protocol)e(in)h(the)g(graph.)30
b(When)15 b(this)f(\256eld)0 1367 y(contains)9 b(multiple)g(protocols,)h
(order)h(is)f(signi\256cant)f(\(the)h(lower)g(protocols)f(will)h(be)g(loaded)
g(into)g(the)g(upper)g(protocol')m(s)0 1424 y(down)f(vector)g(in)h(the)f
(order)h(in)f(which)g(they)g(are)i(listed.\))j(A)c(protocol)f(which)f
(expects)i(multiple)e(protocols)g(below)h(it)g(will)0 1480
y(describe)i(the)g(expected)g(semantics)f(of)h(the)g(lower)g(protocols)f(in)h
(its)f(manual)h(page)g(in)g(appendix)f(A.)71 1537 y(The)h Fi(trace)h
Fs(\256eld)f(de\256nes)h(the)f(debugging)e(level)i(used)g(in)g(trace)h
(statements)f(depending)f(on)h(the)g(protocol)g(variable)0
1593 y Fi(traceyapp)p Fs(.)17 b(See)12 b(section)e(8)i(for)f(the)g(symbolic)f
(names)h(associated)g(with)f(trace)h(levels.)71 1650 y(Multiple)d
(instantiations)f(of)j(protocols)f(are)i(supported)d(by)i(using)f(a)h
(\252/\272)h(character)g(after)f(the)g(protocol)f(name)i(to)e(add)0
1706 y(an)14 b(extension.)25 b(In)14 b(the)g(following)e(example,)k(two)e
(instantiation)o(s)e(of)i(\252yap\272)g(are)h(indicated,)g(one)f(over)g
(\252ip\272)g(and)g(one)0 1763 y(over)h(\252simeth,\272)h(and)f(both)g(are)g
(used)g(by)g(the)g(\252prt\272)g(protocol.)27 b(In)16 b(addition,)e(the)h
(simeth)g(protocol)f(is)g(instance)h(\2520\272,)0 1819 y(corresponding,)10
b(by)h(convention,)e(to)i(the)g(SunOS)g(ethernet)g(device)g(\252le0.\272)0
1900 y Fd(name=sime)q(th)q(/0;)0 1945 y(name=yaap)q(/i)q(p)25
b(files=ya)q(p,)q(yap)q(_c)q(lnt)q(,y)q(ap)q(_sr)q(vr)h(dir=yap,p)q(ro)q(toc)
q(ol)q(s=)q(ip)g(trace=TR_)q(MAJ)q(OR)q(_EV)q(EN)q(TS)q(;)0
1991 y(name=yaap)q(/e)q(th)g(protocols)q(=si)q(me)q(th/)q(0;)0
2037 y(name=prt)g(files=prt)g(dir=prt,)g(protocols=)q(ya)q(ap/)q(ip)q(,y)q
(aap)q(/e)q(th)g(trace=TR_)q(ERR)q(OR)q(S;)0 2128 y Fs(Only)10
b(the)h(\256rst)g(of)g(multiple)f(instantiations)e(should)i(have)h
Fi(dir)p Fs(,)h Fi(\256les)p Fs(,)g(or)f Fi(trace)g Fs(\256elds.)71
2184 y(The)i(third)g(section)g(contains)f(the)i(names)g(of)g(\256les)g(with)f
(protocol)f(number)i(tables)f(that)g(are)i(to)e(be)h(loaded)f(during)0
2241 y(initialization.)k(It)12 b(also)f(contains)g(the)h(names)h(of)f
(subsystems)e(and)i(their)g(con\256guration)f(parameters.)20
b(Currently)12 b(trace)0 2297 y(variables)i(are)h(the)f(only)f(parameters)i
(that)f(can)g(be)h(set)f(here.)26 b(The)14 b(following)e(illustrates)h(a)h
(typical)g(use)g(of)g(the)g(third)0 2354 y(section:)0 2446
y Fd(@;)0 2492 y(#)0 2537 y(#)23 b(You)g(can)h(also)g(specify)i(auxiliary)g
(protocol)f(tables)g(to)f(be)f(read)h(in)f(at)g(boot)0 2583
y(#)g(time.)47 b(DEFAULT)25 b(loads)g(the)e(system)i(protocol)h(table)e(file)
g(as)g(listed)h(in)e(etc/site.)q(h)0 2629 y(#)952 2753 y Fs(58)p
eop
%%Page: 59 59
58 bop 0 124 a Fd(prottbl=D)q(EF)q(AUL)q(T;)0 170 y(prottbl=.)q(/p)q(rot)q
(tb)q(l;)0 261 y(#subsyste)q(m)26 b(tracing)f(for)f(messages)h(and)f
(protocol)i(operations)0 307 y(name=msg)g(trace=TR_G)q(RO)q(SS)q(_EV)q(EN)q
(TS;)0 353 y(name=prot)q(oc)q(ol)g(trace=TR_)q(MAJ)q(OR)q(_EV)q(EN)q(TS)q(;)
71 456 y Fs(The)10 b(graph.comp)h(\256le)g(is)g(read)g(by)g(an)g
Fr(x)p Fs(-kernel)g(utility)e(program)i(called)f Fr(compose)g
Fs(which)h(generates)f(startup)g(code)0 512 y(to)j(build)f(the)h(protocol)f
(graph)h(and)g(set)g(up)f(the)h(described)g(con\256guration.)21
b(The)14 b(protocol)d(graph)i(is)g(built)f(bottom-up;)0 569
y(when)f(a)g(protocol')m(s)g(initialization)d(function)i(is)g(called,)i(the)e
(lower)h(level-protocols)e(have)j(already)f(been)g(initialized.)0
693 y Fn(13.2)50 b(Build)12 b(Pr)o(ocedur)o(e)0 780 y Fs(A)i(given)g
(instance)g(of)g(the)g Fr(x)p Fs(-kernel)h(is)f(built)f(in)h(a)h(working)e
(directory)m(.)25 b(Each)15 b(working)e(directory)h(can)g(support)f(one)0
836 y Fr(x)p Fs(-kernel)e(con\256guration)e(at)h(a)h(time.)16
b(W)l(orking)10 b(directories)f(may)i(be)f(or)o(ganized)g(within)f(the)h
Fr(x)p Fs(-kernel)h(source)f(tree)h(\(e.g.,)0 893 y(as)g(subdirectories)f(of)
h Fi(xkernel/build)p Fs(\))h(or)g(outside)d(of)j(the)e(source)h(tree)h
(\(e.g.,)g(in)f(an)g Fr(x)p Fs(-kernel)h(user)r(')m(s)f(home)g(directory)m
(.\))71 949 y(For)d(the)f(purpose)g(of)h(the)g(following)e(discussion,)g(we)i
(assume)g(the)g(user)g(is)f(con\256guring)g(a)h(kernel)g(so)f(as)h(to)g
(implement)0 1006 y(and)13 b(evaluate)g(protocol)g(Y)-5 b(AP)13
b(\(yet)g(another)g(protocol.\))23 b(A)13 b(user)g(con\256guring)g(a)g
(kernel)h(that)e(contains)h(only)f(existing)0 1062 y(protocols)d(should)h
(ignore)g(all)h(references)h(to)e(Y)-5 b(AP)g(.)12 b(The)e(machine)i
(architecture)e(in)h(this)f(example)h(is)f(\252sparc\272)i(\(used)f(by)0
1119 y(the)g(sunos)f(platform\);)g(another)h(supported)f(architecture)h(is)f
(used)h(by)g(the)g(DECstation)e(mach3)j(platforms)e(\(\252mips\272\).)57
1222 y(1.)23 b(Put)11 b Fi(xkernel/bin/sparc)h Fs(and)f Fi(xkernel/bin)h
Fs(in)f(your)g(search)h(path.)k(These)c(must)e(be)i(before)g
Fi(/bin)f Fs(and)h Fi(/usr/bin)p Fs(.)114 1278 y(This)f(will)h(allow)f(use)h
(of)h(the)f(version)g(of)g Fi(make)h Fs(distributed)d(with)i(the)g
Fr(x)p Fs(-kernel)h(\(GNU)f(make)h(v)m(.)21 b(3.57\))12 b(rather)114
1335 y(than)e(the)h(standard)g(Unix)f Fi(make)p Fs(.)57 1428
y(2.)23 b(Create)12 b(a)f(new)g(working)f(directory)h(to)f(hold)g(your)h
(kernel.)57 1521 y(3.)23 b(Change)11 b(to)g(your)f(new)h(working)f(directory)
m(.)57 1614 y(4.)23 b(Copy)9 b(the)h(Make\256le)h(from)f Fi(xkernel/build/T)
-5 b(emplate/Make\256le.sunos)11 b Fs(into)e(your)h(working)e(directory)i
(under)114 1670 y(the)h(name)g(Make\256le:)214 1775 y Fi(cp)h
(xkernel/build/T)-5 b(emplate/Make\256le.sunos)14 b(Make\256le)57
1936 y Fs(5.)23 b(Make)12 b(the)e(Make\256le)i(writable:)214
2029 y Fi(chmod)h(u+w)f(Make\256le)57 2179 y Fs(6.)23 b(Edit)8
b(the)i(Make\256le.)16 b(Select)10 b(an)g(appropriate)f Fi(HOWT)o(OCOMPILE)p
Fs(.)i(Generally)m(,)f(you)f(want)g Fi(DEBUG)i Fs(until)d(you)114
2235 y(are)k(ready)f(to)g(run)f(serious)h(performance)h(tests,)e(then)h
(change)g(it)g(to)f Fi(OPTIMIZE)p Fs(.)i(\(See)g(Section)f(8.\))114
2310 y(Check)g(to)g(see)g(that)g(the)g(variable)f(XR)m(T)i(in)f(your)f
(Make\256le)i(is)f(a)h(path)e(to)h(the)g(root)f(of)i(the)f(xkernel)f(source)h
(tree.)57 2403 y(7.)23 b(If)11 b(you)g(are)h(including)d(a)j(new)f(protocol)f
(in)h(your)g(kernel,)g(then)g(create)h(\(at)f(least\))g(a)h(shell)e(for)i
(that)e(protocol;)g(e.g.,)114 2459 y(create)f(a)g(shell)e(version)h(of)h
Fi(yap.c)p Fs(.)15 b(The)9 b(protocol)e(shell)h(should)f(de\256ne)h(an)h
(initialization)d(routine;)i(e.g.,)i Fi(yap)p 1867 2459 14
2 v 17 w(init)p Fs(.)114 2516 y(Y)-5 b(ou)12 b(will)g(also)g(need)g(to)g(put)
g(an)h(entry)f(for)h(your)f(protocol)f(in)h(one)h(of)f(the)h(protocol)e
(tables)h(referenced)h(by)g(your)114 2572 y(graph.comp)i(\(see)g(section)f
(12.\))27 b(If)16 b(you)e(are)i(con\256guring)d(a)j(kernel)f(that)f(contains)
f(only)h(existing)f(protocols,)114 2629 y(then)d(this)g(step)h(is)g(not)f
(necessary)m(.)952 2753 y(59)p eop
%%Page: 60 60
59 bop 57 124 a Fs(8.)23 b(Create)c Fi(graph.comp)p Fs(,)i(as)d(discussed)f
(in)h(section)f(13.1,)j(to)e(specify)f(the)h(protocol)f(graph)h(for)g(your)g
(kernel.)114 181 y(Example)11 b(graph.comps)f(are)i(located)f(in)g(the)g
Fi(xkernel/build/T)-5 b(emplate)12 b Fs(directory)m(.)114 268
y(In)f(steps)f(9)h(and)g(10,)g(you)g(may)h(see)f(one)g(or)g(more)h(compiler)f
(warning)f(messages)h(of)h(the)e(form:)328 393 y Fc(make[n]:)23
b(fopen:)g(Makedep.DEBUGsunos:)e(No)j(such)f(file)h(or)f(directory)114
518 y Fs(These)10 b(messages)g(are)h(expected)f(and)g(can)g(be)g(ignored.)16
b(The)10 b(dependency)f(\256les)h(referenced)i(by)e(these)f(messages)114
575 y(will)h(be)h(created)h(in)e(step)h(10.)114 650 y(The)g(following)e(two)h
(steps)h(must)f(be)i(redone)f(if)g Fi(graph.comp)h Fs(is)f(later)g
(modi\256ed:)57 744 y(9.)23 b Fi(make)12 b(compose)34 837 y
Fs(10.)23 b Fi(make)12 b(depend)h Fs(Note:)j(If)11 b(you)g(are)h(the)f
(\256rst)g(person)f(building)f(a)i(kernel)g(at)h(your)e(site)h(\(i.e.,)h(if)f
(you)g(are)g(building)114 894 y(a)i(kernel)f(as)h(part)g(of)g(the)f
(installation)e(procedure\),)k(you)e(must)g(run)h Fi(make)h(alldepend)h
Fs(here)e(instead)f(of)h Fi(make)114 950 y(depend.)23 b Fs(This)11
b(will)h(create)i(the)f(dependency)f(\256les)h(in)f(all)h(of)g(the)f(source)h
(directories,)g(not)f(just)g(in)g(your)h(build)114 1007 y(directory)m(.)114
1082 y(The)f(dependency)g(\256les)g(built)f(for)i(the)f(DEBUG)g(and)h
(OPTIMIZE)f(con\256gurations)f(are)i(dif)o(ferent.)20 b(The)13
b(person)114 1138 y(installing)c(the)i Fr(x)p Fs(-kernel)h(should)e(run)i
Fi(make)h(alldepend)h Fs(for)e(both)e(DEBUG)i(and)f(OPTIMIZE)h(mode)g(for)g
(each)114 1195 y(platform)f(that)f(will)g(be)h(used.)34 1289
y(11.)23 b Fi(make)0 1413 y Fn(13.3)50 b(Debug)12 b(versus)h(Optimized)e
(Mode)0 1500 y Fs(The)f Fr(x)p Fs(-kernel)h(uses)g(a)g(trace)g(package)f(to)h
(generate)f(debugging)f(information.)15 b(T)m(o)10 b(enable)h(the)f(tracing)g
(facility)m(,)g(edit)g(the)0 1556 y(Make\256le)i(to)f(set)g
Fi(HOWT)o(OCOMPILE)i Fs(to)e Fi(DEBUG)p Fs(;)h(tracing)f(can)g(be)h(disabled)
e(by)h(setting)f Fi(HOWT)o(OCOMPILE)j Fs(to)0 1613 y Fi(OPTIMIZE)p
Fs(.)e(Then)g(type)g Fi(make)p Fs(.)17 b(See)12 b(also)e(section)g(8.)71
1669 y(If)f(you)f(are)h(interested)f(in)g(accurate)i(performance)f(timings,)f
(you)h(should)e(set)h Fi(HOWT)o(OCOMPILE)i Fs(to)e Fi(OPTIMIZE)0
1726 y Fs(in)j(the)g(Make\256le.)17 b(This)10 b(causes)h(all)g(trace)h(of)f
(tracing)f(code)i(to)e(be)i(eliminated)e(form)i(the)f(kernel.)952
2753 y(60)p eop
%%Page: 61 61
60 bop 0 124 a Ft(14)60 b(Running)15 b(a)g(Kernel)0 228 y Fs(This)10
b(section)g(describes)h(the)g(procedure)g(for)g(running)f(a)h(kernel)g(in)g
(each)h(platform.)0 352 y Fn(14.1)50 b(SunOS4)0 439 y Fs(How)10
b(the)h Fr(x)p Fs(-kernel)g(runs)f(on)g(top)g(of)h(SunOS)g(depends)f(on)g
(what)g(\252device)h(drivers\272)f(are)i(con\256gured)e(into)f(the)i(kernel.)
16 b(In)0 495 y(the)9 b(standard)g(release,)h(the)g(ethernet)f(driver)g(is)g
(really)g(a)h(simulator)e(that)h(uses)g(UDP)g(to)g(send)g(packets)g(between)g
(hosts.)15 b(In)0 552 y(this)c(case,)i(if)f(you)f(implement)h(IP)g(and)g(UDP)
g(within)p 740 559 117 2 v 10 w(the)g Fr(x)p Fs(-kernel,)h(then)e(the)h
(simulated)f(UDP)h(packets)f(you)h(send)f(are,)0 608 y(in)f(turn,)g
(encapsulated)f(in)g(real)i(UDP)f(packets.)15 b(This)10 b(means)g(that)f
(protocols)g(and)h(programs)g(built)e(on)i(top)f(of)h(simulated)0
665 y(UDP)h(can)f(only)g(talk)g(to)g(their)g(peers)h(in)f(other)g
(simulators;)f(they)h(cannot)g(communicate)g(with)g(\252real\272)h(versions)e
(of)i(those)0 721 y(protocols)f(running)f(stand-alone,)i(for)g(example,)h(on)
e(a)i(Unix)e(machine.)71 778 y(An)e(alternative)h(is)f(to)h(write)g(an)g(ETH)
g(protocol)e(that)i(sends)f(and)h(receives)g(real)h(ethernet)f(packets,)g
(perhaps)g(by)g(using)0 834 y(the)g(STREAM)h(interface)f(to)g(the)g(driver)g
(available)g(in)g(SunOS)g(4.1.)16 b(Similarly)m(,)10 b(one)f(could)f(imagine)
h(writing)f(a)i(UNIXIP)0 890 y(device)j(driver)f(that)g(sends)g(and)h
(receives)g(real)g(IP)g(packets)g(using)e(a)i(raw)g(datagram)h(socket.)20
b(The)13 b(rest)g(of)g(this)e(section)0 947 y(assumes)g(the)g(simulator)f
(version)g(of)h(ETH)g(that)g(runs)f(on)h(top)f(of)i(the)f(UDP)g(protocol)f
(provided)g(by)g(the)h(SunOS)h(kernel.)71 1003 y(As)j(the)h(result)f(of)h
(con\256guring)f(a)h(kernel)g(\(section)f(13\),)i(a)f(\256le)g(named)h
Fi(xkernel)f Fs(should)e(exist)h(in)h(your)f(current)0 1060
y(directory)10 b(\()p Fi(/usr/xkernel/build/yap)p Fs(\).)17
b(While)10 b(in)g(this)f(directory)m(,)i(create)g(a)g(sub-directory)e(for)h
(each)h(host)f(you)g(want)g(to)0 1116 y(simulate;)g(e.g.,)114
1223 y Fc(mkdir)23 b(client)114 1279 y(mkdir)g(server)71 1385
y Fs(In)13 b(each)g(of)g(these)g(directories,)g(create)g(a)h(\256le)f(named)h
Fi(rom)p Fs(.)22 b(This)12 b(\256le)i(contains)d(information)h(that)g(the)h
(simulated)0 1442 y(host)j(\252reads)h(in)f(from)h(ROM\272.)h(The)f
(following)d(are)k(example)f Fi(rom)g Fs(\256les)g(that)f(might)g(be)g
(contained)g(in)g Fi(client)h Fs(and)0 1498 y Fi(server)p Fs(,)12
b(respectively)m(.)114 1604 y Fc(simeth)23 b(3050)114 1661
y(arp)g(128.10.5.54)f(192.12.69.1)h(3050)114 1717 y(arp)g(128.10.5.23)f
(192.12.69.1)h(3051)114 1880 y(simeth)g(3051)114 1937 y(arp)g(128.10.5.54)f
(192.12.69.1)h(3050)114 1993 y(arp)g(128.10.5.23)f(192.12.69.1)h(3051)0
2156 y Fs(The)11 b(\256rst)g(\256eld)g(of)h(each)f(line)g(indicates)f(the)h
(protocol)e(for)j(which)e(the)h(information)f(is)h(relevant.)71
2212 y(For)h(the)g(simeth)f(entry)m(,)i(the)f(second)f(\256eld)h(indicates)f
(the)h(UDP)g(port)g(number)g(on)g(which)f(this)g(simulated)g(host)g(will)0
2269 y(receive)g(network)g(packets.)16 b(A)11 b(unique)f(port)g(number)h
(must)g(be)g(used)g(for)g(each)h(simulated)e(host)g(running)f(on)i(any)g
(given)0 2325 y(real)16 b(processor)m(.)32 b(Simulated)15 b(hosts)g(running)g
(on)h(dif)o(ferent)g(processors)f(can)h(use)g(the)g(same)h(port)e(number)m(.)
32 b(\(In)16 b(this)0 2382 y(example,)d(the)f(two)g(simulated)f(hosts)g(run)i
(on)f(the)g(same)h(real)f(processor)g(\(192.12.69.1\))g(and)g(use)g(dif)o
(ferent)g(UDP)h(port)0 2438 y(numbers:)22 b Fi(3051)15 b Fs(and)f
Fi(3050)p Fs(.\))27 b(Note)14 b(that)f(the)h(name)h(of)f(the)g(ethernet)g
(protocol)e(appears)j(exactly)e(as)h(it)g(does)g(in)f(the)0
2494 y Fi(graph.comp)f Fs(\256le.)71 2551 y(For)h(the)h(arp)g(entries,)g
(each)g(line)f(corresponds)f(to)h(a)h(simulated)f(IP)h(host.)23
b(The)13 b(second)g(\256eld)h(is)f(the)g(simulated)g(IP)0 2607
y(host)e(number)n(,)j(the)e(third)f(\256eld)i(is)f(the)g(actual)g(IP)h(host)e
(number)i(where)f(the)g(simulator)g(runs,)g(and)h(the)f(third)f(\256eld)i(is)
e(the)952 2753 y(61)p eop
%%Page: 62 62
61 bop 0 124 a Fs(simulator)r(')m(s)9 b(UDP)i(port)f(number)m(.)16
b(Note)10 b(that)g(the)g(simulated)f(IP)i(host)f(numbers)g(do)g(not)g
(necessarily)f(correspond)h(to)f(the)0 181 y(real)i(IP)h(address)f(of)g(the)g
(machine)g(on)g(which)g(the)g(simulated)f(host)g(is)h(running.)71
237 y(Each)g(simulated)f(host)g(runs)h(as)g(a)g(separate)h(Unix)e(process.)16
b(If)c(you)e(using)g(a)i(windowing)c(user)j(interface,)h(then)f(you)0
294 y(will)h(probably)f(want)i(to)f(start)h(each)g(process)f(in)h(a)g
(separate)g(window)m(.)21 b(Y)-5 b(ou)12 b(will)g(also)h(want)f(to)g(have)h
(each)h(sanss)e(rom)0 350 y(\256le)j(in)e(a)i(subdirectory)e(below)h(the)g
(xkernel)f(image)i(that)f(is)g(being)f(tested.)25 b(For)15
b(each)g(simulated)e(host,)i(open)e(a)i(shell)0 407 y(command)c(window)m(,)e
Fi(cd)i Fs(to)f(the)g(sub-directory)f(that)h(contains)f(that)h(host')m(s)f
Fi(rom)i Fs(\256le\320e.g.,)h Fi(cd)g(client)p Fs(\320and)f(then)f(type)0
463 y Fi(../xkernel)p Fs(.)16 b(T)m(o)11 b(stop)f(a)i(simulated)e(host,)g
(type)h Fi(DELETE)h Fs(or)f Fi(CTRL-C)p Fs(.)0 586 y Fn(14.2)50
b(Mach)12 b(3)0 673 y Fs(As)e(the)f(result)g(of)h(con\256guring)f(a)h(kernel)
g(\(section)f(13\),)h(a)g(\256le)g(named)h Fi(xkernel)f Fs(should)e(exist)h
(in)h(your)f(current)h(directory)0 729 y(\()p Fi(/usr/xkernel/build/yap)p
Fs(\).)21 b(Y)-5 b(ou)13 b(may)g(optionally)d(create)j(a)g(\256le)f(named)h
Fi(rom)g Fs(in)f(this)g(directory)m(.)19 b(This)12 b(\256le)h(contains)0
786 y(information)d(that)h(the)f(host)h(\252reads)g(in)g(from)g(ROM\272.)i
(This)d(is)h(an)g(example)g Fi(rom)h Fs(\256le:)114 881 y Fc(ethdrv/SE0)22
b(priority)h(200)114 937 y(arp)g(192.12.69.88)f(8:0:20:1:51:E6)114
994 y(arp)h(192.12.69.89)f(8:0:20:1:50:40)71 1145 y Fs(The)11
b(\256rst)g(\256eld)g(of)g(each)h(line)e(indicates)g(the)h(protocol)f(for)h
(which)g(the)g(information)f(is)g(relevant.)71 1202 y(Each)f(ARP)h(entry)e
(corresponds)g(to)h(an)g(initial)f(binding)f(between)i(the)g(IP)h(address)e
(and)h(the)g(ethernet)g(address.)15 b(These)0 1258 y(entries)f(are)i(not)e
(necessary)g(if)h(you)f(have)h(hosts)e(on)h(your)h(network)e(which)h(will)g
(respond)g(to)g(your)g(RARP)i(and)f(ARP)0 1315 y(requests.)71
1371 y(The)8 b(ethdrv)g(entry)g(indicates)g(the)g(priority)g(of)g(the)h(Mach)
g(packet)g(\256lter)f(used)h(by)f(the)g Fr(x)p Fs(-kernel.)17
b(The)8 b(default)g(priority)m(,)0 1427 y(200,)16 b(causes)g(the)f
Fr(x)p Fs(-kernel)h(to)f(grab)g(ethernet)g(packets)g(and)g(not)g(allow)g(the)
g(native)g(Mach)h(networking)d(code)j(to)f(see)0 1484 y(them.)k(This)10
b(allows)h(the)h Fr(x)p Fs(-kernel)g(to)f(fully)g(communicate)h(with)f(other)
g(hosts,)g(but)g(makes)h(it)g(dif)o(\256cult)f(to)g(run)h Fr(x)p
Fs(-kernel)0 1540 y(tests)e(from)i(a)f(remote)h(host.)71 1597
y(By)j(lowering)f(the)h(\256lter)h(priority)e(below)g(100,)j(both)d(Mach)i
(and)f(the)g Fr(x)p Fs(-kernel)h(see)g(all)f(ethernet)g(packets.)28
b(This)0 1653 y(is)14 b(useful)f(for)i(allowing)d(normal)i(network)f
(activity)g(while)h(running)e Fr(x)p Fs(-kernel)j(tests,)f(but)g(can)g
(result)g(in)f(troublesome)0 1710 y(interaction)c(between)i(the)f
Fr(x)p Fs(-kernel)h(protocols)e(and)i(the)g(Mach)g(protocols)e(running)g(on)i
(the)f(same)i(host.)j(If)c(you)f(want)h(to)0 1766 y(lower)g(the)g(\256lter)g
(priority)m(,)f(we)h(recommend)h(either)68 1861 y Fk(\017)23
b Fs(Con\256guring)11 b(your)i Fr(x)p Fs(-kernel)g(without)e(TCP)-5
b(,)14 b(SUNRPC)f(and)g(any)g(other)f(protocols)f(which)h(might)g(cause)h
(inter)o(-)114 1918 y(action)d(problems)114 1991 y(or)68 2082
y Fk(\017)23 b Fs(modifying)11 b(your)h(protocol)g(table)g(\256le)h(to)g
(create)g(an)g(alternate)g(protocol)e(number)i(for)g(IP)g(relative)g(to)f
(ETH)g(\(the)114 2138 y(default)d(is)g(x0800.\))15 b(In)10
b(this)e(case,)j(of)e(course,)i(the)e Fr(x)p Fs(-kernel)h(protocols)e(will)g
(only)h(be)h(able)f(to)g(communicate)h(with)114 2195 y(other)g(hosts)g
(running)g(the)h Fr(x)p Fs(-kernel)g(with)g(the)g(althernate)f(protocol)g
(table.)71 2290 y(Since)i(the)g Fr(x)p Fs(-kernel)g(reads)g(from)h(the)f
(ethernet)f(device,)i(it)e(needs)h(to)g(run)g(with)f(root)g(uid.)19
b(Y)-5 b(ou)12 b(will)f(need)h(to)g(either)0 2346 y(su)g(to)g(root)f(before)i
(running)d(it)i(or)g(run)g(it)g(setuid)f(root.)19 b(Some)13
b(Unix)e(servers)h(will)f(allow)h(members)h(of)f(group)f Fr(kmem)i
Fs(to)0 2403 y(read)f(the)e(device;)h(in)g(this)f(case)h(members)h(of)g(the)f
(group)f(need)h(not)g(su)f(to)h(root.)71 2459 y(See)20 b(the)g(man)g(page)g
(for)g(the)f(Mach)h(ethernet)g(driver)f Fr(ethdrv)g Fs(in)h(appendix)e(A)i
(for)g(additional)e(con\256guration)0 2516 y(requirements.)71
2572 y(Since)11 b(the)f Fr(x)p Fs(-kernel)h(on)g(the)f(Mach)i(platform)e
(does)h(not)f(respond)g(well)g(to)g(CTRL-C')m(s,)j(we)e(recommend)g(running)f
(it)0 2629 y(in)h(the)g(background)f(so)g(you)h(can)g(easily)g(send)f(it)h(a)
h(SIGKILL)f(with)f(the)h('kill')f(command.)952 2753 y(62)p
eop
%%Page: 63 63
62 bop 0 124 a Fn(14.3)50 b(Mach)12 b(3)h Fb(x)p Fn(-kernel)f(in)g(the)f
(Mach)i(kernel)0 211 y Fs(For)c(this)f(con\256guration,)g(the)h(ethernet)f
(driver)h(name)h(should)d(be)i(\252xklance/SE0.\272)15 b(At)8
b(this)g(time)h(no)g(options)e(are)i(de\256ned)0 268 y(for)i(the)g(ethernet)g
(driver)m(.)17 b(The)11 b(arp)g(entries)g(are)h(the)f(same)g(as)h(described)e
(above.)0 391 y Fn(14.4)50 b(Running)11 b(T)-5 b(est)13 b(Suites)0
478 y Fs(If)f(you)f(have)h(con\256gured)f(protocols)f(from)i(the)f
Fi(test)g Fs(directory)g(into)g(the)g(kernel,)h(you)f(can)h(run)f(any)h
(subset)e(of)i(them)g(by)0 534 y(putting)d(the)i(test)g(names)g(onto)f(the)h
(command)h(line,)f(e.g.:)114 631 y Fc(xkernel)23 b(-testip)f(-testudp)71
728 y Fs(W)n(ith)10 b(no)h(command)g(line)g(test)g(selections,)f(all)g(of)i
(the)e(con\256gured)h(test)g(protocols)e(will)h(run.)71 784
y(Some)18 b(of)g(the)g(tests)e(run)i(with)f(a)h(\252client)f(side\272)h(and)f
(a)h(\252server)h(side\272.)36 b(If)18 b(the)f(macros)i(SITE)p
1669 784 14 2 v 16 w(CLIENT*)e(and)0 840 y(SITE)p 99 840 V
16 w(SER)l(VER*)10 b(in)f(xkernel/etc/site.h)e(re\257ect)j(the)f(client)f
(and)h(server)h(you)e(will)h(be)g(using,)g(no)f(additional)g(parameters)0
897 y(are)j(necessary)m(.)16 b(If)10 b(you)f(are)i(running)d(the)i(client)f
(and)g(server)h(on)g(dif)o(ferent)g(hosts,)f(the)g(server)h(should)f(be)g
(started)h(up)f(with)0 953 y(a)j(\252-s\272)f(\257ag:)114 1050
y Fc(xkernel)23 b(-testip)f(-testudp)h(-s)71 1147 y Fs(The)12
b(client)h(side)f(must)h(also)f(be)h(told)f(the)h(IP)g(address)g(of)g(the)f
(server)i(host)d(test)i(peer)m(.)23 b(This)12 b(can)h(be)g(done)f(with)g(the)
0 1203 y(\252-c\272)g(command)g(line)e(option,)g(e.g.:)114
1300 y Fc(xkernel)23 b(-testip)f(-testudp)h(-c192.12.69.1)0
1423 y Fn(14.5)50 b(T)l(r)o(oubleshooting)0 1510 y Fs(Many)13
b(of)g(the)g(problems)f(encountered)h(when)f(running)g(an)h
Fr(x)p Fs(-kernel)g(turn)g(out)f(to)h(be)g(con\256guration)e(problems.)22
b(Here)0 1566 y(are)11 b(a)f(few)g(common)g(symptoms)g(and)f(some)h(things)f
(you)g(might)g(want)h(to)f(check)h(if)g(these)g(symptoms)f(occur)h(\(setting)
e(the)0 1623 y(debugging)h(variable)i Fc(traceprotocol)f Fs(to)g
Fc(TR)p 780 1623 15 2 v 17 w(EVENTS)h Fs(or)g(higher)g(can)g(be)g(very)g
(helpful)g(in)f(identifying)f(problems\):)68 1719 y Fk(\017)23
b Fr(x)p Fs(-kernel)11 b(hangs)g(in)f(arp)p 499 1719 14 2 v
17 w(init.)114 1793 y(ARP')m(s)i(initialization)d(routine)h(will)h(not)g
(return)g(until)f(it)h(has)h(discovered)e(the)i(binding)d(for)j(its)f(local)g
(IP)h(address.)114 1850 y(If)j(the)f Fr(x)p Fs(-kernel)i(hangs)e(in)g(arp)p
626 1850 V 16 w(init,)h(ARP)h(is)e(probably)f(sending)h(out)g(RARP)h
(requests)f(which)g(are)i(not)e(being)114 1906 y(answered.)i(Multiple)10
b(warning)g(messages)h(of)h(the)e(form:)214 2007 y Fc(ARP:)23
b(Could)g(not)h(get)f(my)h(IP)f(address)g(for)h(interface)e(eth)i(\(still)f
(trying\))114 2108 y Fs(are)12 b(an)f(indicator)f(of)h(this)f(problem.)114
2181 y(If)15 b(you)f(are)i(running)d(the)i(sunos)e(simulator)n(,)i(you)g
(must)f(have)h(an)g(ARP)g(binding)e(in)i(your)f(ROM)i(\256le)f(for)g(your)114
2238 y(local)d(host)f(\(see)i(section)e(14.1.\))20 b(On)12
b(other)g(platforms,)h(an)f(ARP)h(binding)e(for)h(the)g(local)g(host)g(is)g
(not)f(necessary)114 2294 y(if)g(another)g(host)f(on)i(your)e(network)h(will)
f(respond)h(to)g(RARP)h(broadcasts.)17 b(If)12 b(you)f(do)g(not)f(have)i
(such)f(a)h(host)e(\(or)114 2351 y(if)j(it)h(is)f(not)g(responding)f(for)i
(whatever)f(reason\),)i(adding)e(a)h(local)f(binding)f(to)h(your)h(ROM)g
(\256le)g(should)e(\256x)i(the)114 2407 y(problem.)68 2498
y Fk(\017)23 b Fs(Messages)11 b(sent)f(out)h(on)g(one)g(host)f(are)i(never)f
(received)g(on)g(the)g(destination)e(host.)114 2572 y(Check)j(your)g(ROM)g
(\256le.)20 b(If)12 b(it)g(contains)f(an)h(initial)e(binding)g(for)j(the)e
(destination)f(host)h(which)h(is)f(incorrect,)h(the)114 2629
y(destination)c(host)j(will)f(not)g(see)i(packets)e(from)i(the)f(sending)f
(host.)952 2753 y(63)p eop
%%Page: 64 64
63 bop 68 124 a Fk(\017)23 b Fs(An)11 b(xOpen)f(hangs)g(for)i(a)f(while)g
(and)g(then)f(fails.)114 199 y(An)f(open)h(may)g(fail)f(if)h(ARP)h(can)f(not)
f(resolve)g(the)h(IP)g(address)f(of)h(the)g(destination)d(\(turning)i(ARP)h
(tracing)f(on)h(can)114 256 y(help)j(identify)f(this)g(problem.\))23
b(ARP)14 b(requests)e(should)g(never)i(be)f(sent)g(on)g(the)g(sunos)f
(simulator)h(platform.)23 b(If)114 312 y(you)11 b(are)i(running)e(on)h(the)h
(sunos)e(platform)h(and)g(you)g(see)g(ARP)h(requests)f(being)g(sent,)g(check)
h(the)f(ROM)h(\256le)g(on)114 369 y(the)e(sending)e(host)h(and)h(make)h(sure)
f(there)h(is)e(an)i(ARP)f(binding)f(for)h(the)g(destination)e(host.)68
463 y Fk(\017)23 b Fs(The)11 b Fr(x)p Fs(-kernel)g(aborts)g(before)g(a)h
(protocol')m(s)e(init)g(routine)g(is)h(called.)114 538 y(If)h(the)g
Fr(x)p Fs(-kernel)h(can')o(t)g(\256nd)f(a)h(protocol)d(number)j(for)f(your)g
(protocol)f(in)h(any)g(of)g(its)g(tables,)g(it)g(will)f(abort)h(before)114
594 y(calling)e(the)i(protocol')m(s)f(initialization)e(routine.)17
b(Y)-5 b(ou)12 b(will)f(need)h(to)f(add)h(an)g(entry)f(for)h(your)g(protocol)
e(in)h(one)h(of)114 651 y(the)f(tables)f(\(see)h(section)g(12.\))68
744 y Fk(\017)23 b Fs(Messages)11 b(get)g(to)f(the)h(destination)e(host)h
(but)h(never)g(make)h(it)e(up)h(to)g(the)g(appropriate)f(protocol.)114
820 y(Make)k(sure)g(that)f(the)g(source)h(and)f(destination)e(hosts)i(are)h
(running)e(with)h(identical)f(protocol)h(table)g(entries)g(for)114
876 y(the)e(protocol)f(in)h(question.)16 b(If)c(the)f(numbers)h(are)g(dif)o
(ferent,)g(messages)f(won')o(t)g(get)g(to)h(the)f(appropriate)g(protocol)114
932 y(on)f(the)h(destination)e(host.)952 2753 y(64)p eop
%%Page: 65 65
64 bop 0 124 a Ft(15)60 b(Releasing)13 b(a)i(Pr)o(otocol)0
228 y Fs(Once)d(you)f(have)h(debugged)e(and)i(tuned)f(a)h(new)g(protocol,)f
(you)g(can)h(make)g(it)f(available)g(for)h(others)f(to)h(use)f(by)h(creating)
0 284 y(a)f(new)g(directory)f(in)g Fi(/usr/xkernel/protocols)p
Fs(,)h(copying)f(your)g(source)g(\256les)h(into)f(that)g(directory)m(,)g
(creating)g(a)h(make\256le)0 340 y(in)g(that)f(directory)m(,)h(and)g
(modifying)f(the)h(make\256le)h(in)f Fi(/usr/xkernel/protocols)p
Fs(.)16 b(If)c(your)f(protocol)f(is)g(a)i(device)f(driver)n(,)0
397 y(put)f(the)h(source)g(\256les)g(in)g Fi(/usr/xkernel/PLA)m
(TFORM/drivers)g Fs(instead)f(of)i Fi(/usr/xkernel/protocols)p
Fs(.)71 453 y(If)j(you)f(want)h(to)f(make)i(your)e(new)h(protocol)e
(available)i(to)f(other)h(sites,)g(then)f(make)i(a)f(tar)g(\256le)g(of)g
(your)g(protocol)0 510 y(available)f(and)h(drop)f(a)h(note)f(to)h
Fi(xkernel-bugs@cs.arizona.edu)p Fs(.)29 b(W)l(e)16 b(will)d(include)h(your)g
(protocol)g(in)g(the)h(next)0 566 y(release.)22 b(Y)-5 b(ou)13
b(should)f(also)g(create)i(a)f(\252man)h(page\272)f(for)g(you)f(protocol)g
(similar)g(to)h(those)f(found)g(in)h(Appendix)e(A.)i(The)0
623 y(source)e(\256les)g(for)g(these)g(man)h(pages)f(are)h(in)e
Fi(/usr/xkernel/doc/manual/protocols)p Fs(.)952 2753 y(65)p
eop
%%Page: 66 66
65 bop 0 124 a Ft(16)60 b(System)14 b(Installation)0 228 y
Fs(This)c(section)g(describes)h(how)f(to)h(install)e(V)-5 b(ersion)10
b(3.2)i(of)f(the)g Fr(x)p Fs(-kernel.)17 b(By)11 b(installing)d(the)j
Fr(x)p Fs(-kernel)h(we)f(mean)h(setting)0 284 y(up)f(the)g
Fr(x)p Fs(-kernel)g(environment)f(so)h(that)g(programmers)g(can)h(begin)e
(writing)g(protocols)f(and)i(con\256guring)f(new)i(kernels.)71
340 y(The)f Fr(x)p Fs(-kernel)h(is)f(commonly)h(used)f(for)h(both)f(research)
h(and)g(instruction.)j(A)d(typical)f(scenario)g(is)g(for)h(a)g(researcher)0
397 y(\(instructor\))19 b(to)h(install)e(the)i Fr(x)p Fs(-kernel)g(for)h(use)
f(by)f(various)g(network)h(projects)f(\(students\).)42 b(Individual)18
b(projects)0 453 y(\(students\))13 b(then)i(build)e(and)i(test)f(kernels)h
(in)f(private)h(working)e(directories.)27 b(This)14 b(section)g(describes)g
(the)h(work)f(the)0 510 y(researcher)g(\(instructor\))d(needs)h(to)h(do)f(to)
g(set)h(up)f(the)g Fr(x)p Fs(-kernel)h(directory)m(.)21 b(Most)12
b(of)h(the)f(installation)e(can)j(be)g(handled)0 566 y(by)h(the)f(researcher)
i(\(instructor\).)24 b(Only)14 b(a)g(few)g(things)f(need)h(to)f(be)i(done)e
(by)h(a)g(system)g(administrator)f(that)g(has)h(root)0 623
y(permission,)c(and)h(these)g(are)h(clearly)f(documented)f(below)m(.)71
679 y(The)i Fr(x)p Fs(-kernel)h(runs)g(in)f(several)h(environments:)18
b(as)13 b(a)g(task)f(under)h(Mach3)g(or)g(within)e(the)h(Mach)i(kernel)f
(\(on)f(both)0 736 y(DecStations)e(and)h(HP)g(700)g(workstations\),)e(or)i
(as)h(a)f(user)g(process)g(on)g(top)f(of)h(SunOS,)h(release)g(4.1)f(or)g
(latter)m(.)0 860 y Fn(16.1)50 b(Unpacking)11 b(the)h Fa(tar)g
Fn(\256le)0 947 y Fs(If)j(you)e(haven')o(t)h(done)g(so)g(already)m(,)h
(create)g(a)g(new)f(directory)g(for)g(installing)e(the)i Fr(x)p
Fs(-kernel.)26 b(For)15 b(the)f(purpose)f(of)h(this)0 1003
y(report,)i(we)g(refer)g(to)f(this)f(directory)g(as)i Fc(/usr/xkernel)p
Fs(.)27 b(Y)-5 b(ou)15 b(may)h(chose)f(another)f(name,)k(however)m(.)28
b Fc(cd)16 b Fs(to)e(this)0 1060 y(directory)c(and)h(type)114
1166 y Fc(tar)23 b(xf)11 b Fr(\256le)0 1272 y Fs(where)17 b
Fr(\256le)g Fs(is)f(the)h(disk)f(or)h(tape)g(\256le)g(of)g(the)f
Fr(x)p Fs(-kernel)i(distribution)o(.)31 b(This)16 b(will)g(create)i(several)f
(subdirectories)e(in)0 1329 y Fc(/usr/xkernel)p Fs(.)0 1453
y Fn(16.2)50 b(Dir)o(ectory)12 b(Structur)o(e)0 1540 y Fs(The)f(distribution)
d(contains)i(the)h(following)e(directories:)0 1646 y Fc(bin)114
1703 y Fs(Binaries)h(for)i(utility)d(programs)i(used)g(to)f(develop)h(new)g
(kernels.)0 1797 y Fc(doc)114 1853 y Fs(Documentation.)0 1947
y Fc(etc)114 2003 y Fs(Con\256guration-related)e(data)i(\256les)h(and)f
(protocol)e(tables.)0 2097 y Fc(gen)114 2154 y Fs(Source)16
b(code)f(for)h(the)f(in-kernel)g(Mach)i(platforms.)29 b(This)15
b(code)g(is)g(automatically)g(generated)g(from)h(various)114
2210 y(con\256guration)9 b(\256les.)0 2304 y Fc(mach3)114 2360
y Fs(Sources)i(and)g(binaries)f(for)i(the)e(Mach3-based)i Fr(x)p
Fs(-kernel.)0 2454 y Fc(pi)114 2511 y Fs(Sources)17 b(and)g(binaries)g(for)g
(platform)g(independent)f(code:)28 b(the)17 b Fr(x)p Fs(-kernel')m(s)h
(object-oriented)e(infrastructure,)114 2567 y(protocol)9 b(table)i(code,)h
(and)f(the)g(message,)g(participant,)g(and)g(map)g(libraries.)952
2753 y(66)p eop
%%Page: 67 67
66 bop 0 124 a Fc(protocols)114 181 y Fs(Sources)11 b(and)g(binaries)f(for)i
(all)e(protocols)g(supported)g(in)g(this)g(release.)0 274 y
Fc(sunos)114 330 y Fs(Sources)h(and)g(binaries)f(for)i(Unix-based)d
Fr(x)p Fs(-kernel.)0 423 y Fc(util)114 480 y Fs(Utility)g(programs)i(for)g
(the)g Fr(x)p Fs(-kernel.)0 583 y(Note)j(that)g(those)g(directories)g(that)g
(contain)g Fr(x)p Fs(-kernel)h(source)f(and)h(binaries)e(actually)h(place)h
(the)f(binaries)g(in)g(several)0 639 y(sub-directories,)9 b(one)h(for)g(each)
h(\252kind\272)f(of)g(binary:)15 b Fc(DEBUGsunos)9 b Fs(\(Sun)h(binaries,)g
(compiled)f(with)h(debugging)e(turned)0 696 y(on\),)16 b Fc(OPTIMIZEsunos)e
Fs(\(Sun)h(binaries,)h(compiled)f(with)f(optimization)f(turned)i(on\),)h
Fc(DEBUGmach3)e Fs(\(Mach3)i(MIPS)0 752 y(binaries,)j(compiled)e(with)g
(debugging)e(turned)i(on\),)j Fc(OPTIMIZEmach3)c Fs(\(Mach3)i(MIPS)h
(binaries,)g(compiled)e(with)0 809 y(optimization)9 b(turned)i(on\),)g(etc.)0
933 y Fn(16.3)50 b(About)11 b(Compilers)0 1020 y Fs(V)-5 b(ersion)18
b(3.2)h(of)g(the)f Fr(x)p Fs(-kernel)i(now)e(uses)g(either)h(the)f(Gnu)h(C)g
(compiler)g(\()p Fc(gcc)p Fs(\))g(or)g(the)f(standard)g(Unix)g(compiler)0
1076 y(\()p Fc(cc)p Fs(\).)29 b(If)16 b(you)f(do)g(not)g(currently)f(have)i
(Gnu)f(C)h(at)f(your)g(site,)h(you)f(can)h(get)f(a)g(copy)g(by)g(doing)g
(anonymous)f(FTP)i(to)0 1132 y Fc(prep.ai.mit.edu)p Fs(,)10
b(and)h(retrieving)f Fc(pub/gnu/gcc.xtar)p Fs(.)0 1256 y Fn(16.4)62
b(Con\256guration)0 1343 y Fs(Many)13 b(of)f(the)g(site-speci\256c)g
(con\256guration)f(options)f(are)j(listed)e(in)h(the)g(\256le)h
Fc(xkernel/etc/site.h)p Fs(.)18 b(These)12 b(options)0 1400
y(should)c(be)i(edited)g(to)f(re\257ect)i(reasonable)f(defaults)f(for)h(your)
f(site.)16 b(Many)10 b(protocols)f(have)h(additional)e(options)g(that)h(can)0
1456 y(be)j(set)f(on)g(a)h(per)o(-execution)e(basis)h(with)g(entries)f(in)i
(a)f(\252rom)i(\256le.\272)18 b(These)11 b(options)e(are)k(described)d(in)h
(the)h(manual)f(page)0 1513 y(for)g(each)h(protocol)e(in)h(appendix)f(A.)0
1637 y Fn(16.5)50 b(Building)11 b(and)h(T)-5 b(esting)13 b(the)e(System)0
1724 y Fs(First)h(edit)g Fc(xkernel/etc/site.h)e Fs(to)h(re\257ect)j
(reasonable)d(default)h(values)g(for)g(your)g(site.)19 b(The)13
b(comments)f(in)g(site.h)0 1780 y(should)e(be)h(self-explanatory)m(.)71
1836 y(Installing)g(the)i Fr(x)p Fs(-kernel)g(consists)f(of)h(building)e(a)j
(few)g(utility)d(programs)i(used)g(to)f(develop)h(new)g(kernels.)22
b(These)0 1893 y(are)15 b(the)e(procedures)h(for)g(building)e(these)h
(programs,)i(though)e(binary)g(versions)g(are)h(distributed)e(for)i(most)g
(platforms)0 1949 y(and)c(rebuilding)e(these)h(programs)h(is)f(probably)g
(unnecessary)m(.)16 b(For)10 b(both)f(of)h(these)f(procedures,)i(you)e(need)h
(to)f(de\256ne)h(the)0 2006 y(environment)g(variable)g Fc(ARCH)h
Fs(to)g(correspond)f(to)g(the)h(type)f(of)h(binaries)f(you)h(want)f(created:)
16 b Fc(sparc)p Fs(,)11 b Fc(mips)p Fs(,)g(or)g Fc(hp700)p
Fs(.)71 2062 y(The)g Fr(x)p Fs(-kernel)g(depends)f(on)h(gnumake,)h(so)e(you)h
(\256rst)g(have)g(to)g(make)h(gnumake:)71 2143 y Fc(cd)f Fs(to)f
Fc(/usr/xkernel/util/make)f Fs(and)i(type)f Fc(make)p Fs(.)71
2223 y(Next,)h(put)g Fc(/usr/xkernel/bin/ARCH)e Fs(and)j Fc(/usr/xkernel/bin)
e Fs(in)h(your)g(search)h(path,)g(where)g(ARCH)g(is)f(as)0
2280 y(described)i(above.)22 b(They)13 b(should)e(appear)j(before)f
Fc(/bin)g Fs(and)g Fc(/usr/bin)g Fs(in)f(order)i(to)e(pick)h(up)g(gnumake)g
(before)g(the)0 2336 y(standard)8 b(Unix)g Fc(make)p Fs(.)15
b(Finally)m(,)9 b Fc(cd)23 b(/usr/xkernel/util)7 b Fs(and)i(type)f
Fc(make)23 b(setup)8 b Fs(followed)g(by)g Fc(make)24 b(install)p
Fs(.)0 2393 y(This)7 b(will)g(install)g(a)i(handful)e(of)h(programs)h(used)e
(to)h(develop)g(new)g(kernels.)15 b(\()p Fc(make)23 b(install)8
b Fs(may)h(produce)e(a)i(warning)0 2449 y(of)15 b(the)g(form:)24
b Fc(make[1]:)47 b(fopen:)g(Makedep.ARCH:)22 b(No)i(such)f(file)g(or)h
(directory)p Fs(.)j(The)15 b(missing)f(\256le)0 2506 y(will)c(be)h(created)h
(during)e(this)g(step)h(and)g(the)g(warning)f(can)h(be)h(ignored.\))71
2562 y(T)m(o)c(test)g(a)h(system,)g(build)e(a)i(kernel)f(as)h(described)f(in)
g(section)g(13)g(which)g(includes)f(one)i(or)g(more)g(of)f(the)h(test)f
(protocols)0 2618 y(\(e.g.,)k Fc(udptest)p Fs(\).)k(Y)-5 b(ou)12
b(should)d(then)i(be)g(able)g(to)g(run)g(your)f(test)h(kernel)g(as)g
(described)g(in)f(section)h(14.)952 2753 y(67)p eop
%%Page: 68 68
67 bop 0 124 a Ft(17)60 b(Installing)14 b(within)h(a)g(Mach3)f(Kernel)0
228 y Fs(The)8 b Fr(x)p Fs(-kernel)h(can)g(be)f(compiled)g(as)g(an)h
(integral)e(part)h(of)h(the)f(Mach3)h(kernel.)15 b(This)8 b(facility)f(is)h
(provided)f(for)i(researchers)0 284 y(developing)j(highly)h(ef)o(\256cient)h
(protocols)e(and)i(for)h(obtaining)d(timing)h(results)f(that)i(are)h
(exclusive)e(of)h(Mach)g(IPC)h(and)0 340 y(Unix)e(server)g(overhead.)24
b(At)13 b(the)g(present)g(time,)i(there)e(is)g(no)g(user)h(interface)f(for)h
(accessing)f(the)g Fr(x)p Fs(-kernel)h(services)f(\261)0 397
y(the)d(Mach3)i(kernel)e(can)h(boot,)f(run)h(an)g Fr(x)p Fs(-kernel)g(timing)
e(test)h(and)h(print)f(the)g(results.)15 b(A)c(more)g(usable)g(interface)f
(will)g(be)0 453 y(provided)g(in)h(the)g(future.)71 510 y(These)e(are)h
(instructions)d(for)i(building)f(a)i(version)e(of)i(the)f Fr(x)p
Fs(-kernel)h(that)f(resides)f(in)h(the)h(Mach3)g(kernel.)15
b(Y)-5 b(ou)10 b(should)0 566 y(be)h(familiar)h(with)e(the)h(build)e
(instructions)g(for)i(the)g(\252out)g(of)g(kernel\272)g(version)f(before)i
(starting.)71 623 y(In)i(the)h(mach3)g(src)g(directory)m(,)h(go)e(to)g(the)h
(kernel)f(directory)g(and)h(create)h(a)f(subdirectory)e(\252xkern\272;)j(the)
f Fr(x)p Fs(-kernel)0 679 y(source)c(tree)g(should)f(go)h(here.)71
736 y(Set)g(your)g(path)f(to)h(include)f(the)h(/usr/xkernel/bin)d(and)j
(/usr/xkernel/bin/ARCH)e(directories.)71 792 y(The)h(\256les)g(distributed)e
(\(and)i(these)g(directions\))f(have)h(been)h(used)e(with)h(the)g(MK74)g
(Mach)h(kernel)f(for)g(a)h(DecStation)0 849 y(5000.)57 955
y(1.)23 b(cd)11 b(xkern/include)57 1049 y(2.)23 b(Link)10 b(all)h(.h)g
(\256les)g(symbolically)e(to)i(the)g(xkern/include)e(directory:)185
1174 y Fc(ln)24 b(-s)f(../etc/site.h)185 1230 y(ln)h(-s)f(prot/*.h)g(.)185
1286 y(ln)h(-s)f(../pi/include/*.h)f(.)185 1343 y(ln)i(-s)f
(../mach3/include/*.h)f(.)185 1399 y(ln)i(-s)f(../protocols/*/*.h)f(.)185
1456 y(ln)i(-s)f(../protocols/util/port_mgr.c)185 1512 y(ln)h(-s)f
(../pi/msg_internal.h)185 1569 y(ln)h(-s)f(../gen/initRom.c)57
1694 y Fs(3.)g(Append)10 b(the)h(xkern/mach3/machkernel/\256les.addition)d
(\256le)j(to)g(the)g(kernel/conf/\256les)f(\256le.)114 1769
y(Append)h(the)h(xkern/mach3/machkernel/\256les.mips.addition)e(\256le)i(to)h
(the)f(kernel/conf/\256les.mips)f(\256le.)20 b(Com-)114 1825
y(ment)11 b(out)f(the)h(chips/lance.c)g(line)f(from)i(the)f(original)f
(\256les.mips.)57 1919 y(4.)23 b(Add)13 b(the)g(lines)g(from)h
(xkern/mach3/machkernel/MASTER.local,)g(MASTER.mips)g(and)f(Make\256le.mips)i
(to)114 1976 y(the)10 b(corresponding)e(\256les)j(in)e(the)i(mach)g(kernel)f
(conf)g(directory)m(.)16 b(The)10 b(variable)g(XKR)m(T)g(in)g(MASTER.local)h
(may)114 2032 y(have)g(to)g(be)g(edited)f(to)h(re\257ect)h(the)f(path)f(to)h
(the)g Fr(x)p Fs(-kernel)h(source)f(directory)f(in)h(your)g(local)f
(environment.)114 2107 y(Append)d(the)g(variable)g($)m(XLIB)g(to)g(the)g
(de\256nition)f(of)h(CC)p 1012 2107 14 2 v 14 w(FLAGS)p 1170
2107 V 16 w(NORMAL)g(in)g(mk/kernel/conf/Make\256le.template.)114
2164 y(The)k(de\256nition)e(should)h(read:)114 2276 y Fc(CC_FLAGS_NORMAL)21
b(=)j(-c)g(${CDEBUGFLAGS})e(${CPP_ENV})g(${VOLATILE})h(${XLIB})57
2389 y Fs(5.)g(T)m(wo)10 b(\256les)h(must)g(be)g(copied)g(to)g(mach3)g
(kernel)g(area:)114 2501 y Fc(xkern/mach3/machkernel/)o(device_i)o(nit.c)68
b(replaces)j(device/device_init.c)114 2558 y(xkern/mach3/drivers/xkl)o
(ance/xkl)o(ance.c)44 b(copied)23 b(as)48 b(chips/xklance.c)952
2753 y Fs(68)p eop
%%Page: 69 69
68 bop 57 124 a Fs(6.)23 b(Create)12 b(a)f(graph.comp)h(in)e(a)i(build)e
(directory)g(as)i(for)f(an)g(out-of-kernel)g(version,)f(but)h(with)f(the)h
(in-kernel)f(driver)114 181 y(\(xklance\))15 b(instead)f(of)i(the)f
(out-of-kernel)g(driver)g(\(ethdrv)m(.\))29 b(See)16 b(the)f(xklance)h(man)f
(page)h(for)g(con\256guration)114 237 y(options.)114 312 y(run)11
b Fc(compose)22 b(-f)i(<)g(graph.comp)p Fs(.)15 b(Copy)c(the)g(following)e
(\256les)i(to)g(the)g(xkern/gen)f(directory:)114 425 y Fc(traceLevels.c)114
481 y(protocols.c)114 538 y(protocols.h)114 594 y(protTbl.c)114
707 y Fs(\(default)g(versions)g(of)i(these)e(\256les)i(are)g(provided,)e
(derived)h(from)g(a)h(graph.comp)f(\256le)h(that)e(includes)g(most)h(of)g
(our)114 763 y(transport)f(protocols,)f(but)i(you)f(must)h(regenerate)h
(these)f(\256les)g(each)g(time)h(you)e(change)h(graph.comp\))57
857 y(7.)23 b(In)11 b(the)g(xkern/gen)f(directory)m(,)h(run)g(the)g
(following)e(command:)114 969 y Fc(ptbldump)22 b(../etc/prottbl)g(>)i
(ptblData.c)114 1082 y Fs(This)10 b(creates)h(a)h(compilable)e(version)g(of)i
(the)f(protocol)e(table.)57 1176 y(8.)23 b(Y)-5 b(ou)11 b(must)f(also)h
(create)h(a)f(ROM)h(\256le)g(in)f(the)f(gen)h(directory)m(.)16
b(Give)11 b(the)g(command)114 1288 y Fc(awk)23 b(-f)h(../bin/genrom.awk)d(<)j
(rom)f(>)h(initRom.c)114 1401 y Fs(The)11 b(rom)g(\256le)h(may)f(be)h(empty)f
(\(but)f(the)h(awk)g(command)h(must)f(still)e(be)i(run.\))57
1495 y(9.)23 b(Change)11 b(your)g(path)f(to)h(*exclude*)f(the)h
Fr(x)p Fs(-kernel)h(bin)e(directories.)34 1588 y(10.)23 b(If)e(you)f(need)h
(command)h(line)e(ar)o(guments,)j(like)e(those)f(used)g(by)h(udptest)e(and)i
(tcptest,)h(edit)f(the)f(\256le)h(xk-)114 1645 y(ern/mach3/pxk/init.c)15
b(to)i(simulate)g(command)h(line)f(strings.)34 b(The)17 b(\256le)h(has)f
(example)h(strings)e(for)i(running)114 1701 y(the)11 b(udp)f(test,)h(both)f
(for)h(the)g(server)h(and)f(client)f(machines.)34 1795 y(11.)23
b(Edit)10 b(mk/Make\256le-con\256g)h(to)g(adjust)f(the)h(PMAX)p
941 1795 14 2 v 16 w(CONFIG)h(con\256guration)e(to)h(be)114
1908 y Fc(STD+ANY-mips_code+fixpr)o(i+xk)114 2020 y Fs(to)f(have)i(x-kernel)e
(compiled)h(in)g(\252debug\272)f(mode)i(or)114 2133 y Fc
(STD+ANY-mips_code+fixpr)o(i+xko)114 2245 y Fs(to)e(have)i(the)e(x-kernel)h
(compiled)g(in)g(optimized)f(mode.)34 2339 y(12.)23 b(In)12
b(the)g(mach3)h(kernel)f(directory)g(\(src/mk/kernel\),)h(run)f('make'.)21
b(This)12 b(will)f(create)j(the)e(Make\256le)h(and)f(depen-)114
2395 y(dencies)e(in)h(the)g(obj)f(directory)h(and)g(will)f(compile)h(the)g
(Mach)h(kernel)e(with)h Fr(x)p Fs(-kernel)g(additions.)34 2489
y(13.)23 b(If)12 b(you)g(have)h(problems)e(with)h(kernels)g(crashing)f
(because)i(of)f(storage)g(exhaustion,)f(you)h(might)g(want)f(to)h(adjust)114
2546 y(the)g(zone)i(block)e(table)h(in)f(the)h(Mach)h(kernel)f(\256le)g
(kalloc.c.)22 b(See)14 b(the)f Fr(x)p Fs(-kernel)h(\256le)f(xkernel/pi/msg)p
1766 2546 V 14 w(internal.h)114 2602 y(for)e(the)g(size)g(of)g(a)h(message)f
(block;)f(these)h(account)g(for)g(most)g(of)g(the)g Fr(x)p
Fs(-kernel)g(storage)g(use.)952 2753 y(69)p eop
%%Page: 70 70
69 bop 34 124 a Fs(14.)23 b(The)15 b(machkernel)g(will)f(come)h(up)g(by)g
(default)f(with)g(both)g(the)h(Unix)f(server)h(and)g(the)g
Fr(x)p Fs(-kernel)g(receiving)f(and)114 181 y(sending)c(network)g(packets)h
(\(incoming)f(packets)h(are)h(copied)f(to)g(both)f(the)h Fr(x)p
Fs(-kernel)h(and)f(the)g(Unix)g(server)m(.\))18 b(For)114 237
y(accurate)10 b(kernel-kernel)g(timings)f(of)h Fr(x)p Fs(-kernel)h
(protocols,)e(boot)g(the)h(mach)p 1332 237 14 2 v 17 w(kernel)g(image)h
(\(which)e(doesn')o(t)h(start)114 294 y(the)e(user)g(task\))g(instead)f(of)h
(the)g(mach.boot)h(image)f(and)g(con\256gure)h(the)f(in-kernel)f(driver)h
(\(xklance\))g(to)g(not)g(deliver)114 350 y(incoming)i(packets)g(to)h(the)g
(user)g(task)g(as)g(described)f(in)h(Appendix)f(A.)34 444 y(15.)23
b(If)11 b(you)g(get)g(a)g(load-time)g(error)h(of)f(the)g(form:)114
556 y Fc(gp)23 b(relocation)g(out-of-range)f(errors)h(have)g(occured)g(and)h
(bad)f(object)g(file)114 613 y(produced)f(\(corrective)h(action)g(must)g(be)h
(taken\))114 669 y(Best)f(-G)h(num)f(value)g(to)h(compile)f(all)g(-count'ed)g
(objects)g(creating)114 726 y(mach_kernel.MK74.STD+AN)o(Y-mips_c)o(ode+fix)o
(pri+xk.)o(out)e(with)i(is)h(30)114 838 y Fs(consider)16 b(changing)h(the)g
(value)h(of)f(the)h(GPSIZE)f(\257ag)h(in)g(kernel/conf/MASTER.mips)e(from)i
(32)g(to)f(0)g(and)114 895 y(rebuilding)12 b(from)i(scratch.)25
b(This)13 b(seems)h(to)g(allow)f(the)h(kernel)f(to)h(build,)g(although)e(the)
i(user)g(process)f(doesn')o(t)114 951 y(seem)e(to)f(come)i(up)e(properly)g
(under)g(this)g(modi\256cation.)15 b(This)10 b(error)h(can)g(also)f(be)h
(avoided)f(by)g(not)g(linking)f(in)h(as)114 1008 y(many)h Fr(x)p
Fs(-kernel)h(protocols.)952 2753 y(70)p eop
%%Page: 71 71
70 bop 0 124 a Ft(A)60 b(Pr)o(otocol)13 b(Speci\256cations)0
228 y Fs(This)g(appendix)g(describes)g(each)i(of)f(the)f(protocols)g
(currently)g(implemented)g(in)h(the)g Fr(x)p Fs(-kernel.)25
b(The)14 b(description)e(for)0 284 y(each)g(protocol)d(provides)h(the)h
(following)e(information.)0 408 y Fn(NAME)0 495 y Fs(Name)16
b(of)f(the)g(protocol.)27 b(This)14 b(name,)j(given)d(in)h(all)f(lower)o
(-case)h(letters,)h(can)f(be)h(given)e(as)h(an)g(ar)o(gument)g(to)g
Fi(xGet-)0 552 y(ProtlByName)e Fs(to)f(get)g(a)g(capability)f(for)h(the)g
(protocol.)18 b(Note)11 b(that)h(there)g(are)h(multiple)e(implementations)f
(of)i(various)0 608 y(protocols;)d(i.e.,)j(a)f(given)g(name)g(might)f(map)i
(to)e(multiple)g(implementations.)15 b(The)10 b(implementation)g(bound)g(to)g
(a)i(name)0 665 y(in)f(a)g(given)g(kernel)g(is)f(set)h(in)g
Fc(graph.comp)p Fs(.)0 789 y Fn(SPECIFICA)l(TION)0 876 y Fs(Reference)g(to)f
(a)g(document)g(that)f(gives)g(the)h(speci\256cation)f(for)h(the)g(protocol.)
15 b(In)10 b(cases)g(where)g(no)g(formal)g(speci\256cation)0
932 y(exists,)g(this)g(section)g(gives)h(a)g(high-level)f(description)f(of)j
(the)e(protocol.)0 1057 y Fn(SYNOPSIS)0 1144 y Fs(A)f(brief)g(description)e
(of)i(what)f(the)h(protocol)e(does.)16 b(Outlines)7 b(any)i(unusual)e
(features)i(and)g(bugs,)g(including)d(any)j(features)0 1200
y(of)i(the)g(protocol)f(speci\256cation)g(not)h(implemented.)0
1324 y Fn(REALM)0 1411 y Fs(Indicates)i(whether)g(the)g(protocol)f(is)h(in)g
(the)g(ASYNC)g(realm)h(\(supporting)d(push,)j(demux)f(and)g(pop\),)h(the)f
(RPC)i(realm)0 1468 y(\(supporting)9 b(call,)j(calldemux)f(and)h(callpop\),)f
(the)g(CONTROL)h(realm)g(\(existing)e(only)h(to)g(allow)g(control)f
(operations\),)0 1524 y(or)h(the)g(ANCHOR)g(realm)h(\(interfacing)f(with)f
(the)h(host)f(system.\))0 1649 y Fn(P)l(AR)n(TICIP)l(ANTS)0
1736 y Fs(A)16 b(discussion)d(of)i(the)h(number)f(of)h(participants)e(the)h
(protocol)f(expects)h(to)g(see)h(and)f(what)g(it)g(expects)g(to)h(see)f(on)g
(the)0 1792 y(participants')10 b(stacks.)0 1916 y Fn(CONTROL)i(OPERA)l(TIONS)
0 2003 y Fs(Non-standard)d(control)g(operations)g(supported)g(by)g(the)h
(protocol.)15 b(For)c(each)g(control)e(operation,)h(the)g(type)f(of)i(the)f
(input)0 2060 y(and)j(output)f(ar)o(gument)h(is)g(given)f(\(i.e.,)j(the)e
(type)g(used)g(to)g(interpret)f(the)h(buf)o(fer)h(ar)o(gument\))f(and)g
(whether)g(the)g(control)0 2116 y(operation)c(is)g(understood)g(by)g
Fc(x)p 517 2116 15 2 v 17 w(controlsessn)g Fs(or)h Fc(controlprotl)e
Fs(\(or)i(both\))g(is)f(speci\256ed.)16 b(In)10 b(the)g(case)g(of)g(control)0
2173 y(operations)h(that)i(take)f(multiple)g(ar)o(guments,)h(we)g(give)f(a)i
(set)e(of)h(types.)21 b(Non-primitive)11 b(types)h(are)h(generally)f
(de\256ned)0 2229 y(in)f(the)g(protocol')m(s)f Fc(.h)h Fs(\256le.)0
2354 y Fn(EXTERNAL)i(INTERF)l(ACE)0 2441 y Fs(Interfaces)f(not)e
(encapsulated)g(within)g Fr(x)p Fs(-kernel)h(operations)952
2753 y(71)p eop
%%Page: 72 72
71 bop 0 124 a Fn(CONFIGURA)l(TION)0 211 y Fs(A)8 b(description)e(of)i
(con\256guration)e(options)g(for)i(the)f(protocol,)h(including)e
(descriptions)f(of)j(of)g(what)g(this)e(protocol)h(expects)0
268 y(of)14 b(the)f(protocols)f(below)h(it.)23 b(If)14 b(the)f(protocol)f
(can)i(only)e(be)i(con\256gured)f(above)g(a)h(certain)g(protocol,)f(the)g
(appropriate)0 324 y(graph.comp)e(line)g(is)f(given)h(explicitly)m(.)0
448 y Fn(AUTHORS)0 535 y Fs(Who)g(to)f(complain)h(to)g(when)g(the)f(protocol)
g(fails)h(to)g(work)f(as)i(advertized.)952 2753 y(72)p eop
%%Page: 73 73
72 bop 0 124 a Fn(NAME)0 211 y Fs(ARP)12 b(\(Address)e(Resolution)g
(Protocol\))0 334 y Fn(SPECIFICA)l(TION)0 421 y Fs(D.)17 b(Plummer)m(.)34
b Fr(An)16 b(Ethernet)f(Addr)n(ess)h(Resolution)e(Pr)n(otocol)p
Fs(.)31 b(Request)17 b(for)f(Comments)h(826,)h(USC)f(Information)0
478 y(Sciences)11 b(Institute,)f(Marina)i(del)f(Ray)m(,)h(Calif.,)g(Nov)m(.)k
(1982.)0 601 y Fn(SYNOPSIS)0 688 y Fs(ARP)f(translates)e(IP)i(addresses)e
(into)g(ethernet)h(addresses,)h(and)e(vice)i(versa)f(\(i.e.,)i(it)e(also)f
(implements)h(RARP\).)h(This)0 744 y(implementation)h(of)h(ARP)g(supports)e
(a)j(single)d(interface,)k(but)e(may)g(be)g(multiply)e(instantiated)g(to)i
(support)e(several)0 801 y(network)10 b(interfaces.)0 924 y
Fn(REALM)0 1011 y Fs(ARP)i(is)f(in)g(the)g(CONTROL)g(realm.)18
b(There)12 b(are)g(no)f(ARP)h(sessions)d(\261)j(control)e(operations)g(may)i
(be)f(performed)h(on)f(the)0 1067 y(protocol)f(object)g(only)m(.)0
1190 y Fn(CONTROL)i(OPERA)l(TIONS)0 1277 y Fc(RESOLVE:)22 b
Fs(Maps)11 b(an)g(IP)h(address)f(into)f(an)h(ethernet)g(address.)114
1369 y Fo(Input:)23 b Fc(IPhost)114 1439 y Fo(Output:)h Fc(ETHhost)0
1530 y(RRESOLVE:)d Fs(Maps)12 b(an)f(ethernet)g(address)g(into)f(an)h(IP)h
(address.)114 1622 y Fo(Input:)23 b Fc(ETHhost)114 1692 y Fo(Output:)h
Fc(IPhost)0 1784 y(ARP)p 75 1784 15 2 v 17 w(INSTALL:)d Fs(Installs)10
b(an)h(IP)h(address)f(to)g(ETH)f(address)h(binding.)114 1875
y Fo(Input:)23 b Fs(ArpBinding)10 b(==)g Fk(f)p Fc(ETHhost)23
b(eth;)g(IPhost)g(ip;)p Fk(g)114 1945 y Fo(Output:)h Fs(none)0
2037 y Fc(ARP)p 75 2037 V 17 w(GETMYBINDING:)d Fs(Return)11
b(the)g(IP)g(and)g(ETH)g(address)g(of)g(the)g(local)g(host)f(for)h(the)g
(interface.)114 2128 y Fo(Input:)23 b Fs(none)114 2199 y Fo(Output:)h
Fs(ArpBinding)9 b(==)i Fk(f)p Fc(ETHhost)23 b(eth;)g(IPhost)g(ip;)p
Fk(g)0 2322 y Fn(CONFIGURA)l(TION)0 2409 y Fc(name=arp)g(protocols=eth;)0
2532 y Fn(AUTHORS)0 2619 y Fs(Larry)11 b(Peterson)g(and)g(Norm)h(Hutchinson)
952 2753 y(73)p eop
%%Page: 74 74
73 bop 0 124 a Fn(NAME)0 211 y Fs(BID)12 b(\(Boot)f(ID)g(Protocol\))0
336 y Fn(SPECIFICA)l(TION)71 423 y Fs(BID)d(is)g(the)g(\256ltering)f(modu)o
(le)h(o)o(f)g(th)o(e)g(BootId)f(prot)o(ocol.)12 b(The)c(BootId)g(protocol)f
(is)g(desi)o(gned)g(to)g(advi)o(se)h(wo)o(rkst)o(ation)o(s)0
479 y(that)18 b(a)g(peer)h(has)f(rebooted,)h(to)f(protect)g(protocols)f(from)
h(receiving)g(messages)g(generated)g(during)f(previous)g(boot)0
535 y(incarnations,)10 b(and)h(to)g(inform)g(higher)f(protocols)g(of)h(a)h
(peer)r(')m(s)f(reboot)g(in)f(a)i(timely)e(fashion.)71 592
y(If)j(an)h(upper)f(protocol)f(registers)g(with)h(BIDCTL)g(protocol)f(and)i
(messages)f(from)h(its)e(session)g(pass)h(through)f(BID)0 648
y(sessions,)h(the)g(BootId)g(protocol)f(guarantees)h(that)g(a)h(message)g
(from)g(a)f(rebooted)g(peer)h(will)f(not)f(be)i(sent)f(to)g(an)h(upper)0
705 y(protocol)c(until)g(the)g(upper)h(protocol)f(has)h(been)g(informed)g(of)
h(the)e(reboot.)0 829 y Fn(SYNOPSIS)0 916 y Fs(BID)19 b(sessions)e(stamp)h
(all)h(outgoing)d(messages)j(with)e(a)i(local)f(and)h(remote)g(BootId)f(and)g
(\256lter)h(out)f(all)g(incoming)0 973 y(messages)d(which)g(do)g(not)g(have)g
(the)g(correct)h(BootIds.)28 b(Determination)14 b(of)i(the)f(\252correct\272)
h(BootId)f(is)f(made)i(by)f(the)0 1029 y(BIDCTL)c(protocol.)16
b(BID)11 b(requires)g(BIDCTL.)71 1085 y(BID)e(is)f(not)g(reliable.)15
b(If)9 b(there)f(is)h(confusion)e(between)h(two)g(peers)g(as)h(to)f(what)g
(their)g(mutual)g(BootIds)g(are,)i(messages)0 1142 y(between)h(them)g(will)f
(be)h(silently)f(dropped)g(until)g(the)h(confusion)e(is)i(resolved.)0
1266 y Fn(REALM)0 1353 y Fs(BID)h(is)e(in)h(the)g(ASYNC)g(realm.)0
1478 y Fn(P)l(AR)n(TICIP)l(ANTS)0 1565 y Fs(BID)g(expects)f(an)h(IPhost)f(on)
g(the)h(top)e(of)i(each)g(participant.)k(It)c(examines)f(this)g(value)g(but)g
(does)g(not)g(remove)h(it)f(form)h(the)0 1621 y(participant)f(stack)h(before)
g(opening)f(its)g(transport)g(protocol.)0 1745 y Fn(CONFIGURA)l(TION)0
1832 y Fs(BID)j(expects)f(to)f(be)i(con\256gured)f(above)g(two)f(protocols.)
19 b(The)12 b(\256rst)g(is)g(the)g(transport)f(protocol)g(and)h(the)g(second)
g(is)f(the)0 1889 y(BIDCTL)g(protocol.)0 2013 y Fn(AUTHORS)0
2100 y Fs(Ed)g(Menze)952 2753 y(74)p eop
%%Page: 75 75
74 bop 0 124 a Fn(NAME)0 211 y Fs(BIDCTL)11 b(\(Bootid)g(Control)f
(Protocol\))0 335 y Fn(SPECIFICA)l(TION)0 422 y Fs(BIDCTL)e(is)g(the)g
(control)f(modu)o(le)h(of)f(the)g(BootId)g(prot)o(ocol.)12
b(The)c(BootId)g(protocol)f(is)g(desi)o(gned)g(to)g(advi)o(se)h(wo)o(rkst)o
(ation)o(s)0 478 y(that)18 b(a)g(peer)h(has)f(rebooted,)h(to)f(protect)g
(protocols)f(from)h(receiving)g(messages)g(generated)g(during)f(previous)g
(boot)0 535 y(incarnations,)10 b(and)h(to)g(inform)g(higher)f(protocols)g(of)
h(a)h(peer)r(')m(s)f(reboot)g(in)f(a)i(timely)e(fashion.)71
591 y(If)j(an)h(upper)f(protocol)f(registers)g(with)h(BIDCTL)g(protocol)f
(and)i(messages)f(from)h(its)e(session)g(pass)h(through)f(BID)0
647 y(sessions,)h(the)g(BootId)g(protocol)f(guarantees)h(that)g(a)h(message)g
(from)g(a)f(rebooted)g(peer)h(will)f(not)f(be)i(sent)f(to)g(an)h(upper)0
704 y(protocol)c(until)g(the)g(upper)h(protocol)f(has)h(been)g(informed)g(of)
h(the)e(reboot.)0 827 y Fn(SYNOPSIS)0 914 y Fs(Upper)i(protocols)f(register)g
(their)h(desire)g(to)g(be)g(informed)g(of)g(a)h(peer)r(')m(s)g(reboot)e(by)h
(openEnabling)e(BIDCTL)j(with)e(that)0 971 y(remote)g(peer)r(')m(s)g(IPhost.)
16 b(When)10 b(BIDCTL)h(determines)f(that)g(the)g(remote)h(peer)g(has)f
(rebooted,)g(it)g(informs)g(all)g(interested)0 1027 y(upper)i(protocols)e
(via)i(a)g(control)f(operation)f(\(see)j(below)m(.\))18 b(If)12
b(an)g(upper)g(protocol)f(is)g(no)h(longer)f(interested)g(in)g(learning)0
1084 y(about)f(a)i(peer)r(')m(s)f(reboot,)g(it)g(may)h(openDisable)d(BIDCTL.)
0 1207 y Fn(REALM)0 1294 y Fs(BIDCTL)i(is)g(in)g(the)g(CONTROL)g(realm.)17
b(There)11 b(are)h(no)f(BIDCTL)h(sessions.)0 1417 y Fn(P)l(AR)n(TICIP)l(ANTS)
0 1504 y Fs(BIDCTL)f(openEnable)f(and)h(openDisable)f(expect)h(a)h(single)e
(participant)f(containing)h(the)g(IPhost)h(of)g(the)g(remote)h(peer)m(.)0
1628 y Fn(CONTROL)g(OPERA)l(TIONS)0 1715 y Fc(BIDCTL)p 147
1715 15 2 v 16 w(PEER)p 259 1715 V 17 w(REBOOTED:)21 b Fs(Invoked)14
b Fr(by)g Fs(BIDCTL)g(on)f(registered)h(upper)f(protocols)g(to)g(inform)h
(them)g(that)f(a)i(peer)114 1771 y(has)8 b(rebooted.)15 b(The)8
b Fr(id)g Fs(\256eld)g(of)h(the)f(BidctlBootMsg)f(contains)g(the)h(new)g
(remote)h(BootId.)15 b(The)8 b(upper)g(protocol')m(s)114 1828
y(control)i(function)g(should)f(not)i(block)f(while)g(handling)g(this)g
(noti\256cation.)114 1930 y Fo(Input:)23 b Fc(BidctlBootMsg)f(==)i
Fk(f)f Fc(IPhost)g(h;)h(BootId)f(id;)h Fk(g)114 2002 y Fo(Output:)g
Fs(none)71 2104 y(The)8 b(remaining)g(control)g(operations)f(are)j(not)e
(necessary)g(for)h(most)g(users)f(of)h(BIDCTL.)g(They)f(are)i(provided)d
(mostly)0 2161 y(for)k(the)g(use)g(of)g(\256ltering)g(protocols)e(\(e.g.,)k
(BID\))f(which)e(work)h(in)g(conjunction)e(with)h(BIDCTL.)0
2260 y Fc(BIDCTL)p 147 2260 V 16 w(FIRST)p 283 2260 V 17 w(CONTACT:)21
b Fs(Invoked)9 b Fr(by)h Fs(BIDCTL)g(on)g(registered)f(upper)g(protocols)f
(to)i(inform)f(them)h(that)f(an)h(initial)114 2317 y(bootid)i(for)i(the)f
(given)g(peer)i(has)e(been)h(discovered.)24 b(The)13 b Fr(id)h
Fs(\256eld)f(of)h(the)g(BidctlBootMsg)e(contains)h(the)g(new)114
2373 y(remote)e(BootId.)114 2465 y Fo(Input:)23 b Fc(BidctlBootMsg)114
2537 y Fo(Output:)h Fs(none)0 2629 y Fc(BIDCTL)p 147 2629 V
16 w(GET)p 235 2629 V 17 w(LOCAL)p 372 2629 V 17 w(BID:)e Fs(Returns)11
b(the)f(current)i(BootId)e(of)h(the)g(local)g(host.)952 2753
y(75)p eop
%%Page: 76 76
75 bop 114 124 a Fo(Input:)23 b Fs(none)114 197 y Fo(Output:)h
Fc(BootId)0 291 y(BIDCTL)p 147 291 15 2 v 16 w(GET)p 235 291
V 17 w(PEER)p 348 291 V 17 w(BID:)e Fs(Returns)12 b(the)g(last)g(con\256rmed)
h(BootId)f(of)g(the)g(given)g(remote)g(host.)20 b(If)13 b(the)f
Fr(id)g Fs(\256eld)g(of)g(the)114 348 y(input)i(structure)g(is)h(non-zero,)i
(it)e(indicates)f(a)i(possible)d(new)i(value.)29 b(If)16 b(this)e(value)h
(dif)o(fers)h(from)g(BIDCTL)l(')m(s)114 404 y(con\256rmed)10
b(value)f(for)h(that)e(peer)n(,)j(BIDCTL)f(will)f(start)g(a)h(handshake)e
(with)h(the)g(remote)h(peer)g(to)f(determine)g(a)h(new)114
460 y(con\256rmed)k(value.)25 b(The)14 b(input)f(id)h(can)g(be)g(used)g(by)g
(a)g(\256ltering)f(protocol)g(to)h(indicate)f(that)g(it)h(has)g(seen)g(a)g
(new)114 517 y(remote)d(BootId)g(value.)114 592 y(The)k(BootId)h(of)f(the)h
(output)e(structure)h(will)g(be)h(0)f(\(an)h(invalid)f(BootId\))g(if)h
(BIDCTL)g(doesn')o(t)f(yet)g(know)g(the)114 649 y(peer)r(')m(s)c(BootId.)114
742 y Fo(Input:)23 b Fc(BidctlBootMsg)114 815 y Fo(Output:)h
Fc(BidctlBootMsg)0 909 y(BIDCTL)p 147 909 V 16 w(GET)p 235
909 V 17 w(PEER)p 348 909 V 17 w(BID)p 437 909 V 17 w(BLOCKING:)d
Fs(Dif)o(fers)d(from)h Fc(BIDCTL)p 1088 909 V 16 w(GET)p 1176
909 V 17 w(PEER)p 1289 909 V 16 w(BID)f Fs(in)g(that)f(the)h(calling)f
(thread)g(will)114 966 y(block)d(if)g(BIDCTL)h(has)g(not)f(yet)h(learned)f
(the)h(peer)r(')m(s)g(BootId)f(or)h(if)g(the)f(suggested)f
Fr(id)i Fs(\256eld)g(is)f(non-zero)g(and)114 1022 y(dif)o(fers)9
b(from)h(the)g(protocol')m(s)e(current)i(value)f(for)h(the)g(peer)g(BootId.)
15 b(If)10 b(the)g(operation)e(blocks,)h(it)g(will)g(not)g(release)114
1079 y(the)i(calling)f(thread)h(until)e(the)i(peer)h(BootId)e(has)h(been)h
(con\256rmed.)17 b(There)11 b(is)g(no)g(timeout.)114 1185 y
Fo(Input:)23 b Fc(BidctlBootMsg)114 1258 y Fo(Output:)h Fc(BidctlBootMsg)0
1382 y Fn(CONFIGURA)l(TION)0 1469 y Fs(BIDCTL)18 b(expects)f(only)f(its)h
(transport)f(protocol)g(below)h(it.)35 b(It)17 b(will)g(open)g(the)g
(transport)f(protocol)g(with)h(a)g(single)0 1526 y(participant)10
b(consisting)e(of)k(the)f(remote)g(IP)h(host.)71 1582 y(BIDCTL)17
b(uses)f(an)h(internal)e(checksum)i(and)g(works)f(correctly)g(in)g(the)h
(presence)g(of)f(dropped)g(messages,)j(so)d(a)0 1639 y(reliable)11
b(transport)f(protocol)f(is)i(not)g(necessary)m(.)71 1695 y(As)f(an)g
(optimization,)f(BIDCTL)i(can)f(perform)h(an)g(IP)g(local-net)e(broadcast)h
(to)g(inform)g(interested)f(peers)i(that)f(it)f(has)0 1751
y(rebooted.)16 b(A)11 b(rom)h(\256le)f(entry)g(of)g(the)g(form:)215
1845 y Fc(bidctl)23 b(bcast)0 1939 y Fs(will)10 b(cause)h(the)g(broadcast)g
(and)g(an)g(entry)g(of)g(the)g(form:)215 2033 y Fc(bidctl)23
b(nobcast)0 2127 y Fs(will)29 b(suppress)f(it.)72 b(W)n(ithout)29
b(a)h(rom)g(\256le)g(entry)m(,)35 b(BIDCTL)30 b(will)f(perform)h(the)g
(broadcast)f(unless)g(BID-)0 2183 y(CTL)p 89 2183 14 2 v 16
w(NO)p 171 2183 V 16 w(BOOT)p 311 2183 V 16 w(BCAST)12 b(is)f(de\256ned)g
(during)f(compilation.)0 2308 y Fn(AUTHORS)0 2395 y Fs(Ed)h(Menze)952
2753 y(76)p eop
%%Page: 77 77
76 bop 0 124 a Fn(NAME)0 211 y Fs(BLAST)11 b(\(RPC)i(Blast)e
(Micro-Protocol\))0 335 y Fn(SPECIFICA)l(TION)0 422 y Fs(S.)h(O'Malley)g(and)
f(L.)h(Peterson.)18 b(A)11 b(Dynamic)h(Network)f(Architecture.)17
b Fr(ACM)12 b(T)m(ransactions)d(on)i(Computer)g(Systems)0 479
y(10)p Fs(,)g(2)g(\(May)h(1992\),)f(110\261143.)0 560 y(B.)i(W)l(elch.)21
b Fr(The)13 b(Sprite)e(r)n(emote)h(pr)n(ocedur)n(e)g(call)p
Fs(.)20 b(University)10 b(of)j(California)f(at)g(Berkeley)m(,)i(T)m(ech)e
(Report)h(UCB/CSD)0 616 y(86/302,)d(June)h(1986.)0 740 y Fn(SYNOPSIS)0
827 y Fs(BLAST)h(is)f(a)h(micro-protocol)e(version)h(of)g(Sprite)h(RPC')m(s)h
(fragmentation)d(algorithm.)17 b(The)11 b(algorithm)g(was)g(extracted)0
884 y(from)i(Sprite)e(and)h(made)h(into)d(a)j(stand-alone)e(protocol.)17
b(BLAST)12 b(takes)g(a)g(lar)o(ge)g(message,)h(fragments)f(it)f(into)g
(smaller)0 940 y(packets,)k(and)f(sends)f(them.)25 b(The)14
b(maximum)h(packet)f(size)g(accepted)g(by)g(BLAST)g(\(as)g(returned)g(by)g
(the)f(GETMAX-)0 996 y(P)l(ACKET)8 b(control)g(op\))g(is)g(the)g(product)f
(of)i(the)f(maximum)h(number)f(of)h(fragments)f(handled)g(by)g(BLAST)g(\(16)h
(by)f(default\))0 1053 y(and)j(the)g(optimal)f(packet)h(size)g(of)g(BLAST')m
(s)h(lower)f(protocol.)71 1109 y(The)h(receiver)h(gathers)f(all)g(of)h(the)f
(packets)g(and)g(sends)g(a)h(NACK)f(if)h(it)f(has)g(reason)g(to)g(believe)g
(\(through)f(timeouts)0 1166 y(or)k(other)f(considerations\))f(that)h(a)h
(packet)g(has)f(been)h(dropped.)27 b(BLAST)15 b(can)g(handle)f(any)h(number)f
(on)h(outstanding)0 1222 y(messages)h(between)g(two)g(hosts)f(\(buf)o(fer)i
(space)g(permitting,)f(of)h(course\).)32 b(The)16 b(protocol)f(is)h
(bi-directional;)h(i.e.,)i(it)0 1279 y(supports)d(blasts)h(in)g(both)g
(directions)f(over)i(the)g(same)g(session.)35 b(Small)19 b(messages)e(take)h
(a)g(short)f(cut)h(through)e(the)0 1335 y(protocol)10 b(and)h(do)g(not)f
(require)h(the)g(allocation)f(of)h(any)g(resources.)71 1392
y(The)h(sender)g(keeps)g(a)h(copy)f(of)g(the)g(message)h(around)e(until)g(a)i
(timeout)f(occurs)g(or)g(the)g(higher)g(level)g(protocol)f(that)0
1448 y(sent)i(the)g(message)g(noti\256es)f(BLAST)i(that)e(it)h(can)h(free)g
(the)f(message)g(\(through)f(a)i(FREERESOURCES)g(control)e(op.\))0
1505 y(Because)h(the)g(sending)e(BLAST)i(may)g(timeout)f(and)h(release)g(a)g
(message)g(before)g(all)f(fragments)h(have)g(been)g(received,)0
1561 y(BLAST)e(is)g(not)f(reliable.)17 b(It)11 b(is,)g(however)n(,)g(very)g
(persistent.)0 1685 y Fn(REALM)0 1772 y Fs(BLAST)g(is)g(in)g(the)g(ASYNC)g
(realm.)0 1896 y Fn(P)l(AR)n(TICIP)l(ANTS)0 1983 y Fs(BLAST)g(neither)g
(removes)g(nor)g(adds)g(anything)e(to)i(the)g(participant)f(stacks.)0
2107 y Fn(CONTROL)i(OPERA)l(TIONS)0 2194 y Fc(BLAST)p 123 2194
15 2 v 16 w(SETOUTSTANDINGMSGS:)21 b Fs(Set)11 b(the)g(number)g(of)g
(outstanding)e(messages)i(allowed)f(\(protocol)g(only\).)114
2287 y Fo(Input:)23 b Fc(int)114 2360 y Fo(Output:)h Fs(none)0
2453 y Fc(BLAST)p 123 2453 V 16 w(GETOUTSTANDINGMSGS:)d Fs(Get)11
b(the)g(number)g(of)g(outstanding)d(messages)k(allowed)e(\(protocol)g
(only\).)114 2546 y Fo(Input:)23 b Fs(none)114 2619 y Fo(Output:)h
Fc(int)952 2753 y Fs(77)p eop
%%Page: 78 78
77 bop 0 124 a Fn(CONFIGURA)l(TION)0 211 y Fs(BLAST)14 b(requires)f(only)g
(its)f(lower)i(transport)e(protocol.)23 b(Since)13 b(BLAST)h(doesn')o(t)f
(use)g(host)g(addresses,)h(it)f(can)h(sit)f(on)0 268 y(top)d(of)i(protocols)d
(using)h(dif)o(ferent)h(address)g(types)f(without)f(modi\256cation.)0
392 y Fn(AUTHOR)0 479 y Fs(Sean)j(O'Malley)f(and)g(Ed)g(Menze)952
2753 y(78)p eop
%%Page: 79 79
78 bop 0 124 a Fn(NAME)0 211 y Fs(CHAN)11 b(\(RPC)i(Channel)d
(Micro-Protocol\))0 334 y Fn(SPECIFICA)l(TION)0 421 y Fs(S.)i(O'Malley)g(and)
f(L.)h(Peterson.)18 b(A)11 b(Dynamic)h(Network)f(Architecture.)17
b Fr(ACM)12 b(T)m(ransactions)d(on)i(Computer)g(Systems)0 478
y(10)p Fs(,)g(2)g(\(May)h(1992\),)f(110\261143.)0 556 y(B.)i(W)l(elch.)21
b Fr(The)13 b(Sprite)e(r)n(emote)h(pr)n(ocedur)n(e)g(call)p
Fs(.)20 b(University)10 b(of)j(California)f(at)g(Berkeley)m(,)i(T)m(ech)e
(Report)h(UCB/CSD)0 612 y(86/302,)d(June)h(1986.)0 735 y Fn(SYNOPSIS)0
822 y Fs(CHAN)18 b(is)f(a)h(single)e(protocol)g(version)h(of)h(Sprite)f(RPC')
m(s)i(reliable)e(request-reply)g(channel.)35 b(The)18 b(algorithm)e(was)0
879 y(extracted)10 b(from)g(Sprite)g(and)g(made)h(into)e(a)h(stand-alone)f
(protocol.)15 b(Each)10 b(CHAN)g(session)e(supports)g(the)i(Birrel-Nelson)0
935 y(implicit)g(acking)g(RPC)j(algorithm)d(between)h(two)f(hosts.)71
991 y(CHAN)i(provides)f(\252at)h(most)g(once\272)h(RPC)g(semantics.)20
b(When)12 b(a)h(CHAN)f(call)g(returns)g(successfully)m(,)f(the)i(protocol)0
1048 y(guarantees)e(that)g(the)h(request)f(has)g(been)h(processed)f(exactly)g
(once)h(by)f(the)h(server)m(.)18 b(If)13 b(CHAN)e(returns)g(unsuccessfully)0
1104 y(\(XK)p 84 1104 14 2 v 16 w(F)m(AILURE\),)g(the)g(server)g(may)h(have)f
(processed)f(the)h(request)f(once,)i(or)f(it)f(may)i(not)e(have)h(seen)g(the)
g(request)f(at)h(all.)71 1161 y(Channel)k(numbers)g(are)h(entirely)e
(internal)h(to)g(the)g(CHAN)g(protocol.)28 b(When)15 b(a)h(new)f(client)g
(channel)g(session)f(is)0 1217 y(created,)20 b(a)e(new)g(host-host)e(channel)
h(number)h(is)f(selected)h(internally)e(by)i(CHAN.)g(When)f(protocols)f
(openEnable)0 1274 y(CHAN,)d(they)e(will)h(receive)h(connections)d(from)j
(any)f(channel)g(number)h(on)f(any)g(remote)g(host.)20 b(Each)12
b(open)g(of)g(CHAN)0 1330 y(by)f(a)g(client)g(session)e(will)h(result)h(in)g
(the)f(passive)h(creation)f(of)i(a)f(corresponding)f(session)f(on)i(the)g
(server)m(.)71 1387 y(Each)j(channel)g(session)g(will)f(accept)i(only)f(a)h
(single)e(outstanding)f(request.)26 b(Sending)14 b(additional)f(requests)h
(on)g(a)0 1443 y(channel)d(before)g(the)g(\256rst)g(request)g(has)g(returned)
g(is)f(not)h(allowed.)71 1500 y(CHAN)f(relies)h(on)f(the)h(BIDCTL)g(and)g
(BID)g(protocols)e(to)i(determine)f(when)h(a)g(peer)g(has)g(rebooted.)16
b(When)10 b(noti\256ed)0 1556 y(of)19 b(a)h(peer)r(')m(s)g(reboot,)h(CHAN)f
(will)e(disable)g(all)h(active)h(channels)e(to)h(that)g(host.)40
b(Outstanding)17 b(calls)i(will)f(return)0 1612 y(XK)p 69 1612
V 16 w(F)m(AILURE,)d(as)f(will)g(all)g(subsequent)e(calls)i(on)h(that)e
(channel)i(session.)25 b(Replies)14 b(sent)g(through)f(disabled)g(server)0
1669 y(channels)d(will)g(be)i(discarded.)0 1792 y Fn(REALM)0
1879 y Fs(CHAN)d(lies)g(on)g(the)f(boundary)g(between)h(the)g(ASYNC)h(realm)g
(and)f(the)g(RPC)h(realm.)16 b(That)9 b(is,)h(it)e(looks)g(like)h(an)g(ASYNC)
0 1935 y(protocol)h(to)h(protocols)e(below)i(it,)g(and)g(an)g(RPC)h(protocol)
e(to)h(protocols)e(above)i(it.)0 2058 y Fn(CONTROL)h(OPERA)l(TIONS)0
2145 y Fc(CHAN)p 99 2145 15 2 v 17 w(ABORT)p 236 2145 V 16
w(CALL:)22 b Fs(When)10 b(invoked)f(on)h(a)h(channel)f(session,)f(it)h
(causes)h(the)f(current)g(call)g(\(if)h(one)f(is)g(outstanding\))e(to)114
2201 y(abort)i(and)h(return)g(XK)p 484 2201 14 2 v 16 w(F)m(AILURE.)114
2292 y Fo(Input:)23 b Fc(none)114 2362 y Fo(Output:)h Fc(none)0
2485 y Fn(P)l(AR)n(TICIP)l(ANTS)0 2572 y Fs(CHAN)14 b(neither)g(removes)g
(from)h(nor)f(adds)g(to)f(the)h(participant)f(stacks,)i(passing)e(the)g
(participants)g(untouched)g(to)g(the)0 2629 y(transport)d(protocol)g(on)h(an)
g(open)g(and)g(ignoring)e(the)i(participant)f(structure)g(on)h(an)g
(openenable.)952 2753 y(79)p eop
%%Page: 80 80
79 bop 0 124 a Fn(CONFIGURA)l(TION)0 211 y Fs(CHAN)12 b(requires)h(its)e
(lower)h(transport)g(protocol)f(con\256gured)h(as)g(the)h(\256rst)f(lower)g
(protocol)f(and)i(BIDCTL)g(con\256gured)0 268 y(as)h(the)g(second)g(lower)f
(protocol.)25 b(CHAN)14 b(requires)f(that)h(it')m(s)g(transport)f(protocol)g
(will)g(deliver)g(incoming)g(messages)0 324 y(from)e(dif)o(ferent)g(hosts)e
(through)g(dif)o(ferent)h(lower)g(sessions)f(and)i(that)e(all)i(CHAN)f
(messages)h(from)g(the)f(same)h(host)f(come)0 381 y(from)i(the)f(same)g
(lower)g(session.)71 437 y(CHAN)g(is)g(a)g(realm)h(boundary)f(protocol)f
(which)g(assumes)h(its)g(transport)f(protocol)g(is)g(symmetric)i(\(in)f(the)g
(ASYNC)0 494 y(realm.\))0 618 y Fn(AUTHOR)0 705 y Fs(Sean)h(O'Malley)952
2753 y(80)p eop
%%Page: 81 81
80 bop 0 124 a Fn(NAME)0 211 y Fs(ETH)11 b(\(Ethernet)f(Protocol\))0
336 y Fn(SYNOPSIS)0 423 y Fs(This)j(hardware-independent)g(protocol)h
(provides)f(the)h(interface)h(between)f(the)g(rest)g(of)h(the)f
Fr(x)p Fs(-kernel)h(protocols)d(and)0 479 y(the)e(actual)h(ethernet)f
(drivers.)16 b(It)10 b(has)g(a)h(UPI)g(interface)g(to)f(protocols)f(above)i
(it)f(and)g(interacts)g(with)f(the)i(drivers)f(through)0 535
y(a)15 b(specialized)e(UPI)i(interface.)26 b(There)14 b(should)f(be)h(a)h
(separate)f(instantiation)d(of)k(the)f(ETH)f(protocol)g(for)i(each)f(driver)0
592 y(protocol.)0 716 y Fn(REALM)0 803 y Fs(ETH)d(is)f(in)h(the)g(ASYNC)g
(realm.)0 928 y Fn(P)l(AR)n(TICIP)l(ANTS)0 1015 y Fs(ETH)17
b(expects)f(a)i(single)e(remote)h(participant)f(with)g(an)h(ETHhost)e
(pointer)h(on)h(the)g(top)f(of)i(the)e(stack.)34 b(If)18 b(the)f(local)0
1071 y(participant)10 b(is)g(present)h(it)g(is)f(ignored.)0
1195 y Fn(CONTROL)i(OPERA)l(TIONS)0 1282 y Fc(ETH)p 75 1282
15 2 v 17 w(SETPROMISCUOUS:)20 b Fs(Sets)12 b(the)f(corresponding)f(device)h
(controller)g(in)g(promiscuous)f(mode)i(and)f(deliver)g(copies)114
1339 y(of)g(all)g(packets)f(to)h(this)f(session.)15 b(\(session)10
b(only\))114 1433 y Fo(Input:)23 b Fs(none)114 1506 y Fo(Output:)h
Fs(none)0 1630 y Fn(EXTERNAL)13 b(INTERF)l(ACE)0 1717 y Fs(Ethernet)e(driver)
g(protocols)g(should)f(include)g(the)i(\256le)g Fi(protocols/eth/eth)p
1223 1717 14 2 v 16 w(i.h)g Fs(which)f(de\256nes)h(the)g(interface)g(between)
0 1773 y(ETH)f(and)g(the)g(drivers.)71 1830 y(ETH)f(will)g(openenable)g(its)g
(driver)h(protocol)f(once)h(at)f(initialization)e(time,)k(without)d(a)i
(participant)f(list.)15 b(This)10 b(gives)0 1886 y(the)h(driver)g(protocol)f
(the)h(XObj)f(it)h(should)e(use)i(in)g(xDemux)g(when)g(it)f(delivers)g
(messages.)71 1943 y(ETH)f(calls)h(xPush)g(with)f(the)h(driver)g
Fr(pr)n(otocol)f Fs(object)g(\(not)h(a)g(session\))f(to)h(send)g(a)g
(message.)17 b(ETH)10 b(never)g(opens)f(the)0 1999 y(lower)i(protocol.)71
2056 y(ETH)f(will)g(attach)h(a)h(pointer)e(to)h(an)g(ETHhdr)f(as)i(a)f
(message)g(attribute)f(for)i(each)f(outgoing)e(message:)191
2218 y Fc(typedef)23 b(struct)g({)286 2275 y(ETHhost)119 b(dst;)286
2331 y(ETHhost)g(src;)286 2388 y(u_short)g(type;)191 2444 y(})24
b(ETHhdr;)952 2753 y Fs(81)p eop
%%Page: 82 82
81 bop 71 124 a Fs(ETH)16 b(requires)g(that)g(the)g(driver)g(attach)g(a)h
(message)g(attribute)e(pointing)f(to)i(an)h(appropriate)e(ETHhdr)h(structure)
0 181 y(for)d(every)g(incoming)f(message.)23 b(For)13 b(both)f(incoming)g
(and)h(outgoing)e(messages,)i(the)g(ETHhdr)f(type)h(\256eld)g(will)f(be)h(in)
0 237 y(network)d(byte)h(order)m(.)71 294 y(ETH)f(requires)h(the)g(driver)g
(protocol)f(to)g(implement)h(the)g(control)f(op)h(GETMYHOST)m(.)0
418 y Fn(CONFIGURA)l(TION)0 505 y Fs(Each)g(instantiation)d(of)k(ETH)e
(should)g(be)h(con\256gured)g(above)g(its)f(corresponding)g(driver)g
(protocol.)952 2753 y(82)p eop
%%Page: 83 83
82 bop 0 124 a Fn(NAME)0 211 y Fs(ETHDR)l(V)11 b(\(Out-of-kernel)f(Ethernet)h
(Driver)g(Protocol)f(\(mach3)i(platform\)\))0 336 y Fn(SPECIFICA)l(TION)71
423 y Fs(ETHDR)l(V)e(is)h(the)g(Mach)g(out-of-kernel)f(ethernet)h(driver)n(,)
g(interacting)f(with)g(an)h(ethernet)g(device)g(through)e(a)i(Mach)0
479 y(device)g(control)f(port.)0 603 y Fn(SYNOPSIS)71 690 y
Fs(Each)i(instantiation)d(of)j(ETHDR)l(V)g(is)g(associated)g(with)f(a)h
(single)f(ethernet)h(device.)20 b(ETHDR)l(V)12 b(has)g(the)g(ability)f(to)0
747 y(block)f(out)h(certain)g(packet)g(types)f(and)h(to)g(prevent)g(other)f
(Mach)i(servers)f(from)h(receiving)f(ethernet)f(packets.)0
871 y Fn(REALM)0 958 y Fs(ETHDR)l(V)h(is)g(in)f(the)h(ASYNC)h(realm,)g
(supporting)d(the)i(ethernet)f(driver)h(interface)h(described)e(in)h(the)g
(ETH)g(appendix.)0 1082 y Fn(P)l(AR)n(TICIP)l(ANTS)0 1169 y
Fs(ETHDR)l(V)f(supports)f(the)i(ethernet)f(driver)g(interface)h(rather)f
(than)g(a)h(standard)f(xkernel)g(UPI)h(interface)g(and)f(thus)g(makes)0
1226 y(no)h(use)g(of)g(participant)f(stacks.)0 1350 y Fn(EXTERNAL)j(INTERF)l
(ACE)0 1437 y Fs(ETHDR)l(V)e(supports)e(the)i(ethernet)g(driver)g(interface)g
(described)g(in)g(the)g(ETH)f(appendix.)0 1561 y Fn(CONFIGURA)l(TION)0
1648 y Fs(ETHDR)l(V)15 b(requires)g(no)g(lower)g(protocol.)28
b(It')m(s)15 b(instantiation)e(speci\256cation)h(must)h(be)g(the)g(name)h(of)
g(the)f(unmapped)0 1705 y(device)c(as)g(passed)g(to)f(the)h(mach)h(system)f
(call)g Fc(device)p 897 1705 15 2 v 16 w(open)p Fs(:)71 1761
y Fc(name=ethdrv/SE0;)0 1818 y Fs(Check)g(to)g(make)h(sure)f(that)g
Fc(/etc/NETWORKS)e Fs(is)i(set)g(up)g(to)f(use)h(the)g(unmapped)g(device.)16
b(E.g.,)71 1874 y Fc(192.12.69.1)22 b(on)i(SE0)0 1931 y Fs(The)12
b(device)h(name)g(is)f(case-sensitive;)g Fc(se0)g Fs(represents)g(the)g
(mapped)h(device,)g(while)f Fc(SE0)g Fs(represents)g(the)h(unmapped)0
1987 y(device.)0 2068 y(ETHDR)l(V)e(recognizes)g(the)g(following)e(ROM)j
(options:)71 2137 y Fc(ethdrv/xxx)22 b(priority)h(n)p Fs(:)15
b(Instantiation)7 b(xxx)h(of)h(ETHDR)l(V)h(should)d(use)i(packet)g(\256lter)h
(priority)e(n.)15 b(A)10 b(priority)0 2194 y(>=)16 b(200)g(will)g(not)g
(allow)g(other)g(servers)g(to)h(receive)g(ethernet)f(packets.)33
b(Adjusting)14 b(the)i(priority)f(in)i(this)e(way)i(is)f(a)0
2250 y(privileged)10 b(Mach)i(operation.)71 2307 y Fc(ethdrv/xxx)22
b(block)h(n)p Fs(:)d(Instantiation)10 b(xxx)i(of)h(ETHDR)l(V)g(should)e(drop)
i(packets)f(with)g(ethernet)g(type)h(n.)21 b(The)0 2363 y(type)11
b(may)g(be)h(speci\256ed)e(in)h(either)g(hexadecimal)g(\(pre\256xed)h(with)e
('x'\))h(or)h(decimal.)0 2488 y Fn(AUTHORS)0 2575 y Fs(Mats)f(Bjorkman,)h
(Hilarie)e(Orman,)i(Michael)g(Pagels,)f(Ed)g(Menze)952 2753
y(83)p eop
%%Page: 84 84
83 bop 0 124 a Fn(NAME)0 211 y Fs(ICMP)12 b(\(Internet)f(Control)g(Message)g
(Protocol\))0 336 y Fn(SPECIFICA)l(TION)0 423 y Fs(J.)j(Postel.)23
b Fr(Internet)12 b(Pr)n(otocol)p Fs(.)22 b(Request)13 b(for)h(Comments)g
(792,)f(USC)h(Information)f(Sciences)h(Institute,)f(Marina)g(del)0
479 y(Ray)m(,)f(Calif.,)g(Sept.)17 b(1981.)e(;)0 603 y Fn(SYNOPSIS)0
690 y Fs(ICMP)k(handles)f(control)f(messages)h(for)g(IP)-5
b(.)19 b(This)e(implementation)g(is)g(complete)h(in)g(that)f(it)h(handles)f
(all)h(possible)0 747 y(incoming)10 b(ICMP)j(requests.)0 871
y Fn(REALM)0 958 y Fs(ICMP)f(is)f(in)g(the)g(CONTROL)g(realm.)17
b(ICMP)c(sessions)c(may)j(be)f(opened)f(to)h(allow)g(control)f(operations.)0
1082 y Fn(P)l(AR)n(TICIP)l(ANTS)0 1169 y Fs(ICMP)i(neither)f(removes)g(nor)g
(adds)g(anything)f(to)g(the)h(participant)f(stacks.)16 b(It)11
b(passes)f(the)h(participants)f(directly)g(to)h(IP)-5 b(.)0
1294 y Fn(CONTROL)12 b(OPERA)l(TIONS)0 1381 y Fc(ICMP)p 99
1381 15 2 v 17 w(ECHO)p 212 1381 V 16 w(REQ:)22 b Fs(Send)14
b(an)f(ICMP)i(Echo)d(Request)h(message)g(to)g(the)g(peer)h(host)e(and)h(wait)
g(for)g(a)g(reply)m(.)23 b(The)13 b(buf)o(fer)114 1437 y(contains)c(the)i
(length)f(of)i(the)f(message.)16 b(Returns)11 b(0)g(if)g(successful,)g(-1)g
(if)g(a)h(timeout)e(occurred.)17 b(\(session)10 b(only\))114
1531 y Fo(Input:)23 b Fc(int)114 1604 y Fo(Output:)h Fs(none)0
1728 y Fn(CONFIGURA)l(TION)0 1815 y Fc(name=icmp)f(protocols=ip;)0
1940 y Fn(AUTHOR)0 2027 y Fs(Clinton)10 b(Jef)o(fery)952 2753
y(84)p eop
%%Page: 85 85
84 bop 0 124 a Fn(NAME)0 211 y Fs(IP)12 b(\(Internet)f(Protocol\))0
335 y Fn(SPECIFICA)l(TION)0 422 y Fs(J.)j(Postel.)23 b Fr(Internet)12
b(Pr)n(otocol)p Fs(.)22 b(Request)13 b(for)h(Comments)g(768,)f(USC)h
(Information)f(Sciences)h(Institute,)f(Marina)g(del)0 479 y(Ray)m(,)f
(Calif.,)g(Aug.)k(1980.)0 603 y Fn(SYNOPSIS)0 690 y Fs(IP)9
b(handles)f(fragmentation)g(and)g(routing)f(required)h(in)h(transmitting)d
(messages)j(across)f(heterogeneous)f(interconnected)0 747 y(networks.)15
b(This)c(implementation)e(is)i(complete,)g(with)g(the)f(exception)h(of)g
(some)g(of)g(the)g(optional)f(header)h(\256elds.)0 871 y Fn(REALM)0
958 y Fs(IP)h(is)e(in)h(the)g(ASYNC)g(realm.)0 1082 y Fn(P)l(AR)n(TICIP)l
(ANTS)0 1169 y Fs(IP)k(removes)f(a)h(pointer)e(to)g(an)i(IPhost)e(from)i(the)
f(top)f(of)h(the)g(stack)g(of)g(each)h(participant.)24 b(If)14
b(the)g(local)g(participant)f(is)0 1225 y(missing)d(or)h(if)g(the)g(local)g
(IPhost)f(pointer)g(is)h(ANY)p 819 1225 14 2 v 16 w(HOST)m(,)g(IP)h(will)e
(select)h(an)g(appropriate)f(local)h(IPhost.)0 1350 y Fn(CONTROL)h(OPERA)l
(TIONS)0 1437 y Fc(IP)p 51 1437 15 2 v 17 w(MYNET:)22 b Fs(Return)11
b(local)g(host')m(s)f(IP)i(network)e(number)m(.)18 b(This)10
b(is)h(an)g(IP)h(address)e(with)h(the)g(host)f(component)g(set)h(to)g(0.)114
1493 y(\(session)e(only\))114 1587 y Fo(Input:)23 b Fs(none)114
1659 y Fo(Output:)h Fc(IPhost)0 1753 y(IP)p 51 1753 V 17 w(REDIRECT:)d
Fs(Modi\256es)12 b(routing)d(table)i(to)g(use)g(a)h(speci\256ed)f(gateway)g
(when)g(delivering)e(packets)i(to)g(a)h(speci\256ed)f(IP)114
1809 y(address.)k(The)9 b(\256rst)h(address)f(is)g(for)g(the)g(destination)e
(and)j(the)f(second)g(is)f(for)i(the)f(gateway)m(.)16 b(\(session)8
b(or)h(protocol\))114 1903 y Fo(Input:)23 b Fc(IPhost[2])114
1976 y Fo(Output:)h Fs(none)0 2100 y Fn(CONFIGURA)l(TION)0
2187 y Fs(IP)12 b(must)f(be)g(con\256gured)g(above)f(VNET)n(:)215
2292 y Fc(name=ip)23 b(protocols=vnet;)71 2422 y Fs(If)13 b(an)g(explicit)e
(route)i(for)g(a)g(remote)h(network)e(is)g(not)h(speci\256ed,)g(IP)h(will)d
(forward)i(packets)g(for)g(that)f(network)g(to)h(a)0 2479 y
Fr(default)c(gateway)p Fs(.)17 b(The)11 b(default)f(gateway)h(is)f
(initialized)f(to)i(IP)p 1023 2479 14 2 v 16 w(SITE)p 1135
2479 V 17 w(GTW)f(from)i Fc(xkernel/etc/site.h)p Fs(,)d(but)h(this)0
2535 y(can)h(be)h(overridden)e(by)h(a)g(rom)h(\256le)f(entry)g(of)g(the)g
(form:)215 2629 y Fc(ip)95 b(gateway)118 b(127.1.22.11)952
2753 y Fs(85)p eop
%%Page: 86 86
85 bop 71 124 a Fs(If)17 b(the)h(default)e(gateway)h(is)g(the)g
(distinguished)d(address)j Fc(0.0.0.0)g Fs(or)g(can)h(not)f(be)g(reached)h
(directly)m(,)g(IP)g(will)0 181 y(operate)11 b(without)e(a)i(default)f
(gateway)h(and)f(ERR)p 793 181 14 2 v 17 w(XOBJ)h(will)f(be)h(returned)f(in)g
(cases)h(where)g(a)h(default)e(gateway)g(would)0 237 y(otherwise)g(have)h
(been)g(used.)0 361 y Fn(AUTHOR)0 448 y Fs(Clinton)f(Jef)o(fery)m(,)i(David)e
(Kays)h(and)g(Ed)g(Menze)952 2753 y(86)p eop
%%Page: 87 87
86 bop 0 124 a Fn(NAME)0 211 y Fs(MachNetIPC)12 b(\(a)g(network)e
(implementation)g(of)h(Mach)h(IPC\))0 336 y Fn(SPECIFICA)l(TION)0
423 y Fs(Mach3)g(Kernel)f(Principles,)f(with)g(appropriate)h(extensions.)0
547 y Fn(SYNOPSIS)0 634 y Fs(MachNetIPC)h(generalizes)f(Mach)h(IPC)g(to)f
(work)f(between)h(machines)g(connected)g(by)g(networking)e(services.)0
758 y Fn(REALM)0 845 y Fs(MachNetIPC)j(is)f(in)g(the)g(anchor)g(protocol)e
(realm;)j(it)f(is)f(speci\256c)h(to)g(the)g(Mach3)h(platform.)0
969 y Fn(P)l(AR)n(TICIP)l(ANTS)0 1056 y Fs(The)e(SSR)g(protocol)f
(communicates)g(trivially)f(with)h(MachNetIPC)i(using)d(two)h(elements)h(in)f
(the)g(participant)g(stack:)14 b(the)0 1113 y(Mach)f(reply)f(port)g(for)g
(the)g(client)g(request,)g(and)g(the)g(IP)h(address)f(of)g(the)g(remote)h
(host.)19 b(T)m(o)12 b(accomplish)f(this,)h(SSR)h(and)0 1169
y(MachNetIPC)f(must)f(reside)g(in)g(the)g(same)g(Mach)h(task.)71
1226 y(SSR)h(is)e(only)g(used)h(to)f(bootstrap)f(initial)h(Mach)h(ports.)18
b(All)12 b(other)f(addressing)g(is)g(done)h(implicitly)e(through)h(Mach)0
1282 y(message)g(passing)f(that)h(involves)e(MachNetIPC)j(as)f(an)h
(intermediary)m(.)0 1407 y Fn(CONTROL)g(OPERA)l(TIONS)0 1494
y Fs(There)f(are)h(no)f(control)f(operations.)0 1618 y Fn(CONFIGURA)l(TION)0
1705 y Fs(MachNetIPC)16 b(uses)f(CHAN)h(as)f(its)g(transport)f(protocol,)h
(and)h(BIDCTL)f(for)h(detecting)e(host)g(reboots.)29 b(There)15
b(is)g(an)0 1761 y(unused)10 b(option)g(for)h(two)g(transport)f(protocols,)f
(and)i(that)g(is)g(why)f Fr(udp)22 b Fs(occurs)11 b(in)g(the)g
(con\256guration)f(line:)0 1818 y Fc(name=machripc)22 b
(protocols=chan,udp,bidctl;)71 1874 y Fs(In)13 b(addition,)g(the)h
Fr(srx)f Fs(and)h Fr(rrx)g Fs(protocols)e(must)h(be)h(included)e(in)i(the)f
(con\256guration.)23 b(There)14 b(is)g(a)g(tight)e(interface)0
1931 y(between)f(these)g(and)g(MachNetIPC)h(that)e(is)h(achieved)g(via)g
(subroutine)e(calls,)i(not)g Fr(x)p Fs(-kernel)g(operations.)71
1987 y(The)f(protocol)f(numbers)h(for)h(MachNetIPC)h(are)f(not)f(included)f
(in)h(the)g(standard)g(protocol)f(table.)16 b(The)10 b(graph.comp)0
2044 y(entry)h(for)g(these)g(should)e(include)i(a)g(reference)i(to)d(a)i
(local)f(protocol)e(table)i(containing)e(the)i(following:)0
2150 y Fc(machripc)23 b(10010)0 2206 y({)0 2263 y(ssr)g(1)0
2319 y(})0 2376 y(ssr)g(10011)0 2432 y(portmaint)g(10016)952
2753 y Fs(87)p eop
%%Page: 88 88
87 bop 0 124 a Fn(CA)-6 b(VEA)l(TS)12 b(and)g(DISCLAIMERS)0
211 y Fs(The)i(network)f(port)h(identi\256ers)f(are)i(fragile)f(for)g(the)g
(time)g(being.)25 b(They)14 b(are)g(based)g(on)g(the)g(lower)g(24)g(bits)f
(of)h(the)g(IP)0 268 y(address)d(and)g(an)g(8)g(bit)f(sequence)h(number)m(.)
17 b(This)11 b(is)f(inadequate)h(and)g(will)f(be)h(changed)g(in)g(the)f(near)
i(future.)71 324 y(Behavior)e(under)h(heavy)f(load)g(or)h(with)f(machine)h
(reboots)e(during)h(complex)h(port)f(transfers)g(have)h(not)f(been)h(tested.)
71 381 y(Embedded)f(port)h(right)f(transfers)h(have)g(been)g(tested)g(only)f
(lightly)m(.)71 437 y(Support)k(for)i(heterogeneous)e(architectures)h(is)g
(not)g(included.)29 b(Some)16 b(of)g(the)f(header)h(load)f(and)g(store)h
(routines)0 494 y(attempt)11 b(to)f(be)i(architecture)f(independent,)f(but)g
(this)g(work)h(is)f(still)g(in)h(progress.)0 618 y Fn(AUTHORS)0
705 y Fs(Hilarie)g(Orman)952 2753 y(88)p eop
%%Page: 89 89
88 bop 0 124 a Fn(NAME)0 211 y Fs(RRX)12 b(\(transfer)f(Mach)h(receive)g
(right\).)0 336 y Fn(SYNOPSIS)0 423 y Fs(SRX)18 b(is)g(a)g(receive-right)f
(transfer)h(protocol.)35 b(T)n(ransferring)17 b(a)h(receive)g(right)f
(involves)f(coordination)g(among)h(the)0 479 y(original)10
b(holder)h(of)h(the)g(receive)g(right,)f(the)g(new)h(holder)f(of)h(the)f
(receive)h(right,)g(and)f(all)h(of)f(the)h(holders)e(of)i(send)f(rights)0
535 y(to)g(the)g(port.)0 660 y Fn(EXTERNAL)i(INTERF)l(ACE)0
747 y Fs(RRX)g(uses)f(subroutine)e(calls)i(to)f(accept)i(transfer)f
(requests,)g(and)g(to)g(keep)g Fr(MachNetIPC)g Fs(apprised)g(of)g(the)g
(movement)0 803 y(of)f(receive)h(rights.)0 928 y Fn(CONFIGURA)l(TION)0
1015 y Fs(RRX)g(depends)e(on)h(a)g(synchronous)f(lower)g(protocol)g(and)h
(BIDCTL)h(to)f(detect)f(reboots.)0 1071 y Fc(name=rrx)23 b(protocols=chan,)f
(bidctl;)0 1195 y Fn(AUTHORS)0 1282 y Fs(Ed)11 b(Menze)952
2753 y(89)p eop
%%Page: 90 90
89 bop 0 124 a Fn(NAME)0 211 y Fs(SELECT)11 b(\(RPC)h(Select)g
(Micro-Protocol\))0 336 y Fn(SPECIFICA)l(TION)0 423 y Fs(S.)g(O'Malley)g(and)
f(L.)h(Peterson.)18 b(A)11 b(Dynamic)h(Network)f(Architecture.)17
b Fr(ACM)12 b(T)m(ransactions)d(on)i(Computer)g(Systems)0 479
y(10)p Fs(,)g(2)g(\(May)h(1992\),)f(110\261143.)0 560 y(B.)i(W)l(elch.)21
b Fr(The)13 b(Sprite)e(r)n(emote)h(pr)n(ocedur)n(e)g(call)p
Fs(.)20 b(University)10 b(of)j(California)f(at)g(Berkeley)m(,)i(T)m(ech)e
(Report)h(UCB/CSD)0 617 y(86/302,)d(June)h(1986.)0 741 y Fn(SYNOPSIS)0
828 y Fs(SELECT)16 b(is)g(a)h(micro-protocol)e(that)h(performs)h(the)f
(addressing)f(function)g(of)i(Sprite)f(RPC;)h(i.e.,)i(it)d(demultiplexes)0
885 y(request)11 b(messages)g(to)f(the)h(appropriate)g(procedure.)0
1009 y Fn(REALM)0 1096 y Fs(SELECT)g(is)g(in)f(the)h(RPC)i(realm.)0
1220 y Fn(P)l(AR)n(TICIP)l(ANTS)0 1307 y Fs(SELECT)g(removes)h(a)g(pointer)e
(to)h(a)h(long)e(\(the)h(remote)h(procedure)g(number\))f(from)h(the)f(top)g
(of)h(the)f(stack)g(of)g(the)g(\256rst)0 1364 y(participant.)0
1488 y Fn(CONFIGURA)l(TION)0 1575 y Fs(SELECT)e(expects)g(one)g(RPC)h(realm)g
(protocol)e(below)g(it.)0 1699 y Fn(AUTHOR)0 1786 y Fs(Sean)i(O'Malley)952
2753 y(90)p eop
%%Page: 91 91
90 bop 0 124 a Fn(NAME)0 211 y Fs(SIMETH)12 b(\(Simulated)e(Ethernet)h
(Driver)g(Protocol)f(\(sunos)g(platform\)\))0 336 y Fn(SPECIFICA)l(TION)0
423 y Fs(SIMETH)g(simulates)f(an)i Fr(x)p Fs(-kernel)f(ethernet)g(driver)f
(by)h(sending)f(and)h(receiving)f(messages)h(using)f(Unix)g(UDP)h(sockets.)0
547 y Fn(SYNOPSIS)0 634 y Fs(Each)h(instantiation)d(of)j(SIMETH)h(is)e
(associated)g(with)g(a)i(speci\256c)f(Unix)f(UDP)h(port)g(and)g(simulates)f
(an)h(ethernet)f(driver)0 690 y(for)k(a)g(single)e(interface.)24
b(SIMETH)14 b(transmits)f(outgoing)e(messages)i(by)h(sending)e(to)h(other)g
(UDP)h(ports)f(and)g(presents)0 747 y(UDP)g(messages)g(received)g(on)g(its)f
(port)g(as)h(incoming)f(ethernet)h(packets.)21 b(Note)13 b(that)f(since)h
(messages)f(sent)h(from)g(one)0 803 y(sunos)g Fr(x)p Fs(-kernel)i(to)g
(another)f(are)h(encapsulated)f(within)f(Unix)h(UDP)h(packets,)g(it)f(is)g
(only)g(possible)f(to)h(communicate)0 860 y(with)g(another)g(peer)h(running)f
(the)g Fr(x)p Fs(-kernel)h(with)f(this)g(same)h(driver)m(.)28
b(Communication)14 b(with)f(arbitrary)i(peers)g(is)f(not)0
916 y(possible)9 b(with)i(this)f(driver)m(.)71 973 y(The)i(mapping)h(between)
f(Unix)h(UDP)g(ports)f(and)h(SIMETH)g(ethernet)g(addresses)f(is)g(very)h
(simple.)22 b(The)13 b(six)f(bytes)0 1029 y(of)g(SIMETH)g(ethernet)g(address)
f(are)i(formed)f(by)g(the)f(concatenation)g(of)h(the)g(four)g(byte)f(IP)h
(host)f(number)h(for)g(the)g(Unix)0 1085 y(host)e(on)h(which)f(the)h
(simulator)f(is)h(running)f(and)h(the)f(two)h(byte)g(UDP)g(port)f(used)h(by)g
(the)g(SIMETH)g(instantiation.)j(Note)0 1142 y(that)e(this)f(is)h(the)g
Fr(r)n(eal)g Fs(IP)h(host)e(number)n(,)j(not)d(the)h Fr(simulated)f
Fs(IP)i(host)e(number)m(.)21 b(See)13 b(the)f(CONFIGURA)-5
b(TION)12 b(section)0 1198 y(below)m(.)71 1255 y(Note)j(that)g(an)g
Fr(x)p Fs(-kernel)h(may)g(be)g(con\256gured)f(with)g(multiple)f
(instantiations)e(of)k(SIMETH,)g(each)g(with)f(its)g(own)0
1311 y(UDP)c(port,)g(to)g(simulate)f(a)i(multihomed)e(host.)71
1368 y(SIMETH)i(can)h(awkwardly)f(simulate)f(ethernet)h(broadcast)g
(messages.)20 b(When)12 b(an)h(outgoing)d(broadcast)i(message)0
1424 y(is)k(sent)h(to)f(SIMETH,)i(SIMETH)f(asks)g(its)f(corresponding)f(ARP)j
(protocol)d(for)i(a)h(dump)e(of)h(all)g(hosts)f(in)g(its)g(table.)0
1481 y(SIMETH)9 b(then)g(sends)f(the)h(message)g(to)f(each)i(of)f(these)f
(hosts)g(in)g(a)i(point-to-point)5 b(fashion.)15 b(Note)9 b(that)f(for)h(a)h
(reasonable)0 1537 y(simulation)h(of)i(ethernet)f(broadcast,)h(all)g
Fr(x)p Fs(-kernels)g(in)f(communication)g(should)f(have)i(the)g(same)g(ARP)h
(table)e(\(see)h(the)0 1594 y(ARP)f(appendix.\))0 1718 y Fn(REALM)0
1805 y Fs(SIMETH)g(is)e(in)h(the)g(ASYNC)g(realm,)h(supporting)d(the)i
(ethernet)g(driver)g(interface)g(described)g(in)g(the)f(ETH)h(appendix.)0
1929 y Fn(P)l(AR)n(TICIP)l(ANTS)0 2016 y Fs(SIMETH)h(supports)d(the)i
(ethernet)g(driver)g(interface)h(rather)f(than)g(a)h(standard)e(xkernel)h
(UPI)h(interface)f(and)h(thus)e(makes)0 2073 y(no)h(use)g(of)g(participant)f
(stacks.)0 2197 y Fn(CONTROL)i(OPERA)l(TIONS)0 2284 y Fc(ETH)p
75 2284 15 2 v 17 w(REGISTER)p 284 2284 V 16 w(ARP:)22 b Fs(Used)8
b(by)h(an)g(ARP)g(instantiation)d(to)i(register)g(itself)g(with)g(its)g
(corresponding)e(SIMETH)k(driver)m(.)114 2340 y(This)h(is)h(used)g(to)g
(simulate)g(ethernet)g(broadcasts)g(as)h(described)e(above.)21
b(If)13 b(no)f(ARP)h(protocol)f(registers)f(with)h(a)114 2397
y(SIMETH)f(instantiation,)e(broadcasts)h(on)h(that)f(instantiation)e(will)i
(not)h(be)g(possible.)114 2491 y Fo(Input:)23 b Fc(XObj)g(/*)h(ARP)f
(protocol)g(object)g(*/)114 2564 y Fo(Output:)h Fs(none)952
2753 y(91)p eop
%%Page: 92 92
91 bop 0 124 a Fn(EXTERNAL)13 b(INTERF)l(ACE)0 211 y Fs(SIMETH)f(supports)d
(the)i(ethernet)g(driver)g(interface)g(described)f(in)h(the)g(ETH)g
(appendix.)0 336 y Fn(CONFIGURA)l(TION)0 423 y Fs(SIMETH)g(requires)f(no)g
(lower)h(protocol.)k(It)10 b(can)h(be)g(con\256gured)f(in)g(either)h(the)f
(driver)g(section)g(or)h(the)f(protocol)f(section)0 479 y(of)i(graph.comp.)0
560 y(SIMETH)h(recognizes)e(the)h(following)e(ROM)j(options:)71
629 y Fc(simeth)23 b(nnnn)p Fs(:)c(This)12 b(instantiation)e(of)k(simeth)e
(should)g(use)h(UDP)g(port)f(nnnn.)22 b(There)13 b(must)g(be)g(such)g(a)g
(line)g(for)0 686 y(each)f(instantiation)c(of)j(SIMETH)h(in)e(the)h
Fr(x)p Fs(-kernel.)0 810 y Fn(AUTHORS)0 897 y Fs(Larry)g(Peterson)g(and)g
(Norm)h(Hutchinson)952 2753 y(92)p eop
%%Page: 93 93
92 bop 0 124 a Fn(NAME)0 211 y Fs(SSR)12 b(\(a)g(simple)e(name)i(server)g
(protocol)e(for)h(use)g(with)f(MachNetIPC\).)0 336 y Fn(SPECIFICA)l(TION)0
423 y Fs(See)i(the)g(\256le)f(\252ssr)m(.h\272.)18 b(This)11
b(contains)f(the)h(request)g(identi\256er)g(list)f(and)i(the)f(data)g
(structure)g(de\256ning)g(an)g(SSR)i(message.)0 479 y(This)d(is)h(not)f(MiG)i
(generated.)0 603 y Fn(SYNOPSIS)0 690 y Fs(SSR)e(is)f(used)g(for)g
(bootstrapping)e(ports)h(into)g(MachNetIPC.)j(SSR)f(uses)f(the)g(Mach)h
(netnameserver)f(to)g(register)g(its)f(main)0 747 y(port.)23
b(It)13 b(listens)f(for)i(messages)f(on)g(this)f(port.)23 b(It)13
b(can)h(register)f(a)h(server)f(port)g(and)g(forward)h(requests)e(to)h(its)g
(peers)h(on)0 803 y(remote)e(hosts.)71 860 y(There)k(is)g(a)h(simple)f(name)h
(server)g(that)f(can)h(be)g(reached)g(using)e(the)h(Mach3)h(netnameserver)n
(,)i(using)c(the)i(name)0 916 y(\252simple)p 145 916 14 2 v
16 w(server)r(\272.)32 b(This)16 b(accepts)g(Mach)i(messages)e(containing)f
(a)h(service)h(identi\256er)n(,)g(a)g(request)f(identi\256er)n(,)i(an)f(IP)0
973 y(address,)i(and)f(a)g(Mach)g(reply)f(port.)36 b(The)17
b(requests)g(are)h(sent)f(to)h(the)f(remote)h(peer)n(,)i(and)e(the)f(Mach)h
(reply)g(port)f(is)0 1029 y(translated)11 b(into)g(a)h(MachNetIPC)h(port.)18
b(The)12 b(request)f(is)g(forwarded)h(to)g(the)f(server)h(registered)g(on)f
(the)h(remote)g(host)f(\(if)0 1085 y(any\).)17 b(There)11 b(is)g(no)f(reply)h
(to)g(SSR.)71 1142 y(A)g(test)g(program)h(using)e(SSR)j(can)e(be)h(found)f
(in)g(the)g(mach3/user/netipc/test)e(directory)m(.)17 b(This)11
b(program)g(\()p Fr(ssr)o(-test)p Fs(\))0 1198 y(takes)g(command)g(line)g(ar)
o(guments)g(specifying)e(the)i(test)g(type,)g(the)f(remote)i(server)f
(address,)g(the)g(debugging)e(level,)i(and)0 1255 y(the)g(number)g(of)g
(messages.)0 1379 y Fn(REALM)0 1466 y Fs(SSR)h(is)f(in)g(the)g(anchor)g
(protocol)e(realm;)j(it)f(is)f(speci\256c)h(to)g(the)g(Mach3)h(platform.)0
1590 y Fn(CONFIGURA)l(TION)0 1677 y Fs(SSR)g(communicates)f(with)f
(MachNetIPC)j(as)e(its)f(only)g(lower)h(protocol.)0 1734 y
Fc(name=ssr)23 b(protocols=machripc;)0 1858 y Fn(AUTHORS)0
1945 y Fs(Hilarie)11 b(Orman)952 2753 y(93)p eop
%%Page: 94 94
93 bop 0 124 a Fn(NAME)0 211 y Fs(SRX)12 b(\(transfer)f(Mach)h(send)f
(right\).)0 336 y Fn(SYNOPSIS)0 423 y Fs(SRX)16 b(is)g(a)g(send-right)e
(transfer)i(protocol,)g(used)g(to)f(transfer)h(a)g(Mach)h(send)e(right)g
(when)h(there)f(are)i(more)f(than)g(two)0 479 y(parties)d(involved)e(\(i.e.,)
16 b(when)d(the)g(original)f(holder)g(of)i(the)f(send)g(right,)g(the)g(new)h
(holder)e(of)i(the)f(send)g(right,)g(and)g(the)0 535 y(holder)d(of)i(the)f
(receive)g(right)f(are)i(on)f(dif)o(ferent)g(hosts.\))0 660
y Fn(EXTERNAL)i(INTERF)l(ACE)0 747 y Fs(SRX)d(uses)f(subroutine)f(calls)h(to)
g(accept)h(transfer)g(requests,)f(and)h(to)f(notify)g Fr(MachNetIPC)g
Fs(of)h(the)f(arrival)h(of)g(new)f(rights.)0 871 y Fn(CONFIGURA)l(TION)0
958 y Fs(SRX)j(depends)e(on)h(a)g(synchronous)f(lower)g(protocol)g(and)h
(BIDCTL)h(to)f(detect)f(reboots.)0 1015 y Fc(name=srx)23 b(protocols=chan,)f
(bidctl;)0 1139 y Fn(AUTHORS)0 1226 y Fs(Ed)11 b(Menze.)952
2753 y(94)p eop
%%Page: 95 95
94 bop 0 124 a Fn(NAME)0 211 y Fs(SUNRPC)12 b(\(Sun)f(Remote)h(Procedure)g
(Call)f(Protocol\))0 336 y Fn(SPECIFICA)l(TION)0 423 y Fr(Remote)16
b(Pr)n(ocedur)n(e)g(Calls:)26 b(Pr)n(otocol)15 b(Speci\256cation)p
Fs(.)31 b(Sun)16 b(Microsystems,)i(Inc.,)g(Mountain)e(V)m(iew)m(,)i(Calif.,)h
(May)0 479 y(1988.)0 603 y Fn(SYNOPSIS)0 690 y Fs(Sun)10 b(RPC)h(is)f(a)h
(fairly)e(complete)h(implementation)f(of)h(Sun')m(s)h(remote)f(procedure)h
(call)f(protocol.)k(This)c(implementation)0 747 y(is)15 b(compatible)f(with)g
(Sun')m(s)h(native)g(implementation.)26 b(The)15 b(interface)h(to)e(our)h
(implementation)f(of)h(Sun)g(RPC)h(in)f(no)0 803 y(way)f(resembles)h(Sun')m
(s.)27 b(The)14 b(Sun)g(Portmapper)h(is)f(treated)h(as)f(a)h(separate)g
(protocol)e(that)h(sits)f(on)h(top)g(of)g(Sun)h(RPC.)0 860
y(This)10 b(implementation)f(only)h(supports)g(UDP)h(as)g(a)g(lower)g(level)f
(protocol.)15 b(The)c(protocol)f(supports)f(unreliable)h(remote)0
916 y(procedure)k(calls)f(to)g(possibly)f(heterogeneous)h(hosts.)23
b(Our)13 b(implementation)g(of)h(the)f(Sun)h(RPC)h(protocol)d(uses)i(most)0
973 y(but)d(not)f(all)h(of)h(the)f(original)f(Sun)h(RPC)i(include)d(\256les)i
(and)f(XDR)h(\256les.)17 b(Thus,)11 b(you)g(must)g(have)g(access)h(to)f(Sun)g
(include)0 1029 y(and)g(XDR)g(\256les)g(to)g(compile)g(this)f(protocol.)0
1153 y Fn(REALM)0 1240 y Fs(SUNRPC)i(is)f(in)g(the)f(RPC)j(realm.)0
1365 y Fn(P)l(AR)n(TICIP)l(ANTS)0 1452 y Fs(SUNRPC)k(removes)e(three)h
(pointers)e(to)h(longs)f(from)i(the)g(remote)g(participant)e(stack,)i
(representing)f(the)g(procedure,)0 1508 y(version)10 b(and)h(program)h
(number)f(\(starting)f(from)h(the)g(top)g(of)g(the)g(stack.\))71
1565 y(The)g(local)h(participant)e(may)j(be)f(present,)g(in)f(which)g(case)i
(it)e(is)h(passed)f(on)h(untouched)e(to)i(the)f(next)h(protocol,)f(or)h(it)0
1621 y(may)g(be)f(absent.)0 1745 y Fn(CONTROL)h(OPERA)l(TIONS)0
1832 y Fc(SUNRPC)p 147 1832 15 2 v 16 w(CLNTGETERROR:)21 b
Fs(Returns)11 b(an)g(RPC)i(error)e(status)f(structure.)16 b(\(session)10
b(only\))114 1926 y Fo(Input:)23 b Fs(none)114 1999 y Fo(Output:)h
Fc(struct)f(rpc)p 535 1999 V 17 w(err)0 2093 y(SUNRPC)p 147
2093 V 16 w(CLNTSETTOUT:)e Fs(Sets)f(the)g(client)f(timeout)g(value;)24
b(the)19 b(amount)h(of)g(time)g(the)g(client)f(will)g(wait)g(before)114
2149 y(resending)10 b(the)h(message.)16 b(\(session)10 b(only\))114
2243 y Fo(Input:)23 b Fc(struct)g(timeval)114 2316 y Fo(Output:)h
Fs(none)0 2410 y Fc(SUNRPC)p 147 2410 V 16 w(CLNTGETTOUT:)d
Fs(Returns)11 b(the)g(client)f(timeout)h(value.)16 b(\(session)10
b(only\))114 2504 y Fo(Input:)23 b Fs(none)114 2577 y Fo(Output:)h
Fc(struct)f(timeval)952 2753 y Fs(95)p eop
%%Page: 96 96
95 bop 0 124 a Fc(SUNRPC)p 147 124 15 2 v 16 w(CLNTSETWAIT:)21
b Fs(Sets)12 b(the)f(client)f(wait)h(value,)g(the)h(amount)e(of)i(time)f(the)
g(client)g(will)f(wait)h(before)g(returning)114 181 y(an)g(error)m(.)17
b(\(session)10 b(only\))114 275 y Fo(Input:)23 b Fc(struct)g(timeval)114
348 y Fo(Output:)h Fs(none)0 441 y Fc(SUNRPC)p 147 441 V 16
w(CLNTGETWAIT:)d Fs(Returns)11 b(the)g(client)f(wait)h(value.)16
b(\(session)10 b(only\))114 535 y Fo(Input:)23 b Fs(none)114
608 y Fo(Output:)h Fc(struct)f(timeval)0 702 y(SUNRPC)p 147
702 V 16 w(GETCREDTYPE:)e Fs(Returns)10 b(the)f(type)g(of)h(authentication)d
(credentials)i(used.)15 b(V)-5 b(alid)9 b(types)f(are)j(NULL)e(authen-)114
759 y(tication,)i(Unix)g(authentication)f(and)h(DES)h(authentication.)17
b(Note)12 b(that)f(the)h(protocol)f(or)h(user)f(above)h(Sun)g(RPC)114
815 y(is)f(completely)g(responsible)f(for)i(all)f(authentication;)e(the)j
(Sun)f(RPC)i(protocol)d(merely)i(copies)f(credentials)g(into)114
871 y(and)g(out)f(of)h(the)g(header)m(.)18 b(\(session)9 b(only\))114
965 y Fo(Input:)23 b Fs(none)114 1038 y Fo(Output:)h Fc(int)0
1132 y(SUNRPC)p 147 1132 V 16 w(GETCRED:)e Fs(Returns)11 b(the)g
(authentication)e(credentials)h(used)h(in)f(an)i(opaque)e(byte)h(string.)k
(\(session)10 b(only\))114 1226 y Fo(Input:)23 b Fs(none)114
1299 y Fo(Output:)h Fc(char)f(*)0 1393 y(SUNRPC)p 147 1393
V 16 w(SETCREDTYPE:)e Fs(Sets)12 b(the)e(type)h(of)g(authentication)e
(credentials)i(used)f(\(session)g(only\))114 1487 y Fo(Input:)23
b Fc(int)114 1560 y Fo(output:)g Fs(none)0 1654 y Fc(SUNRPC)p
147 1654 V 16 w(SETCRED:)f Fs(Sets)e(the)f(authentication)f(credentials)h
(used)g(in)g(an)h(opaque)g(byte)f(string)f(\(already)i(xdr)r('ed\).)114
1710 y(\(session)9 b(only\))114 1804 y Fo(Input:)23 b Fc(char)g(*)114
1877 y Fo(Output:)h Fs(none)0 1971 y Fc(SUNRPC)p 147 1971 V
16 w(GETVERFTYPE:)d Fs(Returns)15 b(the)g(type)g(of)g(authentication)e
(veri\256cation)h(used.)28 b(V)-5 b(alid)14 b(types)h(are)g(NULL)g(au-)114
2027 y(thentication,)9 b(Unix)h(authentication,)g(and)h(DES)g
(authentication.)j(\(session)c(only\))114 2121 y Fo(Input:)23
b Fs(none)114 2194 y Fo(Output:)h Fc(int)0 2288 y(SUNRPC)p
147 2288 V 16 w(GETVERF:)e Fs(Returns)8 b(the)h(authentication)d
(veri\256cation)i(used)h(contained)e(in)i(an)g(opaque)f(byte)g(string.)15
b(\(session)114 2344 y(only\))114 2438 y Fo(Input:)23 b Fs(none)114
2511 y Fo(Output:)h Fc(char)f(*)0 2605 y(SUNRPC)p 147 2605
V 16 w(SETVERFTYPE:)e Fs(Sets)12 b(the)e(type)h(of)g(authentication)e
(veri\256cation)i(used.)16 b(\(session)10 b(only\))952 2753
y(96)p eop
%%Page: 97 97
96 bop 114 124 a Fo(Input:)23 b Fc(int)114 197 y Fo(Output:)h
Fs(none)0 291 y Fc(SUNRPC)p 147 291 15 2 v 16 w(SETVERF:)e
Fs(Sets)16 b(the)g(authentication)e(veri\256cation)h(used)h(contained)f(in)h
(an)g(opaque)g(byte)f(string)g(\(already)114 348 y(xdr)r('ed\))10
b(\(session)g(only\))114 441 y Fo(Input:)23 b Fc(char)g(*)114
514 y Fo(Output:)h Fs(none)0 608 y Fc(SUNRPC)p 147 608 V 16
w(SVCAUTHERR:)e Fs(Causes)10 b(session)e(to)i(return)g(authentication)e
(error)j(message)f(and)g(terminate.)16 b(\(session)9 b(only\))114
702 y Fo(Input:)23 b Fc(char)g(*)114 775 y Fo(Output:)h Fs(none)0
869 y Fc(SUNRPC)p 147 869 V 16 w(SVCSYSTEMERR:)d Fs(Causes)11
b(session)f(to)h(return)g(a)g(system)g(error)h(message)f(and)g(terminate.)16
b(\(session)10 b(only\))114 963 y Fo(Input:)23 b Fc(char)g(*)114
1036 y Fo(Output:)h Fs(none)0 1160 y Fn(CONFIGURA)l(TION)0
1247 y Fs(SUNRPC)18 b(is)e(a)h(realm)g(boundary)f(protocol)f(which)h(assumes)
h(its)e(lower)i(protocol)e(is)h(symmetric)h(\(in)g(the)f(ASYNC)0
1304 y(realm.\))0 1360 y Fc(name=sunrpc)22 b(protocols=udp;)0
1484 y Fn(AUTHOR)0 1571 y Fs(Sean)12 b(O`Malley)f(and)g(Richard)g(Schroeppel)
952 2753 y(97)p eop
%%Page: 98 98
97 bop 0 124 a Fn(NAME)0 211 y Fs(Sun)11 b(Portmapper)0 336
y Fn(SPECIFICA)l(TION)0 423 y Fr(?)16 b Fs(Sun)11 b(Microsystems,)g(Inc.,)h
(Mountain)e(V)m(iew)m(,)i(Calif.,)g(May)f(1988.)0 547 y Fn(SYNOPSIS)0
634 y Fs(The)17 b(portmapper)g(supports)f(four)h(of)h(the)f(\256ve)h(of)f
(the)g(procedures)g(de\256ned)g(by)g(Sun.)36 b(Indirect)16
b(Call,)k(Function)c(5,)0 690 y(is)e(not)g(implemented.)28
b(This)13 b(implementation)h(is)g(compatible)g(with)g(Sun')m(s)h(native)f
(implementation.)26 b(The)15 b Fr(x)p Fs(-kernel)0 747 y(portmapper)10
b(is)f(treated)h(as)g(a)g(separate)g(protocol)e(that)i(sits)e(on)i(top)f(of)h
(the)f Fr(x)p Fs(-kernel)i(implementation)d(of)i(Sun)g(RPC.)h(This)0
803 y(implementation)e(only)g(supports)g(UDP)h(as)h(a)f(lower)g(level)g
(protocol.)15 b(Client)10 b(and)g(server)h(protocols)d(running)h(above)h(the)
0 860 y(sunrpc)j(protocol)g(make)h(remote)h(procedures)e(calls)h(to)f(the)h
(portmapper)n(,)h(using)d(its)i(well-known)e(UDP)i(port)f(number)0
916 y(111.)71 973 y(Our)f(implementation)e(of)i(the)g(Sun)g(Portmapper)h
(protocol)e(uses)g(some)h(of)h(the)e(original)g(SUN)p 1605
973 14 2 v 16 w(RPC)j(include)d(\256les.)0 1029 y(Y)-5 b(ou)11
b(must)g(have)g(access)g(to)g(Sun)g(include)f(\256les)i(to)e(compile)h(this)f
(protocol.)0 1153 y Fn(REALM)0 1240 y Fs(The)h(portmapper)g(is)g(in)f(the)h
(ASYNC)h(realm.)0 1365 y Fn(CONFIGURA)l(TION)0 1452 y Fs(The)f(portmapper)g
(is)g(a)g(realm)h(boundary)e(protocol)g(which)g(assumes)h(its)g(single)f
(lower)g(protocol)g(is)h(in)g(the)g(RPC)h(realm.)0 1508 y Fc(name=pmap)23
b(protocols=sunrpc;)0 1632 y Fn(AUTHOR)0 1719 y Fs(Sean)12
b(O`Malley)f(and)g(Richard)g(Schroeppel)952 2753 y(98)p eop
%%Page: 99 99
98 bop 0 124 a Fn(NAME)0 211 y Fs(TCP)12 b(\(T)n(ransmission)e(Control)g
(Protocol\))0 336 y Fn(SPECIFICA)l(TION)0 423 y Fr(T)m(ransmission)i(Contr)n
(ol)g(Pr)n(otocol)p Fs(.)24 b(Request)13 b(for)h(Comments)g(793,)h(USC)f
(Information)f(Sciences)i(Institute,)e(Marina)0 479 y(Del)e(Rey)m(,)h
(Calif.,)g(Sept.)17 b(1981)0 603 y Fn(SYNOPSIS)0 690 y Fs(TCP)11
b(is)g(a)g(reliable)f(stream)h(transport)f(protocol.)15 b(It)c(maintains)f(a)
h(connection)f(between)g(the)h(server)g(and)f(the)h(client,)f(and)0
747 y(provides)i(reliable)i(stream)g(delivery)e(to)i(the)f(process.)24
b(This)12 b(implementation)h(is)g(an)g(encapsulation)f(of)i(the)f(Unix)g(4.3)
0 803 y(BSD)f(implementation.)71 860 y(This)g(implementation)f(of)i(TCP)h
(supports)d(input)h(and)h(output)e(buf)o(fering.)22 b(Output)11
b(buf)o(fers)i(are)h(contained)e(within)0 916 y(TCP)-5 b(.)14
b(If)g(the)f(amount)g(of)g(data)h(sent)e(and)i(unacknowledged)d(by)i(the)g
(peer)h(reaches)g(the)f(output)f(buf)o(fer)h(size,)h(TCP)g(will)0
973 y(block)c(subsequent)g Fr(xPush)p Fs(')m(s)g(\(or)i(will)e(return)h(XMSG)
p 879 973 14 2 v 17 w(ERR)p 984 973 V 16 w(WOULDBLOCK)g(in)g(the)f(case)i(of)
f(non-blocking)e(I/O.\))71 1029 y(TCP)h(provides)e(support)g(for)i(users)f
(to)g(work)g(with)g(\256nite)g(input)f(buf)o(fers.)17 b(TCP)10
b(will)e(limit)h(the)g(amount)g(of)h(input)e(data)0 1085 y(sent)k(to)f(its)h
(upper)g(protocol)f(via)h Fr(xDemux)g Fs(to)g(the)g(size)g(of)g(the)g(input)f
(buf)o(fer)m(.)20 b(When)12 b(data)g(have)h(been)f(consumed)g(from)0
1142 y(the)e(user)r(')m(s)g(input)e(buf)o(fer)n(,)j(free)g(buf)o(fer)g(space)
f(must)f(be)i(signalled)d(to)h(TCP)i(via)f(a)g(TCP)p 1377 1142
V 17 w(SETRCVBUFSP)l(ACE)h(call)f(\(see)0 1198 y(below)m(.\))18
b(If)12 b(a)g(user)g(does)f(not)h(wish)e(to)i(use)f(input)g(buf)o(fering,)h
(a)g(control)f(message)h(signalling)d(an)j(empty)g(buf)o(fer)g(should)0
1255 y(be)f(sent)g(in)g(response)f(to)h(each)g Fr(xDemux.)0
1379 y Fn(REALM)0 1466 y Fs(TCP)h(is)e(in)h(the)g(ASYNC)g(realm.)0
1590 y Fn(P)l(AR)n(TICIP)l(ANTS)0 1677 y Fs(TCP)h(removes)g(a)g(pointer)e(to)
h(a)h(long)f(\(the)g(TCP)i(port)e(number\))g(from)h(the)g(participant)e
(stack.)17 b(TCP)12 b(ports)f(must)g(be)h(less)0 1734 y(than)g(0x10000.)19
b(If)13 b(the)g(local)f(participant)f(is)h(missing,)g(or)h(if)g(the)f(local)g
(protocol)f(number)i(is)f(ANY)p 1633 1734 V 16 w(PROT)m(,)h(TCP)g(will)0
1790 y(select)e(an)g(unused)f(local)h(port.)0 1915 y Fn(CONTROL)h(OPERA)l
(TIONS)0 2002 y Fc(TCP)p 75 2002 15 2 v 17 w(PUSH:)22 b Fs(Force)12
b(a)f(TCP)h(message)f(to)g(be)g(sent.)16 b(\(session)10 b(only\))114
2095 y Fo(Input:)23 b Fs(none)114 2169 y Fo(Output:)h Fs(none)0
2262 y Fc(TCP)p 75 2262 V 17 w(GETSTATEINFO:)d Fs(Returns)10
b(state)h(of)g(the)g(connection.)16 b(\(session)9 b(only\))114
2356 y Fo(Input:)23 b Fs(none)114 2429 y Fo(Output:)h Fc(int)0
2523 y(TCP)p 75 2523 V 17 w(DUMPSTATEINFO:)d Fs(Prints)10 b(out)g(statistics)
f(gathered)i(by)g(TCP)-5 b(.)12 b(\(protocol)e(only\))114 2617
y Fo(Input:)23 b Fs(none)952 2753 y(99)p eop
%%Page: 100 100
99 bop 114 124 a Fo(Output:)24 b Fs(none)0 218 y Fc(TCP)p 75
218 15 2 v 17 w(GETFREEPROTNUM:)c Fs(Returns)14 b(an)f(unused)g(TCP)h(port)f
(number)m(.)25 b(This)13 b(port)g(number)h(will)e(not)h(be)h(given)f(out)g
(to)114 274 y(subsequent)h(TCP)p 418 274 14 2 v 16 w(GETFREEPROTNUM)i(calls)f
(until)g(it)g(is)g(released)h(with)f(TCP)p 1503 274 V 17 w(RELEASEPROTNUM.)
114 331 y(This)10 b(allows)h(an)h(opener)f(to)h(separate)f(reservation)g(of)h
(free)g(ports)f(from)i(the)e(actual)g(open)h(operation,)f(if)g(desired.)114
387 y(\(protocol)f(only\))114 480 y Fo(Input:)23 b Fs(none)114
553 y Fo(Output:)h Fs(long)0 646 y Fc(TCP)p 75 646 15 2 v 17
w(RELEASEPROTNUM:)c Fs(Releases)97 b(a)f(TCP)g(portnumber)g(previously)e
(acquired)h(with)114 703 y(TCP)p 200 703 14 2 v 16 w(GETFREEPROTNUM.)12
b(\(protocol)e(only\))114 796 y Fo(Input:)23 b Fs(long)114
869 y Fo(Output:)h Fs(none)0 962 y Fc(TCP)p 75 962 15 2 v 17
w(SETRCVBUFSPACE:)c Fs(T)m(ells)11 b(TCP)g(how)g(many)g(bytes)g(in)f(the)h
(receive)h(queue)f(are)h(free.)17 b(\(session)10 b(only\))114
1056 y Fo(Input:)23 b Fs(u)p 286 1056 14 2 v 16 w(short)114
1128 y Fo(Output:)h Fs(none)0 1222 y Fc(TCP)p 75 1222 15 2
v 17 w(SETRCVBUFSIZE:)d Fs(T)m(ells)10 b(TCP)h(the)g(size)g(of)h(the)e(TCP)i
(user)r(')m(s)f(receive)h(queue.)k(\(session)10 b(only\))114
1315 y Fo(Input:)23 b Fs(u)p 286 1315 14 2 v 16 w(short)114
1388 y Fo(Output:)h Fs(none)0 1481 y Fc(TCP)p 75 1481 15 2
v 17 w(GETSNDBUFSPACE:)c Fs(Asks)11 b(TCP)g(for)h(the)f(number)g(of)g(free)h
(bytes)e(its)h(send)f(queue.)17 b(\(session)10 b(only\))114
1575 y Fo(Input:)23 b Fs(none)114 1647 y Fo(Output:)h Fs(u)p
319 1647 14 2 v 16 w(short)0 1741 y Fc(TCP)p 75 1741 15 2 v
17 w(SETSNDBUFSIZE:)d Fs(T)m(ells)10 b(TCP)h(to)g(change)g(its)g(send)f
(queue)h(to)g(the)g(indicated)f(size)h(\(session)f(only\))114
1834 y Fo(Input:)23 b Fs(u)p 286 1834 14 2 v 16 w(short)114
1907 y Fo(Output:)h Fs(none)0 2000 y Fc(TCP)p 75 2000 15 2
v 17 w(SETOOBINLINE:)d Fs(T)m(ells)10 b(TCP)j(whether)e(users)g(wants)g(ur)o
(gent)g(data)h(to)f(be)h(delivered)f(inline)f(\(non-zero)i(==)f(yes.\))114
2057 y(\(session)e(only\))114 2162 y Fo(Input:)23 b Fs(int)114
2235 y Fo(Output:)h Fs(none)0 2340 y Fc(TCP)p 75 2340 V 17
w(GETOOBDATA:)d Fs(reads)11 b(the)g(ur)o(gent)g(data)g(\(exactly)f(one)h
(byte\),)g(returning)f(1)h(on)g(a)h(successful)e(read)h(or)g(returning)f(0)
114 2397 y(if)i(data)g(was)g(either)g(read)h(already)g(or)f(was)g(not)g
(received)g(yet)g(\(the)h(OOB)f(noti\256cation)f(may)i(precede)f(the)g
(actual)114 2453 y(reception)e(of)h(the)g(OOB)h(data\))114
2546 y Fo(Input:)23 b Fs(none)114 2619 y Fo(Output:)h Fs(char)941
2753 y(100)p eop
%%Page: 101 101
100 bop 0 124 a Fc(TCP)p 75 124 15 2 v 17 w(OOBPUSH:)21 b Fs(send)11
b(a)h(msg)f(in)f(ur)o(gent)h(mode)114 218 y Fo(Input:)23 b
Fs(Msg)11 b(*)114 291 y Fo(Output:)24 b Fs(char)0 385 y Fc(TCP)p
75 385 V 17 w(OOBMODE:)d Fs(TCP)d(uses)e(this)g(to)g(tell)h(the)f(user)h(of)g
(TCP)g(that)g(it)f(has)h(ur)o(gent)f(data)h(present,)h(i.e.,)h(TCP)f(does)e
(an)114 441 y(xControl\(\))8 b(call)i(on)f(its)g(parent)g(\320)h(THIS)g(IS)g
(AN)g(UPCALL!)f(The)h(\256rst)f(void)g(pointer)f(\(ar)o(gs[0]\))i(is)f(of)h
(type)f(XObj)114 498 y(and)h(is)f(a)i(pointer)e(to)h(the)g(TCP)g(session)f
(that)h(invoked)e(this)h(operation.)16 b(The)10 b(second)f(pointer)g(\(ar)o
(gs[1]\))i(is)f(of)g(type)114 554 y(u)p 140 554 14 2 v 16 w(int)i(and)g(is)h
(the)f(value)h(of)g(the)f(ur)o(gent)h(data)f(mark.)22 b(The)13
b(oobmark)g(indicates)e(that)i(the)f("oobmark-th")f(byte)i(in)114
611 y(the)e(receive)g(queue)g(is)g(the)g(oobdata)f(\(or)h(will)f(be)i(the)f
(oobdata.\))114 686 y(Note:)j(all)c(protocols)e(using)g(TCP)j(without)c
(having)i(OOB)h(data)g(delivered)f(in-band)f(must)i(be)g(prepared)g(to)f
(accept)114 742 y(this)h(upcall.)114 849 y Fo(Input:)23 b Fs(void)10
b(*ar)o(gs[2])114 922 y Fo(Output:)24 b Fs(none)0 1046 y Fn(CONFIGURA)l(TION)
0 1133 y Fc(name=tcp)f(protocols=ip;)0 1257 y Fn(AUTHORS)0
1344 y Fs(Norm)11 b(Hutchinson,)f(Herman)h(Rao,)h(and)f(David)g(Mosber)o(ger)
941 2753 y(101)p eop
%%Page: 102 102
101 bop 0 124 a Fn(NAME)0 211 y Fs(UDP)11 b(\(User)h(Datagram)f(Protocol\))0
336 y Fn(SPECIFICA)l(TION)0 423 y Fs(J.)d(Postel.)15 b Fr(User)8
b(Datagram)e(Pr)n(otocol)p Fs(.)14 b(Request)8 b(for)g(Comments)g(768,)g(USC)
h(Information)e(Sciences)i(Institute,)e(Marina)0 479 y(del)k(Ray)m(,)h
(Calif.,)g(Aug.)k(1980.)0 603 y Fn(SYNOPSIS)0 690 y Fs(UDP)11
b(is)g(a)g(trivial)f(protocol)g(that)h(dispatches)f(messages)h(that)f(arrive)
i(at)f(the)g(host)f(to)g(a)i(process)f(running)e(on)i(the)g(host.)0
815 y Fn(REALM)0 902 y Fs(UDP)g(is)g(in)g(the)g(ASYNC)g(realm.)0
1026 y Fn(P)l(AR)n(TICIP)l(ANTS)0 1113 y Fs(UDP)f(removes)h(a)g(pointer)e(to)
h(a)h(long)e(\(the)i(UDP)f(port)g(number\))g(from)h(the)f(participant)f
(stack.)16 b(UDP)11 b(ports)e(must)h(be)h(less)0 1169 y(than)h(0x10000.)18
b(If)12 b(the)g(local)g(participant)f(is)h(missing,)f(or)i(if)f(the)g(local)g
(protocol)e(number)j(is)f(ANY)p 1627 1169 14 2 v 15 w(PROT)m(,)h(UDP)f(will)0
1226 y(select)f(an)g(unused)f(local)h(port.)0 1350 y Fn(CONTROL)h(OPERA)l
(TIONS)0 1437 y Fc(UDP)p 75 1437 15 2 v 17 w(ENABLE)p 236 1437
V 16 w(CHECKSUM:)22 b Fs(Cause)11 b(the)g(session)f(to)g(use)h(checksums)g
(on)g(its)f(outgoing)f(packets.)16 b(\(session)10 b(only\))114
1531 y Fo(Input:)23 b Fs(none)114 1604 y Fo(Output:)h Fs(none)0
1698 y Fc(UDP)p 75 1698 V 17 w(DISABLE)p 260 1698 V 16 w(CHECKSUM:)d
Fs(Cause)12 b(the)f(session)f(to)g(not)h(use)g(checksums)f(on)h(its)g
(outgoing)e(packets.)16 b(\(session)10 b(only\))114 1792 y
Fo(Input:)23 b Fs(none)114 1865 y Fo(Output:)h Fs(none)0 1958
y Fc(UDP)p 75 1958 V 17 w(GETFREEPROTNUM:)c Fs(Returns)13 b(an)h(unused)e
(UDP)h(port)g(number)m(.)23 b(This)12 b(port)h(number)g(will)f(not)g(be)i
(given)e(out)h(to)114 2015 y(subsequent)f(UDP)p 424 2015 14
2 v 16 w(GETFREEPROTNUM)i(calls)f(until)g(it)g(is)h(released)g(with)f(UDP)p
1504 2015 V 16 w(RELEASEPROTNUM.)114 2071 y(This)d(allows)h(an)h(opener)f(to)
h(separate)f(reservation)g(of)h(free)g(ports)f(from)i(the)e(actual)g(open)h
(operation,)f(if)g(desired.)114 2128 y(\(protocol)f(only\))114
2222 y Fo(Input:)23 b Fs(none)114 2295 y Fo(Output:)h Fs(long)0
2389 y Fc(UDP)p 75 2389 15 2 v 17 w(RELEASEPROTNUM:)c Fs(Releases)95
b(a)g(UDP)g(portnumber)f(previously)f(acquired)h(with)114 2445
y(UDP)p 208 2445 14 2 v 16 w(GETFREEPROTNUM.)11 b(\(protocol)f(only\))114
2539 y Fo(Input:)23 b Fs(long)114 2612 y Fo(Output:)h Fs(none)941
2753 y(102)p eop
%%Page: 103 103
102 bop 0 124 a Fn(CONFIGURA)l(TION)0 211 y Fc(name=udp)23
b(protocols=ip;)0 336 y Fn(AUTHORS)0 423 y Fs(Larry)11 b(Peterson)g(and)g
(Sean)h(O'Malley)941 2753 y(103)p eop
%%Page: 104 104
103 bop 0 124 a Fn(NAME)0 211 y Fs(VCACHE)11 b(\()h(V)m(irtual)e(Caching)h
(Protocol)f(\))0 332 y Fn(SPECIFICA)l(TION)0 419 y Fs(VCACHE)f(is)f(a)h
(simple)f(session)f(caching)h(protocol)f(which)h(provides)f(a)i(time)g(buf)o
(fer)g(between)f(when)h(an)f(upper)h(protocol)0 476 y(closes)h(a)i(lower)f
(session)f(and)h(when)f(that)h(close)g(is)f(propagated)h(to)f(the)h(lower)g
(session.)0 597 y Fn(SYNOPSIS)0 684 y Fs(When)17 b(a)g(VCACHE)g(session)f(is)
g(closed,)i(it)f(is)f(placed)h(in)g(a)g(time-expiration)f(cache.)34
b(When)17 b(VCACHE)g(receives)0 740 y(subsequent)11 b(opens)g(\(active)h(or)h
(passive\),)f(it)g(\256rst)g(looks)f(in)h(its)g(cache)h(for)f(sessions)f
(with)g(the)i(same)g(hlp)e(and)h(the)h(same)0 797 y(remote)d(host.)15
b(After)9 b(a)h(con\256gurable)f(amount)g(of)g(time,)h(closed)f(VCACHE)g
(sessions)f(will)g(be)i(destroyed)e(and)h(the)g(lower)0 853
y(session)h(actually)g(closed.)71 909 y(As)k(an)h(example,)i(VCACHE)d(can)i
(be)f(inserted)f(between)g(a)h(UDP)g(server)g(and)g(UDP)g(to)g(prevent)f(UDP)
h(sessions)0 966 y(from)d(being)e(closed)h(when)f(the)h(server)h(releases)f
(all)g(references.)71 1022 y(Server)f(sessions)e(\(those)h(created)i(as)f(a)g
(result)f(of)h(a)g(match)g(between)f(an)h(incoming)f(packet)h(and)f(an)h
(openenable\))g(are)0 1079 y(always)g(cached.)17 b(If)10 b(an)h
(instantiation)c(of)k(VCACHE)f(is)g(running)f(in)h Fr(symmetric)g
Fs(mode,)h(client)e(sessions)g(\(those)h(created)0 1135 y(by)15
b(an)g(xOpen\))g(will)f(be)h(cached)h(as)f(well.)28 b(It)15
b(is)g(reasonable)g(to)g(con\256gure)g(VCACHE)g(in)g(symmetric)g(mode)g
(above)0 1192 y(symmetric)f(\(ASYNC)g(realm\))g(protocols)e(and)i(in)f
(asymmetric)h(mode)g(above)f(asymmetric)h(\(RPC)h(realm\))f(protocols,)0
1248 y(though)c(this)g(usage)h(is)f(certainly)h(not)f(required.)0
1369 y Fn(REALM)0 1456 y Fs(VCACHE)16 b(can)f(be)h(used)f(with)f(either)h
(ASYNC)h(or)g(RPC)g(realm)g(lower)f(protocols)f(and)h(assumes)h(the)f(realm)h
(of)f(the)0 1513 y(protocol)10 b(below)g(it.)0 1634 y Fn(P)l(AR)n(TICIP)l
(ANTS)0 1721 y Fs(VCACHE)h(passes)g(participants)e(directly)i(to)f(the)h
(lower)g(protocol)f(and)h(does)g(not)f(make)i(direct)f(use)g(of)h(any)f
(participant)0 1777 y(information.)0 1898 y Fn(CONFIGURA)l(TION)0
1985 y Fs(VCACHE)g(uses)g(a)g(single)f(lower)h(protocol.)0
2041 y(VCACHE)g(recognizes)g(the)g(following)e(ROM)j(options:)0
2124 y Fc(vcache)23 b(symmetric)f Fs(:)16 b(Run)11 b(this)f(instantiation)e
(in)j(symmetric)g(mode.)0 2220 y Fc(vcache)23 b(asymmetric)e
Fs(:)16 b(Run)c(this)e(instantiation)e(in)i(asymmetric)i(mode)f(\(default\).)
0 2307 y Fc(vcache)23 b(interval)g(n)f Fs(:)f(Set)13 b(the)h(timeout)e
(interval)g(for)i Fc(n)f Fs(seconds.)23 b(A)13 b(cached)h(VCACHE)f(session)f
(is)h(eligible)f(to)114 2364 y(be)f(destroyed)f(if)h(it)f(is)h(idle)f(for)h
Fc(n)g Fs(seconds)f(and)h(is)g(guaranteed)f(to)h(be)g(destroyed)f(if)h(it)f
(is)h(idle)f(for)h(more)h(than)e Fc(2)24 b(*)114 2420 y(n)11
b Fs(seconds.)0 2541 y Fn(AUTHOR)0 2628 y Fs(Ed)g(Menze)941
2753 y(104)p eop
%%Page: 105 105
104 bop 0 124 a Fn(NAME)0 211 y Fs(VCHAN)11 b(\(Channel)g(V)m
(irtual-Protocol\))0 336 y Fn(SPECIFICA)l(TION)0 423 y Fs(S.)h(O'Malley)g
(and)f(L.)h(Peterson.)18 b(A)11 b(Dynamic)h(Network)f(Architecture.)17
b Fr(ACM)12 b(T)m(ransactions)d(on)i(Computer)g(Systems)0 479
y(10)p Fs(,)g(2)g(\(May)h(1992\),)f(110\261143.)0 560 y(B.)i(W)l(elch.)21
b Fr(The)13 b(Sprite)e(r)n(emote)h(pr)n(ocedur)n(e)g(call)p
Fs(.)20 b(University)10 b(of)j(California)f(at)g(Berkeley)m(,)i(T)m(ech)e
(Report)h(UCB/CSD)0 617 y(86/302,)d(June)h(1986.)0 741 y Fn(SYNOPSIS)0
828 y Fs(VCHAN)i(is)g(a)h(virtual)e(protocol)g(that)h(multiplexes)f(multiple)
g(client)g(procedure)i(invocations)d(over)i(some)h(number)f(of)0
885 y(open)e(channels.)k(The)c(call)g(blocks)f(if)h(there)g(are)h(no)e(idle)h
(channels)f(available.)16 b(VCHAN)10 b(was)h(originally)e(based)i(on)f(the)0
941 y(Sprite)h(RPC)h(protocol.)71 997 y(VCHAN)j(initially)f(opens)h(a)h
(default)g(number)g(of)g(channels)f(for)h(a)h(new)f(session,)g(though)e(this)
h(number)h(can)g(be)0 1054 y(increased)11 b(or)g(decreased)h(via)f(control)f
(operations.)0 1178 y Fn(REALM)0 1265 y Fs(VCHAN)h(is)g(in)f(the)h(RPC)i
(realm.)0 1390 y Fn(P)l(AR)n(TICIP)l(ANTS)0 1477 y Fs(VCHAN)g(expects)g(an)g
(IPhost)g(pointer)f(on)h(the)h(stack)e(of)i(each)g(participant.)21
b(It)14 b(will)e(not)h(remove)g(this)g(pointer)f(before)0 1533
y(passing)e(the)h(address)f(down)h(to)f(the)h(lower)g(protocol.)0
1657 y Fn(CONTROL)h(OPERA)l(TIONS)0 1744 y Fc(VCHAN)p 123 1744
15 2 v 16 w(INCCONCURRENCY:)21 b Fs(Increase)12 b(the)f(number)h(of)f(active)
g(channels)g(by)g(the)g(number)g(given)g(\()p Fc(xControlSessn)114
1801 y Fs(only\).)114 1895 y Fo(Input:)23 b Fc(int)114 1968
y Fo(Output:)h Fs(none;)0 2061 y Fc(VCHAN)p 123 2061 V 16 w(DECCONCURRENCY:)d
Fs(Decrease)11 b(the)e(number)h(of)g(active)g(channels)f(by)g(the)h(number)g
(given)f(\()p Fc(xControlSessn)114 2118 y Fs(only\).)114 2212
y Fo(Input:)23 b Fc(int)114 2285 y Fo(Output:)h Fs(none;)0
2409 y Fn(CONFIGURA)l(TION)0 2496 y Fs(VCHAN)14 b(expects)g(to)g(be)g
(con\256gured)g(above)h(another)e(RPC)j(realm)f(protocol.)25
b(It)14 b(expects)g(that)g(each)h(xOpen)e(on)h(the)0 2553 y(lower)d(protocol)
f(with)g(the)h(same)h(participants)d(will)h(return)h(a)h(new)f(lower)g
(session.)941 2753 y(105)p eop
%%Page: 106 106
105 bop 0 124 a Fn(AUTHOR)0 211 y Fs(Ed)11 b(Menze)941 2753
y(106)p eop
%%Page: 107 107
106 bop 0 124 a Fn(NAME)0 211 y Fs(VMUX)11 b(\()h(V)m(irtual)e(Muliplexing)f
(Protocol)i(\))0 336 y Fn(SPECIFICA)l(TION)0 423 y Fs(VMUX)j(sits)e(above)h
(several)h(lower)f(protocols,)f(making)i(them)f(appear)h(as)f(a)h(single)f
(protocol.)22 b(VMUX)13 b(makes)h(very)0 479 y(simple)d(decisions)e(about)h
(which)h(protocol)f(to)h(use)f(for)i(each)f(connection.)0 603
y Fn(SYNOPSIS)0 690 y Fs(VMUX)i(is)e(only)h(active)g(during)g(connection)f
(establishment.)18 b(When)12 b(openenabled,)h(VMUX)f(openenables)f(all)i(of)f
(its)0 747 y(lower)g(protocols)e(on)i(behalf)g(of)g(the)g(upper)g(protocol.)
18 b(When)12 b(opened,)h(VMUX)f(attempts)f(opens)h(its)f(lower)h(protocols)0
803 y(in)d(the)g(order)h(in)f(which)g(they)g(were)h(speci\256ed)f(in)g(the)h
(down)f(vector)g(until)f(a)i(successful)e(open)i(occurs.)15
b(The)10 b(successfully)0 860 y(opened)h(lower)f(session)g(is)h(then)f
(returned.)0 984 y Fn(REALM)0 1071 y Fs(Since)i(VMUX)h(is)f(active)f(only)h
(during)f(open,)h(it)g(should)f(be)h(considered)f(in)h(the)g(same)h(realm)g
(as)f(the)g(protocols)f(below)0 1127 y(it)g(\(which)f(should)g(probably)g
(all)h(be)g(in)g(the)f(same)i(realm.\))0 1252 y Fn(P)l(AR)n(TICIP)l(ANTS)0
1339 y Fs(VMUX)f(passes)g(its)f(participants)f(to)i(the)g(lower)g(protocols)f
(unmodi\256ed.)0 1463 y Fn(CONTROL)i(OPERA)l(TIONS)0 1550 y
Fs(VMUX)f(forwards)g(control)f(operations)g(to)h(the)g(last)f(protocol)g(in)h
(the)g(down)f(vector)h(list.)0 1674 y Fn(CONFIGURA)l(TION)0
1761 y Fs(The)g(lower)g(protocols)e(will)i(be)g(opened)f(in)h(the)g(order)g
(in)g(which)g(they)f(are)i(listed)e(in)h(the)g(con\256guration)e(entry)m(.)0
1886 y Fn(AUTHOR)0 1973 y Fs(Ed)i(Menze)941 2753 y(107)p eop
%%Page: 108 108
107 bop 0 124 a Fn(NAME)0 211 y Fs(VNET)11 b(\(V)m(irtual)f(Network)g
(Protocol\))0 335 y Fn(SPECIFICA)l(TION)71 422 y Fs(VNET)h(is)g(a)h(virtual)e
(protocol)h(which)f(manages)i(multiple)f(physical)f(network)h(protocols.)16
b(When)11 b(opened)g(with)g(an)0 478 y(IP)g(address,)g(VNET)f(determines)h
(if)f(the)h(host)f(can)h(be)f(reached)i(directly)d(on)i(one)f(of)h(its)f
(physical)g(networks.)15 b(If)c(it)f(can,)i(a)0 535 y(session)e(on)g(that)h
(network)f(is)h(opened.)16 b(If)c(it)e(can)i(not)e(be)i(directly)e(reached,)i
(an)f(ERR)p 1376 535 14 2 v 17 w(XOBJ)g(is)g(returned.)0 658
y Fn(SYNOPSIS)71 745 y Fs(VNET)f(sits)g(above)h(pairs)g(of)g(network)g
(protocols)e(\(one)i(per)h(interface\))f(and)h(ARP)f(protocols.)16
b(When)10 b(opened)h(with)0 801 y(a)f(remote)h(IP)f(address,)g(VNET)f
(compares)h(the)g(net)g(number)g(with)f(that)g(of)h(its)f(lower)g(protocols)g
(to)g(determine)h(if)g(the)f(host)0 858 y(can)i(be)h(reached)f(directly)g(on)
f(a)i(local)f(network,)f(opening)g(the)h(appropriate)f(interface)i(protocol)e
(\(if)h(possible.\))71 914 y(If)18 b(opened)f(with)g(an)g(IP)i(broadcast)e
(address,)i(VNET)e(will)g(determine)g(which)g(networks)g(are)h(matched)g(by)f
(the)0 971 y(broadcast)12 b(address)g(and)h(will)e(open)i(a)g(lower)f
(session)f(on)h(each)i(of)e(those)g(networks.)20 b(A)13 b(push)e(on)i(a)g
(VNET)f(broadcast)0 1027 y(session)e(will)g(result)g(in)h(a)g(push)g(on)f
(all)h(of)g(these)g(lower)g(network)f(sessions.)71 1084 y(Use)h(of)g(the)g
(IP)h(broadcast)f(address)g(255.255.255.255)e(will)h(result)h(in)f(a)i(VNET)f
(session)f(which)g(broadcasts)h(on)g(all)0 1140 y(of)g(the)g(local)g
(networks.)0 1263 y Fn(REALM)0 1350 y Fs(VNET)g(is)f(in)h(the)g(ASYNC)g
(realm.)0 1474 y Fn(P)l(AR)n(TICIP)l(ANTS)0 1561 y Fs(VNET)h(removes)g(a)h
(pointer)e(to)h(an)g(IPhost)g(from)h(the)f(top)f(of)i(the)f(stack)g(of)g(the)
g(remote)h(participant.)18 b(Only)12 b(the)g(remote)0 1617
y(participant)e(is)g(processed.)16 b(New)c(participants)d(are)j(created)g
(for)f(opening)f(the)h(lower)f(network)h(protocols.)0 1741
y Fn(CONTROL)h(OPERA)l(TIONS)0 1828 y Fc(VNET)p 99 1828 15
2 v 17 w(GETADDRCLASS:)21 b Fs(Determines)12 b(the)h(address)g(class)f(of)i
(the)e(given)h(IP)g(host.)22 b(The)13 b(address)f(class)h(is)f(one)h(of)g
(the)114 1884 y(following:)114 1986 y Fc(LOCAL)p 237 1986 V
16 w(ADDR)p 349 1986 V 17 w(C:)22 b Fs(An)11 b(address)g(for)g(the)g(local)g
(host.)114 2058 y Fc(REMOTE)p 261 2058 V 16 w(HOST)p 373 2058
V 17 w(ADDR)p 486 2058 V 16 w(C:)23 b Fs(Remote)11 b(host)g(directly)f
(reachable)h(on)g(a)h(local)e(net.)114 2129 y Fc(REMOTE)p 261
2129 V 16 w(NET)p 349 2129 V 17 w(ADDR)p 462 2129 V 16 w(C:)23
b Fs(Remote)12 b(host)e(on)h(a)g(remote)h(network.)114 2200
y Fc(BCAST)p 237 2200 V 16 w(LOCAL)p 373 2200 V 17 w(ADDR)p
486 2200 V 16 w(C:)23 b Fs(255.255.255.255)9 b(\261)i(broadcast)g(address)f
(for)i(all)e(local)h(nets.)114 2271 y Fc(BCAST)p 237 2271 V
16 w(NET)p 325 2271 V 17 w(ADDR)p 438 2271 V 17 w(C:)22 b Fs(Broadcast)12
b(address)f(for)i(a)f(single)f(network)g(or)h(a)g(single)f(subnet)g(\(if)h
(subnets)e(are)j(being)214 2327 y(used.\))114 2399 y Fc(BCAST)p
237 2399 V 16 w(SUBNET)p 397 2399 V 16 w(ADDR)p 509 2399 V
17 w(C:)23 b Fs(Broadcast)9 b(for)g(a)g(network)g(\(more)h(than)e(a)i(single)
e(subnet\))g(when)h(subnets)e(are)j(being)214 2455 y(used.)114
2557 y Fo(Input:)23 b Fs(VnetClassBuf)11 b(==)f Fk(f)24 b Fc(int)f(class;)g
(IPhost)g(host;)g Fk(g)114 2629 y Fo(Output:)h Fs(VnetClassBuf)941
2753 y(108)p eop
%%Page: 109 109
108 bop 0 124 a Fc(VNET)p 99 124 15 2 v 17 w(GETNUMINTERFACES:)20
b Fs(Indicate)11 b(the)g(number)g(of)g(interfaces)g(used)g(by)g(the)g(VNET)f
(protocol)g(\(protocol)g(only)m(.\))114 215 y Fo(Input:)23
b Fs(none)114 281 y Fo(Output:)h Fc(int)0 372 y(VNET)p 99 372
V 17 w(HOSTONLOCALNET:)c Fs(Indicates)10 b(\(through)f(the)i(xControl)e
(return)h(value\))g(whether)g(the)h(given)e(host)h(is)g(on)g(one)g(of)114
429 y(VNET')m(s)k(interfaces.)25 b(When)14 b(performed)h(on)e(a)i(session,)f
(only)f(those)g(interfaces)h(active)g(on)g(that)g(session)e(will)114
485 y(be)f(considered)g(\(a)h(typical)e(VNET)h(session)f(only)g(uses)h(one)g
(interface,)h(though)e(a)i(broadcast)e(session)g(may)i(have)114
542 y(more)f(than)g(one.\))17 b(When)10 b(performed)i(on)f(a)h(protocol,)e
(all)h(interfaces)g(are)g(considered.)114 613 y(Returns)f(sizeof\(IPhost\))h
(if)g(it)g(is)f(on)h(a)h(local)e(network,)h(0)g(if)g(it)g(is)g(not.)114
704 y Fo(Input:)23 b Fc(IPhost)114 770 y Fo(Output:)h Fs(none)0
861 y Fc(VNET)p 99 861 V 17 w(GETINTERFACEID:)c Fs(Returns)14
b(an)f(opaque)h(identi\256er)f(indicating)e(the)j(interface)g(used)f(by)g
(this)g(session.)22 b(This)114 917 y(identi\256er)10 b(may)i(be)g(used)f(in)g
(subsequent)f Fc(VNET)p 889 917 V 16 w(DISABLEINTERFACE)g Fs(and)h
Fc(VNET)p 1472 917 V 17 w(ENABLEINTERFACE)e Fs(calls.)114 974
y(This)e(operation)h(will)f(fail)h(\(and)h(return)f(0\))h(if)f(performed)h
(on)g(a)g(broadcast)e(session)h(with)f(more)i(than)f(one)h(interface.)114
1030 y(Broadcast)k(sessions)f(never)h(process)g(incoming)f(packets,)i
(however)n(,)g(so)f(this)g(operation)f(will)g(always)h(succeed)114
1087 y(when)d(performed)i(on)f(a)g(session)f(delivering)g(incoming)g
(packets.)16 b(\(Session)10 b(only)m(.\))114 1178 y Fo(Input:)23
b Fs(none)114 1243 y Fo(Output:)h Fc(VOID)f(*)0 1334 y(VNET)p
99 1334 V 17 w(DISABLEINTERFACE:)d Fs(The)9 b(session)f(will)h(no)g(longer)g
(send)g(messages)g(out)g(over)g(the)g(interface)h(corresponding)114
1391 y(to)g(the)h(given)g(interface)g(identi\256er)m(.)16 b(\(Session)11
b(only)m(.\))114 1482 y Fo(Input:)23 b Fc(VOID)g(*)114 1548
y Fo(Output:)h Fs(none)0 1639 y Fc(VNET)p 99 1639 V 17 w(ENABLEINTERFACE:)c
Fs(Undoes)10 b(the)h(ef)o(fect)h(of)g(a)f(previous)f Fc(VNET)p
1196 1639 V 17 w(DISABLEINTERFACE)f Fs(\(Session)h(only)m(.\))114
1730 y Fo(Input:)23 b Fc(VOID)g(*)114 1796 y Fo(Output:)h Fs(none)0
1887 y Fc(VNET)p 99 1887 V 17 w(ISMYADDR:)d Fs(Indicates)10
b(\(through)f(the)i(xControl)e(return)i(value\))f(whether)g(the)h(given)e
(host)h(is)g(an)h(address)f(which)114 1943 y(might)g(be)i(used)e(to)h(reach)h
(this)e(host)g(on)h(VNET')m(s)g(local)g(networks)f(\(i.e.,)j(if)e(the)g
(address)g(is)f(one)i(of)f(this)f(host')m(s)h(IP)114 2000 y(addresses)f(or)h
(is)g(a)h(broadcast)e(address.\))16 b(Returns)11 b(sizeof\(IPhost\))g(if)g
(it)f(is)h(local)g(\(or)g(broadcast\),)g(0)g(if)g(it)g(is)g(not.)114
2091 y Fo(Input:)23 b Fc(IPhost)114 2156 y Fo(Output:)h Fs(none)0
2277 y Fn(CONFIGURA)l(TION)0 2364 y Fs(VNET)11 b(expects)f(its)h(lower)f
(protocols)g(to)h(be)g(con\256gured)g(in)f(network/ARP)h(pairs:)0
2420 y Fc(name=vnet)23 b(protocols=eth/1,arp/1,e)o(th/2,arp)o(/2;)0
2541 y Fn(AUTHOR)0 2628 y Fs(Ed)11 b(Menze)941 2753 y(109)p
eop
%%Page: 110 110
109 bop 0 124 a Fn(NAME)0 211 y Fs(VSIZE)11 b(\(Size)h(V)m(irtual-Protocol\))
0 336 y Fn(SPECIFICA)l(TION)0 423 y Fs(S.)g(O'Malley)g(and)f(L.)h(Peterson.)
18 b(A)11 b(Dynamic)h(Network)f(Architecture.)17 b Fr(ACM)12
b(T)m(ransactions)d(on)i(Computer)g(Systems)0 479 y(10)p Fs(,)g(2)g(\(May)h
(1992\),)f(110\261143.)0 603 y Fn(SYNOPSIS)0 690 y Fs(VSIZE)g(is)f(a)h
(virtual)e(protocol)g(that)h(selects)g(a)h(lower)o(-level)f(network)g
(protocol)f(\(e.g.,)j(BLAST)f(vs.)16 b(ETH\))10 b(based)g(on)g(the)0
747 y(size)h(of)g(the)g(message)h(being)e(sent.)0 871 y Fn(REALM)0
958 y Fs(VSIZE)h(is)g(in)g(the)f(ASYNC)i(realm.)0 1082 y Fn(P)l(AR)n(TICIP)l
(ANTS)0 1169 y Fs(VSIZE)f(passes)g(participants)e(to)i(the)g(lower)g
(protocols)e(without)g(manipulating)h(them.)0 1294 y Fn(CONTROL)i(OPERA)l
(TIONS)0 1381 y Fs(VSIZE)f(forwards)g(control)f(operations)g(to)h(the)g
(\252lar)o(ge)g(message\272)h(protocol.)0 1505 y Fn(CONFIGURA)l(TION)0
1592 y Fs(VSIZE)f(expects)g(to)g(be)g(con\256gured)g(above)f(two)h(ASYNC)g
(protocols)f(with)g(the)h(\252short)g(message\272)g(protocol)f(\256rst.)0
1716 y Fn(AUTHOR)0 1803 y Fs(Ed)h(Menze)941 2753 y(110)p eop
%%Page: 111 111
110 bop 0 124 a Fn(NAME)0 211 y Fs(XKLANCE)10 b(\(Mach3)i(in-kernel)f(lance)g
(ethernet)g(driver\))0 336 y Fn(SPECIFICA)l(TION)71 423 y Fs(XKLANCE)c(is)h
(the)f(Mach)i(in-kernel)f(ethernet)f(driver)n(,)i(presenting)e(both)g(a)i
(mach)f(kernel)g(interface)h(and)f(an)g Fr(x)p Fs(-kernel)0
479 y(interface.)0 603 y Fn(SYNOPSIS)71 690 y Fs(Each)19 b(instantiation)e
(of)j(XKLANCE)f(is)h(associated)e(with)h(a)h(single)f(ethernet)g(device.)43
b(XKLANCE)19 b(can)h(be)0 747 y(con\256gured)10 b(to)f(either)h(copy)g
(incoming)f(packets)h(to)f(both)g(the)h Fr(x)p Fs(-kernel)h(and)f(the)g
(standard)f(Mach)i(networking)d(interface)0 803 y(\(thus)j(both)h(the)g
(in-kernel)f Fr(x)p Fs(-kernel)i(and)f(the)g(Unix)g(server)g(will)g(see)g
(packets\))g(or)h(to)e(bypass)h(the)g(Mach)h(interface)f(and)0
860 y(not)e(allow)h(the)g(Unix)f(server)h(to)g(see)h(any)f(packets.)71
916 y(If)k(compiled)f(with)g(ALLOW)p 564 916 14 2 v 15 w(NON)p
678 916 V 16 w(XK)p 760 916 V 16 w(USERS)h(de\256ned,)h(XKLANCE)f(will)e
(check)i(the)g(value)f(of)h(the)f(global)0 973 y(variable)i(xklanceAllUsers)e
(to)h(determine)h(whether)g(to)f(allow)h(non-)p Fr(x)p Fs(-kernel)f(users)h
(to)f(send)h(and)g(receive)g(network)0 1029 y(packets)11 b(through)e(the)i
(standard)g(Mach)h(interfaces.)0 1153 y Fn(REALM)0 1240 y Fs(XKLANCE)d(is)g
(in)g(the)h(ASYNC)f(realm,)i(supporting)d(the)h(ethernet)g(driver)h
(interface)f(described)g(in)g(the)h(ETH)f(appendix.)0 1365
y Fn(P)l(AR)n(TICIP)l(ANTS)0 1452 y Fs(XKLANCE)16 b(supports)g(the)g
(ethernet)h(driver)g(interface)g(rather)g(than)g(a)g(standard)f(xkernel)h
(UPI)g(interface)g(and)g(thus)0 1508 y(makes)11 b(no)g(use)g(of)g
(participant)f(stacks.)0 1632 y Fn(EXTERNAL)j(INTERF)l(ACE)0
1719 y Fs(XKLANCE)d(supports)g(the)h(ethernet)g(driver)f(interface)i
(described)e(in)h(the)g(ETH)g(appendix.)0 1844 y Fn(CONFIGURA)l(TION)0
1931 y Fs(XKLANCE)k(requires)g(no)g(lower)g(protocol.)28 b(The)16
b(last)f(digit)f(of)h(the)g(instance)g(name)h(must)f(correspond)g(to)g(the)g
(unit)0 1987 y(device)c(number)g(for)h(the)e(particular)h(instantiation.)j
(E.g.,)71 2068 y Fc(name=ethdrv/SE0;)0 2150 y Fs(for)d(device)g(0.)0
2274 y Fn(AUTHORS)0 2361 y Fs(Richard)g(Schroeppel,)g(Hilarie)g(Orman)h
(\(modi\256cations)e(to)g(Mach)i(kernel)f(source)g(distribution\))941
2753 y(111)p eop
%%Page: 112 112
111 bop 0 124 a Fn(NAME)0 211 y Fs(XSI)12 b(\(the)f Fr(x)p
Fs(-kernel)g(socket)g(interface\))0 336 y Fn(SPECIFICA)l(TION)0
423 y Fs(BSD)h(Socket)f(operations)f(as)h(implemented)g(by)f(the)h(Mach3)h
(Unix)e(Single-Server)m(.)0 547 y Fn(SYNOPSIS)0 634 y Fs(Sockets)h(are)h(an)f
(application)e(interface)j(to)e(UDP)i(and)f(TCP)g(networking)f(services.)0
758 y Fn(REALM)0 845 y Fs(Sockets)h(are)h(in)e(the)h(anchor)g(protocol)f
(realm.)17 b(This)11 b(version)f(is)g(speci\256c)i(to)e(the)h(Mach3)h
(platform.)0 969 y Fn(P)l(AR)n(TICIP)l(ANTS)0 1056 y Fs(Sockets)f(use)g(IP)g
(addresses.)16 b(The)11 b(addresses)g(are)h(passed)e(in)h(messages)g
(generated)g(by)g(MiG)g(stubs.)0 1181 y Fn(CONFIGURA)l(TION)0
1268 y Fc(name=xsi)23 b(protocols=udp,tcp;)0 1392 y Fn(AUTHORS)0
1479 y Fs(David)10 b(Mosber)o(ger)941 2753 y(112)p eop
%%Page: 113 113
112 bop 0 124 a Ft(B)60 b(Application)14 b(Pr)o(ogrammer)d(Interfaces)0
228 y Fs(This)e(appendix)h(describes)f(the)h(installation)e(and)i(use)g(of)h
Fr(x)p Fs(-kernel)f(application)f(programmer)i(interfaces.)16
b(API')m(s)c(in)d(the)0 284 y Fr(x)p Fs(-kernel)j(are)f(platform-speci\256c.)
0 408 y Fn(B.1)63 b(Mach)12 b(3)0 495 y Fo(B.1.1)46 b(Sockets)0
582 y Fs(The)11 b(Mach)h(3)f(out-of-kernel)f(platform)h(provides)f(a)i(user)f
(socket)f(library)m(.)16 b(This)10 b(library)h(can)g(be)h(used)e(to)h
(communicate)0 639 y(with)e(the)h(XSI)g(protocol)f(running)f(in)i(an)g
(out-of-kernel)f Fr(x)p Fs(-kernel)h(in)g(a)g(separate)g(task.)16
b(The)10 b(combination)e(of)i(the)g(library)0 695 y(and)i(the)f(XSI)h
(protocol)f(provides)f(Berkeley)i(socket)f(semantics.)18 b(The)12
b(mach)g(3)g(user)o(-level)f(build)g(will)f(create)j(a)f(socket)0
752 y(library)h(in)f(the)i Fc(xkernel/mach3/user/sock)o(et)d
Fs(directory)h(which)h(can)g(be)h(linked)e(with)g(any)h(application)f(making)
0 808 y(Berkeley)j(socket)f(calls.)27 b(These)14 b(calls)h(will)e(then)i(be)g
(routed)f(through)f(the)h Fr(x)p Fs(-kernel)i(socket)e(implementation)f
(rather)0 865 y(than)e(the)g(sockets)f(in)g(the)h(BSD)h(server)m(.)71
921 y(The)i(user)o(-level)f(build)g(will)g(also)h(create)h(some)f(test)g
(programs)g(in)f Fc(xkernel/mach3/user/socket/tst)e Fs(that)0
977 y(exercise)g(the)g(socket)g(library)f(and)h(the)g(XSI)h(protocol.)0
1100 y Fo(B.1.2)46 b(Mach)11 b(NetIPC)0 1187 y Fs(The)19 b(user)o(-level)g
(build)f(will)g(create)i(a)f(test)g(program,)j(SSR-test,)g(which)c(exercises)
h(the)g Fr(x)p Fs(-kernel')m(s)h(out-of-kernel)0 1244 y(implementation)10
b(of)h(Mach)h(netIPC)f(in)g Fc(xkernel/mach3/user/netipc/t)o(est)p
Fs(.)71 1300 y(SSR-test)i(communicates)g(with)g(the)g Fr(x)p
Fs(-kernel)g(protocols)f(MachNetIPC)j(and)e(SSR.)h(There)g(must)f(be)g(an)h
Fr(x)p Fs(-kernel)0 1356 y(task)d(with)f(MachNetIPC)i(running)e(on)h(the)f
(host,)h(and)g(there)g(must)g(be)g(a)h(Mach)g(nameserver)g(running)d(on)i
(the)g(host.)71 1413 y(SSR-test)g(takes)g(command)h(line)f(ar)o(guments.)18
b(The)11 b(\256rst)g(ar)o(gument)h(speci\256es)f(the)g(test)g(type.)17
b(The)12 b(simplest)e(test)h(is)0 1469 y(the)g Fr(postcar)n(d)f
Fs(test.)16 b(Other)10 b(test)h(types)f(are)i(documented)f(in)f(the)h(source)
g(code.)71 1526 y(T)m(o)f(start)h(a)g(postcard)g(server)g(at)g(debugging)f
(level)g(1:)0 1582 y Fc(ssr-test)23 b(-t)g(p)h(-l)g(1)f(&)h
Fs(;)71 1639 y(T)m(o)9 b(start)f(a)i(postcard)f(client)f(at)i(debugging)d
(level)i(1,)h(communicating)f(with)f(a)i(server)g(at)f(IP)h(address)f
(192.12.69.211,)0 1695 y(using)h(10)h(round-trips:)0 1752 y
Fc(ssr-test)23 b(-t)g(p)h(-p)g(192.12.69.211)e(-l)h(1)h(-trips)f(10)h(&)f
Fs(;)0 1874 y Fo(B.1.3)46 b(Building)0 1961 y Fs(The)11 b(Mach)h(3)f(APIs)g
(can)h(be)f(built)f(from)h(a)h(normal)f(out-of-kernel)f Fr(x)p
Fs(-kernel)i(build)e(directory)m(.)16 b(Running)143 2068 y
Fc(make)23 b(userdepend)0 2174 y Fs(will)10 b(build)g(the)h(dependency)f
(\256les)h(for)h(the)f(APIs)g(and)143 2280 y Fc(make)23 b(libUser)0
2386 y Fs(will)10 b(build)g(the)h(socket)f(library)h(and)g(the)g(test)f
(programs.)941 2753 y(113)p eop
%%Trailer
end
userdict /end-hook known{end-hook}if
%%EOF
